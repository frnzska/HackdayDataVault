

============================== 2022-06-29 11:49:17.918078 | ff7588f2-e5b8-49bd-9b53-801168c9d080 ==============================
11:49:17.918096 [info ] [MainThread]: Running with dbt=1.1.0
11:49:17.918741 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/adambekele/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['models/stage_raw/facebook_accounts_staging_raw'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
11:49:17.918860 [debug] [MainThread]: Tracking: tracking
11:49:17.919118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f1dba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f1db4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f1dbaf0>]}
11:49:17.940719 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
11:49:17.941049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ff7588f2-e5b8-49bd-9b53-801168c9d080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f1d8a00>]}
11:49:17.996518 [debug] [MainThread]: Parsing macros/catalog.sql
11:49:17.997959 [debug] [MainThread]: Parsing macros/adapters.sql
11:49:18.019132 [debug] [MainThread]: Parsing macros/materializations/merge.sql
11:49:18.021076 [debug] [MainThread]: Parsing macros/materializations/seed.sql
11:49:18.023688 [debug] [MainThread]: Parsing macros/materializations/view.sql
11:49:18.024336 [debug] [MainThread]: Parsing macros/materializations/table.sql
11:49:18.025837 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
11:49:18.030017 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
11:49:18.030479 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
11:49:18.032298 [debug] [MainThread]: Parsing macros/materializations/configs.sql
11:49:18.033369 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
11:49:18.034160 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
11:49:18.042344 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
11:49:18.049106 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
11:49:18.054778 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
11:49:18.056948 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
11:49:18.057790 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
11:49:18.058645 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
11:49:18.060754 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
11:49:18.069586 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
11:49:18.070324 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
11:49:18.075301 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
11:49:18.083313 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
11:49:18.087197 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
11:49:18.088537 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
11:49:18.092253 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
11:49:18.092858 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
11:49:18.094157 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
11:49:18.095219 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
11:49:18.098185 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
11:49:18.106682 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
11:49:18.107377 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
11:49:18.108526 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
11:49:18.109254 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
11:49:18.109671 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
11:49:18.110047 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
11:49:18.110368 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
11:49:18.111035 [debug] [MainThread]: Parsing macros/etc/statement.sql
11:49:18.113130 [debug] [MainThread]: Parsing macros/etc/datetime.sql
11:49:18.117288 [debug] [MainThread]: Parsing macros/adapters/schema.sql
11:49:18.118282 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
11:49:18.119528 [debug] [MainThread]: Parsing macros/adapters/relation.sql
11:49:18.124169 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
11:49:18.125535 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
11:49:18.127626 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
11:49:18.131311 [debug] [MainThread]: Parsing macros/adapters/columns.sql
11:49:18.135981 [debug] [MainThread]: Parsing tests/generic/builtin.sql
11:49:18.137373 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
11:49:18.137843 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
11:49:18.138412 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
11:49:18.166863 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
11:49:18.169838 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
11:49:18.170421 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
11:49:18.171617 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
11:49:18.172200 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
11:49:18.173558 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
11:49:18.174128 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
11:49:18.174962 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
11:49:18.176019 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
11:49:18.180422 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
11:49:18.185519 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
11:49:18.186357 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
11:49:18.186996 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
11:49:18.187664 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
11:49:18.188418 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
11:49:18.188994 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
11:49:18.189707 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
11:49:18.190198 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
11:49:18.191763 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
11:49:18.194414 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
11:49:18.195270 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
11:49:18.196064 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
11:49:18.197764 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
11:49:18.200773 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
11:49:18.201449 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
11:49:18.202780 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
11:49:18.203700 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
11:49:18.204667 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
11:49:18.217362 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
11:49:18.218304 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
11:49:18.219558 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
11:49:18.220288 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
11:49:18.221139 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
11:49:18.221912 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
11:49:18.222970 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
11:49:18.223792 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
11:49:18.224361 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
11:49:18.225600 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
11:49:18.226609 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
11:49:18.227271 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
11:49:18.227851 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
11:49:18.229201 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
11:49:18.230172 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
11:49:18.231017 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
11:49:18.232059 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
11:49:18.233487 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
11:49:18.234148 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
11:49:18.235857 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
11:49:18.240543 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
11:49:18.241061 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
11:49:18.241621 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
11:49:18.242136 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
11:49:18.242688 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
11:49:18.244687 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
11:49:18.245502 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
11:49:18.247169 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
11:49:18.249238 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
11:49:18.250885 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
11:49:18.251670 [debug] [MainThread]: Parsing macros/sql/star.sql
11:49:18.253476 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
11:49:18.257609 [debug] [MainThread]: Parsing macros/sql/union.sql
11:49:18.263471 [debug] [MainThread]: Parsing macros/sql/groupby.sql
11:49:18.264102 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
11:49:18.267626 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
11:49:18.269276 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
11:49:18.270039 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
11:49:18.270801 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
11:49:18.274002 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
11:49:18.276762 [debug] [MainThread]: Parsing macros/sql/pivot.sql
11:49:18.278769 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
11:49:18.280081 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
11:49:18.281169 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
11:49:18.281955 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
11:49:18.284987 [debug] [MainThread]: Parsing macros/tables/bigquery/xts.sql
11:49:18.285431 [debug] [MainThread]: Parsing macros/tables/bigquery/pit.sql
11:49:18.296948 [debug] [MainThread]: Parsing macros/tables/bigquery/ma_sat.sql
11:49:18.305934 [debug] [MainThread]: Parsing macros/tables/bigquery/t_link.sql
11:49:18.306480 [debug] [MainThread]: Parsing macros/tables/bigquery/sat.sql
11:49:18.311499 [debug] [MainThread]: Parsing macros/tables/bigquery/hub.sql
11:49:18.317773 [debug] [MainThread]: Parsing macros/tables/bigquery/eff_sat.sql
11:49:18.325403 [debug] [MainThread]: Parsing macros/tables/bigquery/link.sql
11:49:18.331685 [debug] [MainThread]: Parsing macros/tables/bigquery/bridge.sql
11:49:18.354085 [debug] [MainThread]: Parsing macros/tables/snowflake/xts.sql
11:49:18.358464 [debug] [MainThread]: Parsing macros/tables/snowflake/pit.sql
11:49:18.371886 [debug] [MainThread]: Parsing macros/tables/snowflake/ma_sat.sql
11:49:18.379063 [debug] [MainThread]: Parsing macros/tables/snowflake/t_link.sql
11:49:18.382567 [debug] [MainThread]: Parsing macros/tables/snowflake/sat.sql
11:49:18.388184 [debug] [MainThread]: Parsing macros/tables/snowflake/hub.sql
11:49:18.394948 [debug] [MainThread]: Parsing macros/tables/snowflake/eff_sat.sql
11:49:18.403378 [debug] [MainThread]: Parsing macros/tables/snowflake/link.sql
11:49:18.410864 [debug] [MainThread]: Parsing macros/tables/snowflake/bridge.sql
11:49:18.433880 [debug] [MainThread]: Parsing macros/tables/sqlserver/xts.sql
11:49:18.434390 [debug] [MainThread]: Parsing macros/tables/sqlserver/pit.sql
11:49:18.434844 [debug] [MainThread]: Parsing macros/tables/sqlserver/ma_sat.sql
11:49:18.443433 [debug] [MainThread]: Parsing macros/tables/sqlserver/t_link.sql
11:49:18.443907 [debug] [MainThread]: Parsing macros/tables/sqlserver/sat.sql
11:49:18.448747 [debug] [MainThread]: Parsing macros/tables/sqlserver/hub.sql
11:49:18.455679 [debug] [MainThread]: Parsing macros/tables/sqlserver/eff_sat.sql
11:49:18.463076 [debug] [MainThread]: Parsing macros/tables/sqlserver/link.sql
11:49:18.470046 [debug] [MainThread]: Parsing macros/tables/sqlserver/bridge.sql
11:49:18.492190 [debug] [MainThread]: Parsing macros/staging/hash_columns.sql
11:49:18.494083 [debug] [MainThread]: Parsing macros/staging/source_columns.sql
11:49:18.494667 [debug] [MainThread]: Parsing macros/staging/stage.sql
11:49:18.500276 [debug] [MainThread]: Parsing macros/staging/rank_columns.sql
11:49:18.505442 [debug] [MainThread]: Parsing macros/staging/derive_columns.sql
11:49:18.508523 [debug] [MainThread]: Parsing macros/internal/metadata_processing/as_constant.sql
11:49:18.509841 [debug] [MainThread]: Parsing macros/internal/metadata_processing/escape_column_names.sql
11:49:18.517097 [debug] [MainThread]: Parsing macros/internal/metadata_processing/alias.sql
11:49:18.518822 [debug] [MainThread]: Parsing macros/internal/metadata_processing/concat_ws.sql
11:49:18.519854 [debug] [MainThread]: Parsing macros/internal/metadata_processing/multikey.sql
11:49:18.522453 [debug] [MainThread]: Parsing macros/internal/metadata_processing/expand_column_list.sql
11:49:18.524014 [debug] [MainThread]: Parsing macros/internal/metadata_processing/check_required_parameters.sql
11:49:18.524794 [debug] [MainThread]: Parsing macros/internal/metadata_processing/alias_all.sql
11:49:18.525932 [debug] [MainThread]: Parsing macros/internal/helpers/prepend_generated_by.sql
11:49:18.526125 [debug] [MainThread]: Parsing macros/internal/helpers/is_checks.sql
11:49:18.528423 [debug] [MainThread]: Parsing macros/internal/helpers/stage_processing_macros.sql
11:49:18.533677 [debug] [MainThread]: Parsing macros/materialisations/vault_insert_by_rank_materialization.sql
11:49:18.542202 [debug] [MainThread]: Parsing macros/materialisations/incremental_bridge_materialization.sql
11:49:18.544899 [debug] [MainThread]: Parsing macros/materialisations/shared_helpers.sql
11:49:18.545417 [debug] [MainThread]: Parsing macros/materialisations/vault_insert_by_period_materialization.sql
11:49:18.559781 [debug] [MainThread]: Parsing macros/materialisations/incremental_pit_bridge_replace.sql
11:49:18.560968 [debug] [MainThread]: Parsing macros/materialisations/incremental_pit_materialization.sql
11:49:18.563659 [debug] [MainThread]: Parsing macros/materialisations/mat_is_checks.sql
11:49:18.566813 [debug] [MainThread]: Parsing macros/materialisations/rank_mat_helpers/get_min_max_ranks.sql
11:49:18.568549 [debug] [MainThread]: Parsing macros/materialisations/rank_mat_helpers/replace_placeholder_with_rank_filter.sql
11:49:18.570441 [debug] [MainThread]: Parsing macros/materialisations/period_mat_helpers/replace_placeholder_with_period_filter.sql
11:49:18.574296 [debug] [MainThread]: Parsing macros/materialisations/period_mat_helpers/get_period_boundaries.sql
11:49:18.580388 [debug] [MainThread]: Parsing macros/materialisations/period_mat_helpers/get_start_stop_dates.sql
11:49:18.582682 [debug] [MainThread]: Parsing macros/materialisations/period_mat_helpers/get_period_filter_sql.sql
11:49:18.585707 [debug] [MainThread]: Parsing macros/materialisations/period_mat_helpers/get_period_of_load.sql
11:49:18.588233 [debug] [MainThread]: Parsing macros/supporting/datatypes.sql
11:49:18.588764 [debug] [MainThread]: Parsing macros/supporting/max_datetime.sql
11:49:18.589530 [debug] [MainThread]: Parsing macros/supporting/hash.sql
11:49:18.600637 [debug] [MainThread]: Parsing macros/supporting/prefix.sql
11:49:18.603521 [debug] [MainThread]: Parsing macros/supporting/current_timestamp.sql
11:49:18.604516 [debug] [MainThread]: Parsing macros/supporting/get_query_results_as_dict.sql
11:49:18.972801 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
11:49:18.978427 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
11:49:18.979536 [debug] [MainThread]: 1699: static parser successfully parsed stage_raw/facebook_accounts_staging_raw.sql
11:49:18.980592 [debug] [MainThread]: 1699: static parser successfully parsed stage_raw/facebook_ads_insights_staging_raw.sql
11:49:19.036671 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.HackdayVault.facebook_ads_insights_staging_raw
- models.HackdayVault.facebook_accounts_staging_raw

11:49:19.039731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff7588f2-e5b8-49bd-9b53-801168c9d080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f6dd0d0>]}
11:49:19.046921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff7588f2-e5b8-49bd-9b53-801168c9d080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f5e0040>]}
11:49:19.047120 [info ] [MainThread]: Found 4 models, 9 tests, 0 snapshots, 0 analyses, 545 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
11:49:19.047264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff7588f2-e5b8-49bd-9b53-801168c9d080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107afafa0>]}
11:49:19.047726 [warn ] [MainThread]: The selection criterion 'models/stage_raw/facebook_accounts_staging_raw' does not match any nodes
11:49:19.048173 [info ] [MainThread]: 
11:49:19.048313 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
11:49:19.111242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f229850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f229e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f6dd190>]}


============================== 2022-06-29 11:49:46.643233 | 1e6ed772-4ed4-4476-9bae-0c1074748d45 ==============================
11:49:46.643252 [info ] [MainThread]: Running with dbt=1.1.0
11:49:46.643831 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/adambekele/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['facebook_accounts_staging_raw'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
11:49:46.643981 [debug] [MainThread]: Tracking: tracking
11:49:46.644279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c2a1be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c2a1c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c2a1f40>]}
11:49:46.791339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
11:49:46.791493 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
11:49:46.791733 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.HackdayVault.facebook_ads_insights_staging_raw
- models.HackdayVault.facebook_accounts_staging_raw

11:49:46.795319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e6ed772-4ed4-4476-9bae-0c1074748d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c50c0d0>]}
11:49:46.834850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e6ed772-4ed4-4476-9bae-0c1074748d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c3fcb50>]}
11:49:46.835105 [info ] [MainThread]: Found 4 models, 9 tests, 0 snapshots, 0 analyses, 545 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
11:49:46.835299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e6ed772-4ed4-4476-9bae-0c1074748d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c3fca00>]}
11:49:46.836048 [info ] [MainThread]: 
11:49:46.836364 [debug] [MainThread]: Acquiring new snowflake connection "master"
11:49:46.836844 [debug] [ThreadPool]: Acquiring new snowflake connection "list_BLINKIST_DEV"
11:49:46.844654 [debug] [ThreadPool]: Using snowflake connection "list_BLINKIST_DEV"
11:49:46.844797 [debug] [ThreadPool]: On list_BLINKIST_DEV: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "connection_name": "list_BLINKIST_DEV"} */

    show terse schemas in database BLINKIST_DEV
    limit 10000
11:49:46.844889 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:49:48.526087 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.68 seconds
11:49:48.529789 [debug] [ThreadPool]: On list_BLINKIST_DEV: Close
11:49:49.008106 [debug] [ThreadPool]: Acquiring new snowflake connection "list_BLINKIST_DEV_hackday"
11:49:49.019879 [debug] [ThreadPool]: Using snowflake connection "list_BLINKIST_DEV_hackday"
11:49:49.020190 [debug] [ThreadPool]: On list_BLINKIST_DEV_hackday: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "connection_name": "list_BLINKIST_DEV_hackday"} */

    show terse objects in BLINKIST_DEV.hackday
11:49:49.020379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:49:50.180658 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.16 seconds
11:49:50.184517 [debug] [ThreadPool]: On list_BLINKIST_DEV_hackday: Close
11:49:50.508744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e6ed772-4ed4-4476-9bae-0c1074748d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c3fc3d0>]}
11:49:50.509786 [info ] [MainThread]: Concurrency: 4 threads (target='hackday')
11:49:50.510324 [info ] [MainThread]: 
11:49:50.517628 [debug] [Thread-1  ]: Began running node model.HackdayVault.facebook_accounts_staging_raw
11:49:50.518087 [info ] [Thread-1  ]: 1 of 1 START view model hackday.facebook_accounts_staging_raw .................. [RUN]
11:49:50.518736 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.HackdayVault.facebook_accounts_staging_raw"
11:49:50.518968 [debug] [Thread-1  ]: Began compiling node model.HackdayVault.facebook_accounts_staging_raw
11:49:50.519201 [debug] [Thread-1  ]: Compiling model.HackdayVault.facebook_accounts_staging_raw
11:49:50.523411 [debug] [Thread-1  ]: Writing injected SQL for node "model.HackdayVault.facebook_accounts_staging_raw"
11:49:50.525694 [debug] [Thread-1  ]: finished collecting timing info
11:49:50.525923 [debug] [Thread-1  ]: Began executing node model.HackdayVault.facebook_accounts_staging_raw
11:49:50.551606 [debug] [Thread-1  ]: Writing runtime SQL for node "model.HackdayVault.facebook_accounts_staging_raw"
11:49:50.554282 [debug] [Thread-1  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_staging_raw"
11:49:50.554514 [debug] [Thread-1  ]: On model.HackdayVault.facebook_accounts_staging_raw: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_staging_raw"} */

  create or replace  view BLINKIST_DEV.hackday.facebook_accounts_staging_raw
  
   as (
    SELECT
    *
FROM FIVETRAN_DATABASE.facebook_ads.account_history
  );
11:49:50.554638 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:49:51.675761 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.12 seconds
11:49:51.688401 [debug] [Thread-1  ]: finished collecting timing info
11:49:51.688846 [debug] [Thread-1  ]: On model.HackdayVault.facebook_accounts_staging_raw: Close
11:49:51.988830 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e6ed772-4ed4-4476-9bae-0c1074748d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c3fc9a0>]}
11:49:51.989773 [info ] [Thread-1  ]: 1 of 1 OK created view model hackday.facebook_accounts_staging_raw ............. [[32mSUCCESS 1[0m in 1.47s]
11:49:51.990617 [debug] [Thread-1  ]: Finished running node model.HackdayVault.facebook_accounts_staging_raw
11:49:51.992274 [debug] [MainThread]: Acquiring new snowflake connection "master"
11:49:51.992898 [info ] [MainThread]: 
11:49:51.993325 [info ] [MainThread]: Finished running 1 view model in 5.16s.
11:49:51.993689 [debug] [MainThread]: Connection 'master' was properly closed.
11:49:51.993892 [debug] [MainThread]: Connection 'model.HackdayVault.facebook_accounts_staging_raw' was properly closed.
11:49:52.068514 [info ] [MainThread]: 
11:49:52.068875 [info ] [MainThread]: [32mCompleted successfully[0m
11:49:52.069146 [info ] [MainThread]: 
11:49:52.069360 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
11:49:52.069649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c418070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c3fcc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ca042b0>]}


============================== 2022-06-29 11:50:12.362050 | 5bc2dc20-4967-4978-aab4-0e5813376c4c ==============================
11:50:12.362083 [info ] [MainThread]: Running with dbt=1.1.0
11:50:12.362580 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/adambekele/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['facebook_ads_insights_staging_raw'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
11:50:12.362719 [debug] [MainThread]: Tracking: tracking
11:50:12.362977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ffb2d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ffb2ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ffb2e80>]}
11:50:12.483487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
11:50:12.483639 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
11:50:12.483884 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.HackdayVault.facebook_ads_insights_staging_raw
- models.HackdayVault.facebook_accounts_staging_raw

11:50:12.487513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5bc2dc20-4967-4978-aab4-0e5813376c4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16021b0d0>]}
11:50:12.532114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5bc2dc20-4967-4978-aab4-0e5813376c4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16010bc40>]}
11:50:12.532382 [info ] [MainThread]: Found 4 models, 9 tests, 0 snapshots, 0 analyses, 545 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
11:50:12.532581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bc2dc20-4967-4978-aab4-0e5813376c4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16010baf0>]}
11:50:12.533335 [info ] [MainThread]: 
11:50:12.533650 [debug] [MainThread]: Acquiring new snowflake connection "master"
11:50:12.534128 [debug] [ThreadPool]: Acquiring new snowflake connection "list_BLINKIST_DEV"
11:50:12.542116 [debug] [ThreadPool]: Using snowflake connection "list_BLINKIST_DEV"
11:50:12.542414 [debug] [ThreadPool]: On list_BLINKIST_DEV: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "connection_name": "list_BLINKIST_DEV"} */

    show terse schemas in database BLINKIST_DEV
    limit 10000
11:50:12.542554 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:50:14.040584 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.5 seconds
11:50:14.043357 [debug] [ThreadPool]: On list_BLINKIST_DEV: Close
11:50:14.368815 [debug] [ThreadPool]: Acquiring new snowflake connection "list_BLINKIST_DEV_hackday"
11:50:14.380929 [debug] [ThreadPool]: Using snowflake connection "list_BLINKIST_DEV_hackday"
11:50:14.381231 [debug] [ThreadPool]: On list_BLINKIST_DEV_hackday: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "connection_name": "list_BLINKIST_DEV_hackday"} */

    show terse objects in BLINKIST_DEV.hackday
11:50:14.381458 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:50:15.473428 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.09 seconds
11:50:15.477313 [debug] [ThreadPool]: On list_BLINKIST_DEV_hackday: Close
11:50:15.842044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bc2dc20-4967-4978-aab4-0e5813376c4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16010b340>]}
11:50:15.843357 [info ] [MainThread]: Concurrency: 4 threads (target='hackday')
11:50:15.844049 [info ] [MainThread]: 
11:50:15.851146 [debug] [Thread-1  ]: Began running node model.HackdayVault.facebook_ads_insights_staging_raw
11:50:15.851645 [info ] [Thread-1  ]: 1 of 1 START view model hackday.facebook_ads_insights_staging_raw .............. [RUN]
11:50:15.852302 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.HackdayVault.facebook_ads_insights_staging_raw"
11:50:15.852539 [debug] [Thread-1  ]: Began compiling node model.HackdayVault.facebook_ads_insights_staging_raw
11:50:15.852769 [debug] [Thread-1  ]: Compiling model.HackdayVault.facebook_ads_insights_staging_raw
11:50:15.857103 [debug] [Thread-1  ]: Writing injected SQL for node "model.HackdayVault.facebook_ads_insights_staging_raw"
11:50:15.857942 [debug] [Thread-1  ]: finished collecting timing info
11:50:15.858169 [debug] [Thread-1  ]: Began executing node model.HackdayVault.facebook_ads_insights_staging_raw
11:50:15.884863 [debug] [Thread-1  ]: Writing runtime SQL for node "model.HackdayVault.facebook_ads_insights_staging_raw"
11:50:15.885848 [debug] [Thread-1  ]: Using snowflake connection "model.HackdayVault.facebook_ads_insights_staging_raw"
11:50:15.886048 [debug] [Thread-1  ]: On model.HackdayVault.facebook_ads_insights_staging_raw: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_ads_insights_staging_raw"} */

  create or replace  view BLINKIST_DEV.hackday.facebook_ads_insights_staging_raw
  
   as (
    SELECT
    *
FROM FIVETRAN_DATABASE.facebook.ads_insights
  );
11:50:15.886191 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:50:17.140681 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.25 seconds
11:50:17.152970 [debug] [Thread-1  ]: finished collecting timing info
11:50:17.153387 [debug] [Thread-1  ]: On model.HackdayVault.facebook_ads_insights_staging_raw: Close
11:50:17.445639 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bc2dc20-4967-4978-aab4-0e5813376c4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160458940>]}
11:50:17.446512 [info ] [Thread-1  ]: 1 of 1 OK created view model hackday.facebook_ads_insights_staging_raw ......... [[32mSUCCESS 1[0m in 1.59s]
11:50:17.447323 [debug] [Thread-1  ]: Finished running node model.HackdayVault.facebook_ads_insights_staging_raw
11:50:17.449334 [debug] [MainThread]: Acquiring new snowflake connection "master"
11:50:17.450257 [info ] [MainThread]: 
11:50:17.450507 [info ] [MainThread]: Finished running 1 view model in 4.92s.
11:50:17.450650 [debug] [MainThread]: Connection 'master' was properly closed.
11:50:17.450724 [debug] [MainThread]: Connection 'model.HackdayVault.facebook_ads_insights_staging_raw' was properly closed.
11:50:17.528233 [info ] [MainThread]: 
11:50:17.528590 [info ] [MainThread]: [32mCompleted successfully[0m
11:50:17.528833 [info ] [MainThread]: 
11:50:17.529023 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
11:50:17.529419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160574a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160577460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1605771f0>]}


============================== 2022-06-29 11:52:43.037056 | f8ef7de9-2463-4fc4-9551-764d6a503f2d ==============================
11:52:43.037082 [info ] [MainThread]: Running with dbt=1.1.0
11:52:43.038112 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/adambekele/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['tag:raw'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
11:52:43.038291 [debug] [MainThread]: Tracking: tracking
11:52:43.038589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081a95e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081a9370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081a9400>]}
11:52:43.118623 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
11:52:43.118957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f8ef7de9-2463-4fc4-9551-764d6a503f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081a91f0>]}
11:52:43.167034 [debug] [MainThread]: Parsing macros/catalog.sql
11:52:43.168266 [debug] [MainThread]: Parsing macros/adapters.sql
11:52:43.189679 [debug] [MainThread]: Parsing macros/materializations/merge.sql
11:52:43.191650 [debug] [MainThread]: Parsing macros/materializations/seed.sql
11:52:43.194320 [debug] [MainThread]: Parsing macros/materializations/view.sql
11:52:43.194995 [debug] [MainThread]: Parsing macros/materializations/table.sql
11:52:43.196509 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
11:52:43.200710 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
11:52:43.201162 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
11:52:43.203005 [debug] [MainThread]: Parsing macros/materializations/configs.sql
11:52:43.204089 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
11:52:43.205150 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
11:52:43.213398 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
11:52:43.220193 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
11:52:43.225986 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
11:52:43.242197 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
11:52:43.243250 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
11:52:43.244497 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
11:52:43.247100 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
11:52:43.257557 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
11:52:43.258401 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
11:52:43.264074 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
11:52:43.272736 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
11:52:43.276833 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
11:52:43.278230 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
11:52:43.282093 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
11:52:43.282732 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
11:52:43.284070 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
11:52:43.285164 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
11:52:43.288230 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
11:52:43.296857 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
11:52:43.297571 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
11:52:43.298743 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
11:52:43.299477 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
11:52:43.299908 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
11:52:43.300598 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
11:52:43.300928 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
11:52:43.301581 [debug] [MainThread]: Parsing macros/etc/statement.sql
11:52:43.303679 [debug] [MainThread]: Parsing macros/etc/datetime.sql
11:52:43.307888 [debug] [MainThread]: Parsing macros/adapters/schema.sql
11:52:43.308907 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
11:52:43.310174 [debug] [MainThread]: Parsing macros/adapters/relation.sql
11:52:43.314852 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
11:52:43.316230 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
11:52:43.318350 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
11:52:43.321934 [debug] [MainThread]: Parsing macros/adapters/columns.sql
11:52:43.326688 [debug] [MainThread]: Parsing tests/generic/builtin.sql
11:52:43.328119 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
11:52:43.328603 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
11:52:43.329185 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
11:52:43.329878 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
11:52:43.332597 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
11:52:43.333141 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
11:52:43.334333 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
11:52:43.334932 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
11:52:43.336265 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
11:52:43.336945 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
11:52:43.337847 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
11:52:43.338935 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
11:52:43.343390 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
11:52:43.348527 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
11:52:43.349375 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
11:52:43.350205 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
11:52:43.350869 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
11:52:43.351627 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
11:52:43.352212 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
11:52:43.352928 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
11:52:43.353422 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
11:52:43.355002 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
11:52:43.357663 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
11:52:43.358515 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
11:52:43.359300 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
11:52:43.360964 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
11:52:43.363993 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
11:52:43.364737 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
11:52:43.366004 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
11:52:43.367116 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
11:52:43.368084 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
11:52:43.380955 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
11:52:43.381919 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
11:52:43.383166 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
11:52:43.383900 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
11:52:43.384742 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
11:52:43.385544 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
11:52:43.386616 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
11:52:43.387447 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
11:52:43.388184 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
11:52:43.389433 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
11:52:43.390446 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
11:52:43.391428 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
11:52:43.392016 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
11:52:43.393380 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
11:52:43.394360 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
11:52:43.395216 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
11:52:43.396264 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
11:52:43.397725 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
11:52:43.398396 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
11:52:43.400112 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
11:52:43.404885 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
11:52:43.405416 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
11:52:43.405985 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
11:52:43.406516 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
11:52:43.407070 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
11:52:43.409068 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
11:52:43.409997 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
11:52:43.411667 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
11:52:43.413764 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
11:52:43.415433 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
11:52:43.416228 [debug] [MainThread]: Parsing macros/sql/star.sql
11:52:43.418038 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
11:52:43.422125 [debug] [MainThread]: Parsing macros/sql/union.sql
11:52:43.428001 [debug] [MainThread]: Parsing macros/sql/groupby.sql
11:52:43.428635 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
11:52:43.432179 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
11:52:43.433833 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
11:52:43.434592 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
11:52:43.435353 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
11:52:43.438598 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
11:52:43.441378 [debug] [MainThread]: Parsing macros/sql/pivot.sql
11:52:43.443403 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
11:52:43.444724 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
11:52:43.445804 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
11:52:43.446616 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
11:52:43.449556 [debug] [MainThread]: Parsing macros/tables/bigquery/xts.sql
11:52:43.449976 [debug] [MainThread]: Parsing macros/tables/bigquery/pit.sql
11:52:43.461085 [debug] [MainThread]: Parsing macros/tables/bigquery/ma_sat.sql
11:52:43.469691 [debug] [MainThread]: Parsing macros/tables/bigquery/t_link.sql
11:52:43.470168 [debug] [MainThread]: Parsing macros/tables/bigquery/sat.sql
11:52:43.474995 [debug] [MainThread]: Parsing macros/tables/bigquery/hub.sql
11:52:43.481124 [debug] [MainThread]: Parsing macros/tables/bigquery/eff_sat.sql
11:52:43.488622 [debug] [MainThread]: Parsing macros/tables/bigquery/link.sql
11:52:43.494792 [debug] [MainThread]: Parsing macros/tables/bigquery/bridge.sql
11:52:43.517279 [debug] [MainThread]: Parsing macros/tables/snowflake/xts.sql
11:52:43.521660 [debug] [MainThread]: Parsing macros/tables/snowflake/pit.sql
11:52:43.535001 [debug] [MainThread]: Parsing macros/tables/snowflake/ma_sat.sql
11:52:43.542157 [debug] [MainThread]: Parsing macros/tables/snowflake/t_link.sql
11:52:43.545696 [debug] [MainThread]: Parsing macros/tables/snowflake/sat.sql
11:52:43.551878 [debug] [MainThread]: Parsing macros/tables/snowflake/hub.sql
11:52:43.558798 [debug] [MainThread]: Parsing macros/tables/snowflake/eff_sat.sql
11:52:43.567350 [debug] [MainThread]: Parsing macros/tables/snowflake/link.sql
11:52:43.574898 [debug] [MainThread]: Parsing macros/tables/snowflake/bridge.sql
11:52:43.597982 [debug] [MainThread]: Parsing macros/tables/sqlserver/xts.sql
11:52:43.598513 [debug] [MainThread]: Parsing macros/tables/sqlserver/pit.sql
11:52:43.599036 [debug] [MainThread]: Parsing macros/tables/sqlserver/ma_sat.sql
11:52:43.607657 [debug] [MainThread]: Parsing macros/tables/sqlserver/t_link.sql
11:52:43.608134 [debug] [MainThread]: Parsing macros/tables/sqlserver/sat.sql
11:52:43.613016 [debug] [MainThread]: Parsing macros/tables/sqlserver/hub.sql
11:52:43.620007 [debug] [MainThread]: Parsing macros/tables/sqlserver/eff_sat.sql
11:52:43.627423 [debug] [MainThread]: Parsing macros/tables/sqlserver/link.sql
11:52:43.634381 [debug] [MainThread]: Parsing macros/tables/sqlserver/bridge.sql
11:52:43.656682 [debug] [MainThread]: Parsing macros/staging/hash_columns.sql
11:52:43.658597 [debug] [MainThread]: Parsing macros/staging/source_columns.sql
11:52:43.659197 [debug] [MainThread]: Parsing macros/staging/stage.sql
11:52:43.664833 [debug] [MainThread]: Parsing macros/staging/rank_columns.sql
11:52:43.669876 [debug] [MainThread]: Parsing macros/staging/derive_columns.sql
11:52:43.672854 [debug] [MainThread]: Parsing macros/internal/metadata_processing/as_constant.sql
11:52:43.674128 [debug] [MainThread]: Parsing macros/internal/metadata_processing/escape_column_names.sql
11:52:43.681231 [debug] [MainThread]: Parsing macros/internal/metadata_processing/alias.sql
11:52:43.682950 [debug] [MainThread]: Parsing macros/internal/metadata_processing/concat_ws.sql
11:52:43.683978 [debug] [MainThread]: Parsing macros/internal/metadata_processing/multikey.sql
11:52:43.686597 [debug] [MainThread]: Parsing macros/internal/metadata_processing/expand_column_list.sql
11:52:43.688154 [debug] [MainThread]: Parsing macros/internal/metadata_processing/check_required_parameters.sql
11:52:43.688933 [debug] [MainThread]: Parsing macros/internal/metadata_processing/alias_all.sql
11:52:43.690049 [debug] [MainThread]: Parsing macros/internal/helpers/prepend_generated_by.sql
11:52:43.690225 [debug] [MainThread]: Parsing macros/internal/helpers/is_checks.sql
11:52:43.692519 [debug] [MainThread]: Parsing macros/internal/helpers/stage_processing_macros.sql
11:52:43.697833 [debug] [MainThread]: Parsing macros/materialisations/vault_insert_by_rank_materialization.sql
11:52:43.706405 [debug] [MainThread]: Parsing macros/materialisations/incremental_bridge_materialization.sql
11:52:43.709110 [debug] [MainThread]: Parsing macros/materialisations/shared_helpers.sql
11:52:43.709631 [debug] [MainThread]: Parsing macros/materialisations/vault_insert_by_period_materialization.sql
11:52:43.724760 [debug] [MainThread]: Parsing macros/materialisations/incremental_pit_bridge_replace.sql
11:52:43.725953 [debug] [MainThread]: Parsing macros/materialisations/incremental_pit_materialization.sql
11:52:43.728653 [debug] [MainThread]: Parsing macros/materialisations/mat_is_checks.sql
11:52:43.731866 [debug] [MainThread]: Parsing macros/materialisations/rank_mat_helpers/get_min_max_ranks.sql
11:52:43.733617 [debug] [MainThread]: Parsing macros/materialisations/rank_mat_helpers/replace_placeholder_with_rank_filter.sql
11:52:43.735529 [debug] [MainThread]: Parsing macros/materialisations/period_mat_helpers/replace_placeholder_with_period_filter.sql
11:52:43.739412 [debug] [MainThread]: Parsing macros/materialisations/period_mat_helpers/get_period_boundaries.sql
11:52:43.745617 [debug] [MainThread]: Parsing macros/materialisations/period_mat_helpers/get_start_stop_dates.sql
11:52:43.747927 [debug] [MainThread]: Parsing macros/materialisations/period_mat_helpers/get_period_filter_sql.sql
11:52:43.751216 [debug] [MainThread]: Parsing macros/materialisations/period_mat_helpers/get_period_of_load.sql
11:52:43.753775 [debug] [MainThread]: Parsing macros/supporting/datatypes.sql
11:52:43.754299 [debug] [MainThread]: Parsing macros/supporting/max_datetime.sql
11:52:43.755076 [debug] [MainThread]: Parsing macros/supporting/hash.sql
11:52:43.766435 [debug] [MainThread]: Parsing macros/supporting/prefix.sql
11:52:43.769480 [debug] [MainThread]: Parsing macros/supporting/current_timestamp.sql
11:52:43.770512 [debug] [MainThread]: Parsing macros/supporting/get_query_results_as_dict.sql
11:52:44.138250 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
11:52:44.143924 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
11:52:44.145044 [debug] [MainThread]: 1699: static parser successfully parsed stage_raw/facebook_accounts_staging_raw.sql
11:52:44.146120 [debug] [MainThread]: 1699: static parser successfully parsed stage_raw/facebook_ads_insights_staging_raw.sql
11:52:44.226545 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.HackdayVault.facebook_ads_insights_staging_raw
- models.HackdayVault.facebook_accounts_staging_raw

11:52:44.229586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8ef7de9-2463-4fc4-9551-764d6a503f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1301a20d0>]}
11:52:44.291500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8ef7de9-2463-4fc4-9551-764d6a503f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127fbe7c0>]}
11:52:44.291806 [info ] [MainThread]: Found 4 models, 9 tests, 0 snapshots, 0 analyses, 545 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
11:52:44.292000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8ef7de9-2463-4fc4-9551-764d6a503f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127d71970>]}
11:52:44.292265 [warn ] [MainThread]: The selection criterion 'tag:raw' does not match any nodes
11:52:44.292864 [info ] [MainThread]: 
11:52:44.293050 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
11:52:44.335383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127e61be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127d8ef70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127d8e2e0>]}


============================== 2022-06-29 11:54:18.526166 | f996a3f7-194f-497c-9017-496fd80e5a06 ==============================
11:54:18.526191 [info ] [MainThread]: Running with dbt=1.1.0
11:54:18.526730 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/adambekele/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['tag:', 'raw'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
11:54:18.526870 [debug] [MainThread]: Tracking: tracking
11:54:18.527136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11888e610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11888ee20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11888e910>]}
11:54:18.654155 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
11:54:18.654302 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
11:54:18.654536 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.HackdayVault.facebook_accounts_staging_raw
- models.HackdayVault.facebook_ads_insights_staging_raw

11:54:18.658111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f996a3f7-194f-497c-9017-496fd80e5a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118c1f0d0>]}
11:54:18.696202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f996a3f7-194f-497c-9017-496fd80e5a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b72970>]}
11:54:18.696444 [info ] [MainThread]: Found 4 models, 9 tests, 0 snapshots, 0 analyses, 545 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
11:54:18.696624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f996a3f7-194f-497c-9017-496fd80e5a06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b72820>]}
11:54:18.696873 [warn ] [MainThread]: The selection criterion 'tag:' does not match any nodes
11:54:18.697083 [warn ] [MainThread]: The selection criterion 'raw' does not match any nodes
11:54:18.697619 [info ] [MainThread]: 
11:54:18.697785 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
11:54:18.736001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b72490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b72430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b72640>]}


============================== 2022-06-29 12:03:27.275861 | 11f56237-2f1a-41de-bb28-80ccb509e37f ==============================
12:03:27.275885 [info ] [MainThread]: Running with dbt=1.1.0
12:03:27.276495 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/adambekele/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['facebook_ads_insights_staging_raw+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
12:03:27.276642 [debug] [MainThread]: Tracking: tracking
12:03:27.276897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128173790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128173940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128160dc0>]}
12:03:27.385562 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
12:03:27.385788 [debug] [MainThread]: Partial parsing: added file: HackdayVault://models/stage_hashed/facebook_accounts_staging_hashed.sql
12:03:27.385896 [debug] [MainThread]: Partial parsing: added file: HackdayVault://models/stage_hashed/facebook_ads_insights_staging_hashed.sql
12:03:27.392777 [debug] [MainThread]: 1699: static parser successfully parsed stage_hashed/facebook_accounts_staging_hashed.sql
12:03:27.399591 [debug] [MainThread]: 1603: static parser failed on stage_hashed/facebook_ads_insights_staging_hashed.sql
12:03:27.459442 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage_hashed/facebook_ads_insights_staging_hashed.sql
12:03:27.464290 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.HackdayVault.facebook_accounts_staging_raw
- models.HackdayVault.facebook_ads_insights_staging_raw

12:03:27.467142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11f56237-2f1a-41de-bb28-80ccb509e37f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1284080d0>]}
12:03:27.513910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11f56237-2f1a-41de-bb28-80ccb509e37f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1282b8790>]}
12:03:27.514166 [info ] [MainThread]: Found 6 models, 9 tests, 0 snapshots, 0 analyses, 545 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
12:03:27.514365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11f56237-2f1a-41de-bb28-80ccb509e37f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1282b8850>]}
12:03:27.515196 [info ] [MainThread]: 
12:03:27.515516 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:03:27.516027 [debug] [ThreadPool]: Acquiring new snowflake connection "list_BLINKIST_DEV"
12:03:27.524590 [debug] [ThreadPool]: Using snowflake connection "list_BLINKIST_DEV"
12:03:27.525010 [debug] [ThreadPool]: On list_BLINKIST_DEV: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "connection_name": "list_BLINKIST_DEV"} */

    show terse schemas in database BLINKIST_DEV
    limit 10000
12:03:27.525215 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:03:28.846207 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.32 seconds
12:03:28.850013 [debug] [ThreadPool]: On list_BLINKIST_DEV: Close
12:03:29.162962 [debug] [ThreadPool]: Acquiring new snowflake connection "list_BLINKIST_DEV_hackday"
12:03:29.174285 [debug] [ThreadPool]: Using snowflake connection "list_BLINKIST_DEV_hackday"
12:03:29.174609 [debug] [ThreadPool]: On list_BLINKIST_DEV_hackday: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "connection_name": "list_BLINKIST_DEV_hackday"} */

    show terse objects in BLINKIST_DEV.hackday
12:03:29.174835 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:03:30.371453 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.2 seconds
12:03:30.375550 [debug] [ThreadPool]: On list_BLINKIST_DEV_hackday: Close
12:03:30.715973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11f56237-2f1a-41de-bb28-80ccb509e37f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1282b8b20>]}
12:03:30.717399 [info ] [MainThread]: Concurrency: 4 threads (target='hackday')
12:03:30.718141 [info ] [MainThread]: 
12:03:30.724491 [debug] [Thread-1  ]: Began running node model.HackdayVault.facebook_ads_insights_staging_raw
12:03:30.725460 [info ] [Thread-1  ]: 1 of 2 START view model hackday.facebook_ads_insights_staging_raw .............. [RUN]
12:03:30.726151 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.HackdayVault.facebook_ads_insights_staging_raw"
12:03:30.726412 [debug] [Thread-1  ]: Began compiling node model.HackdayVault.facebook_ads_insights_staging_raw
12:03:30.726649 [debug] [Thread-1  ]: Compiling model.HackdayVault.facebook_ads_insights_staging_raw
12:03:30.730707 [debug] [Thread-1  ]: Writing injected SQL for node "model.HackdayVault.facebook_ads_insights_staging_raw"
12:03:30.735336 [debug] [Thread-1  ]: finished collecting timing info
12:03:30.735672 [debug] [Thread-1  ]: Began executing node model.HackdayVault.facebook_ads_insights_staging_raw
12:03:30.760260 [debug] [Thread-1  ]: Writing runtime SQL for node "model.HackdayVault.facebook_ads_insights_staging_raw"
12:03:30.763688 [debug] [Thread-1  ]: Using snowflake connection "model.HackdayVault.facebook_ads_insights_staging_raw"
12:03:30.763916 [debug] [Thread-1  ]: On model.HackdayVault.facebook_ads_insights_staging_raw: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_ads_insights_staging_raw"} */

  create or replace  view BLINKIST_DEV.hackday.facebook_ads_insights_staging_raw
  
   as (
    SELECT
    *
FROM FIVETRAN_DATABASE.facebook.ads_insights
  );
12:03:30.764038 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:03:32.635057 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.87 seconds
12:03:32.648095 [debug] [Thread-1  ]: finished collecting timing info
12:03:32.648575 [debug] [Thread-1  ]: On model.HackdayVault.facebook_ads_insights_staging_raw: Close
12:03:32.952920 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11f56237-2f1a-41de-bb28-80ccb509e37f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128a73dc0>]}
12:03:32.953873 [info ] [Thread-1  ]: 1 of 2 OK created view model hackday.facebook_ads_insights_staging_raw ......... [[32mSUCCESS 1[0m in 2.23s]
12:03:32.954712 [debug] [Thread-1  ]: Finished running node model.HackdayVault.facebook_ads_insights_staging_raw
12:03:32.955572 [debug] [Thread-3  ]: Began running node model.HackdayVault.facebook_ads_insights_staging_hashed
12:03:32.956016 [info ] [Thread-3  ]: 2 of 2 START view model hackday.facebook_ads_insights_staging_hashed ........... [RUN]
12:03:32.956660 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.HackdayVault.facebook_ads_insights_staging_hashed"
12:03:32.956883 [debug] [Thread-3  ]: Began compiling node model.HackdayVault.facebook_ads_insights_staging_hashed
12:03:32.957099 [debug] [Thread-3  ]: Compiling model.HackdayVault.facebook_ads_insights_staging_hashed
12:03:32.977090 [debug] [Thread-3  ]: Using snowflake connection "model.HackdayVault.facebook_ads_insights_staging_hashed"
12:03:32.977440 [debug] [Thread-3  ]: On model.HackdayVault.facebook_ads_insights_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_ads_insights_staging_hashed"} */

    describe table BLINKIST_DEV.hackday.facebook_ads_insights_staging_raw
12:03:32.977605 [debug] [Thread-3  ]: Opening a new connection, currently in state init
12:03:33.961089 [debug] [Thread-3  ]: SQL status: SUCCESS 35 in 0.98 seconds
12:03:34.008122 [debug] [Thread-3  ]: Using snowflake connection "model.HackdayVault.facebook_ads_insights_staging_hashed"
12:03:34.008348 [debug] [Thread-3  ]: On model.HackdayVault.facebook_ads_insights_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_ads_insights_staging_hashed"} */

    describe table BLINKIST_DEV.hackday.facebook_ads_insights_staging_raw
12:03:34.228217 [debug] [Thread-3  ]: SQL status: SUCCESS 35 in 0.22 seconds
12:03:34.290898 [debug] [Thread-3  ]: Writing injected SQL for node "model.HackdayVault.facebook_ads_insights_staging_hashed"
12:03:34.292818 [debug] [Thread-3  ]: finished collecting timing info
12:03:34.292950 [debug] [Thread-3  ]: Began executing node model.HackdayVault.facebook_ads_insights_staging_hashed
12:03:34.294992 [debug] [Thread-3  ]: Writing runtime SQL for node "model.HackdayVault.facebook_ads_insights_staging_hashed"
12:03:34.297165 [debug] [Thread-3  ]: Using snowflake connection "model.HackdayVault.facebook_ads_insights_staging_hashed"
12:03:34.297274 [debug] [Thread-3  ]: On model.HackdayVault.facebook_ads_insights_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_ads_insights_staging_hashed"} */

  create or replace  view BLINKIST_DEV.hackday.facebook_ads_insights_staging_hashed
  
   as (
    







-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    "AD_ID",
    "DATE",
    "COUNTRY",
    "ACCOUNT_ID",
    "ADSET_ID",
    "CLICKS",
    "IMPRESSIONS",
    "INLINE_LINK_CLICKS",
    "UNIQUE_CLICKS",
    "UNIQUE_INLINE_LINK_CLICKS",
    "FULL_VIEW_REACH",
    "COST_PER_INLINE_LINK_CLICK",
    "COST_PER_INLINE_POST_ENGAGEMENT",
    "COST_PER_UNIQUE_CLICK",
    "COST_PER_UNIQUE_INLINE_LINK_CLICK",
    "COST_PER_ESTIMATED_AD_RECALLERS",
    "SOCIAL_SPEND",
    "UNIQUE_LINK_CLICKS_CTR",
    "ESTIMATED_AD_RECALL_RATE",
    "ESTIMATED_AD_RECALLERS",
    "UNIQUE_CTR",
    "UNIQUE_INLINE_LINK_CLICK_CTR",
    "CPC",
    "CPM",
    "CPP",
    "CTR",
    "FREQUENCY",
    "SPEND",
    "ACCOUNT_NAME",
    "AD_NAME",
    "INLINE_LINK_CLICK_CTR",
    "INLINE_POST_ENGAGEMENT",
    "LOCATION",
    "OBJECTIVE",
    "_FIVETRAN_SYNCED"

    FROM BLINKIST_DEV.hackday.facebook_ads_insights_staging_raw
),

derived_columns AS (

    SELECT

    "AD_ID",
    "DATE",
    "COUNTRY",
    "ACCOUNT_ID",
    "ADSET_ID",
    "CLICKS",
    "IMPRESSIONS",
    "INLINE_LINK_CLICKS",
    "UNIQUE_CLICKS",
    "UNIQUE_INLINE_LINK_CLICKS",
    "FULL_VIEW_REACH",
    "COST_PER_INLINE_LINK_CLICK",
    "COST_PER_INLINE_POST_ENGAGEMENT",
    "COST_PER_UNIQUE_CLICK",
    "COST_PER_UNIQUE_INLINE_LINK_CLICK",
    "COST_PER_ESTIMATED_AD_RECALLERS",
    "SOCIAL_SPEND",
    "UNIQUE_LINK_CLICKS_CTR",
    "ESTIMATED_AD_RECALL_RATE",
    "ESTIMATED_AD_RECALLERS",
    "UNIQUE_CTR",
    "UNIQUE_INLINE_LINK_CLICK_CTR",
    "CPC",
    "CPM",
    "CPP",
    "CTR",
    "FREQUENCY",
    "SPEND",
    "ACCOUNT_NAME",
    "AD_NAME",
    "INLINE_LINK_CLICK_CTR",
    "INLINE_POST_ENGAGEMENT",
    "LOCATION",
    "OBJECTIVE",
    "_FIVETRAN_SYNCED",
    'FIVETRAN_FACEBOOK_ADS_INSIGHTS_RAW' AS "RECORD_SOURCE"

    FROM source_data
),

hashed_columns AS (

    SELECT

    "AD_ID",
    "DATE",
    "COUNTRY",
    "ACCOUNT_ID",
    "ADSET_ID",
    "CLICKS",
    "IMPRESSIONS",
    "INLINE_LINK_CLICKS",
    "UNIQUE_CLICKS",
    "UNIQUE_INLINE_LINK_CLICKS",
    "FULL_VIEW_REACH",
    "COST_PER_INLINE_LINK_CLICK",
    "COST_PER_INLINE_POST_ENGAGEMENT",
    "COST_PER_UNIQUE_CLICK",
    "COST_PER_UNIQUE_INLINE_LINK_CLICK",
    "COST_PER_ESTIMATED_AD_RECALLERS",
    "SOCIAL_SPEND",
    "UNIQUE_LINK_CLICKS_CTR",
    "ESTIMATED_AD_RECALL_RATE",
    "ESTIMATED_AD_RECALLERS",
    "UNIQUE_CTR",
    "UNIQUE_INLINE_LINK_CLICK_CTR",
    "CPC",
    "CPM",
    "CPP",
    "CTR",
    "FREQUENCY",
    "SPEND",
    "ACCOUNT_NAME",
    "AD_NAME",
    "INLINE_LINK_CLICK_CTR",
    "INLINE_POST_ENGAGEMENT",
    "LOCATION",
    "OBJECTIVE",
    "_FIVETRAN_SYNCED",
    "RECORD_SOURCE",

    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("country_code" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("date" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("ad_id" AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS "facebook_ads_insights_hk"

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    "AD_ID",
    "DATE",
    "COUNTRY",
    "ACCOUNT_ID",
    "ADSET_ID",
    "CLICKS",
    "IMPRESSIONS",
    "INLINE_LINK_CLICKS",
    "UNIQUE_CLICKS",
    "UNIQUE_INLINE_LINK_CLICKS",
    "FULL_VIEW_REACH",
    "COST_PER_INLINE_LINK_CLICK",
    "COST_PER_INLINE_POST_ENGAGEMENT",
    "COST_PER_UNIQUE_CLICK",
    "COST_PER_UNIQUE_INLINE_LINK_CLICK",
    "COST_PER_ESTIMATED_AD_RECALLERS",
    "SOCIAL_SPEND",
    "UNIQUE_LINK_CLICKS_CTR",
    "ESTIMATED_AD_RECALL_RATE",
    "ESTIMATED_AD_RECALLERS",
    "UNIQUE_CTR",
    "UNIQUE_INLINE_LINK_CLICK_CTR",
    "CPC",
    "CPM",
    "CPP",
    "CTR",
    "FREQUENCY",
    "SPEND",
    "ACCOUNT_NAME",
    "AD_NAME",
    "INLINE_LINK_CLICK_CTR",
    "INLINE_POST_ENGAGEMENT",
    "LOCATION",
    "OBJECTIVE",
    "_FIVETRAN_SYNCED",
    "RECORD_SOURCE",
    "FACEBOOK_ADS_INSIGHTS_HK"

    FROM hashed_columns
)

SELECT * FROM columns_to_select
  );
12:03:34.588736 [debug] [Thread-3  ]: Snowflake adapter: Snowflake query id: 01a54553-0000-a4a0-0002-346600347f22
12:03:34.588919 [debug] [Thread-3  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 145 at position 38
invalid identifier '"country_code"'
12:03:34.589105 [debug] [Thread-3  ]: finished collecting timing info
12:03:34.589220 [debug] [Thread-3  ]: On model.HackdayVault.facebook_ads_insights_staging_hashed: Close
12:03:34.922534 [debug] [Thread-3  ]: Database Error in model facebook_ads_insights_staging_hashed (models/stage_hashed/facebook_ads_insights_staging_hashed.sql)
  000904 (42000): SQL compilation error: error line 145 at position 38
  invalid identifier '"country_code"'
  compiled SQL at target/run/HackdayVault/models/stage_hashed/facebook_ads_insights_staging_hashed.sql
12:03:34.923543 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11f56237-2f1a-41de-bb28-80ccb509e37f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128a6c970>]}
12:03:34.924344 [error] [Thread-3  ]: 2 of 2 ERROR creating view model hackday.facebook_ads_insights_staging_hashed .. [[31mERROR[0m in 1.97s]
12:03:34.925120 [debug] [Thread-3  ]: Finished running node model.HackdayVault.facebook_ads_insights_staging_hashed
12:03:34.926720 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:03:34.927196 [info ] [MainThread]: 
12:03:34.927588 [info ] [MainThread]: Finished running 2 view models in 7.41s.
12:03:34.928108 [debug] [MainThread]: Connection 'master' was properly closed.
12:03:34.928327 [debug] [MainThread]: Connection 'model.HackdayVault.facebook_ads_insights_staging_raw' was properly closed.
12:03:34.928533 [debug] [MainThread]: Connection 'model.HackdayVault.facebook_ads_insights_staging_hashed' was properly closed.
12:03:35.008776 [info ] [MainThread]: 
12:03:35.009186 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
12:03:35.009453 [info ] [MainThread]: 
12:03:35.009788 [error] [MainThread]: [33mDatabase Error in model facebook_ads_insights_staging_hashed (models/stage_hashed/facebook_ads_insights_staging_hashed.sql)[0m
12:03:35.010056 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 145 at position 38
12:03:35.010262 [error] [MainThread]:   invalid identifier '"country_code"'
12:03:35.010466 [error] [MainThread]:   compiled SQL at target/run/HackdayVault/models/stage_hashed/facebook_ads_insights_staging_hashed.sql
12:03:35.010680 [info ] [MainThread]: 
12:03:35.010889 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
12:03:35.011179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128a8f7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128aa26a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128822ee0>]}


============================== 2022-06-29 12:06:02.784544 | 62ce8bff-f0ce-41dc-9f80-22e8ea7f0aa5 ==============================
12:06:02.784594 [info ] [MainThread]: Running with dbt=1.1.0
12:06:02.785350 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/adambekele/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['facebook_ads_insights_staging_raw+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
12:06:02.785516 [debug] [MainThread]: Tracking: tracking
12:06:02.785809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125362d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125362a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125362df0>]}
12:06:02.923735 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:06:02.923994 [debug] [MainThread]: Partial parsing: updated file: HackdayVault://models/stage_hashed/facebook_ads_insights_staging_hashed.sql
12:06:02.930964 [debug] [MainThread]: 1603: static parser failed on stage_hashed/facebook_ads_insights_staging_hashed.sql
12:06:02.947979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12681a760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12691b280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12691b250>]}


============================== 2022-06-29 12:06:47.723518 | 234ce4ce-c9bb-463b-9b3b-697e4170be3b ==============================
12:06:47.723538 [info ] [MainThread]: Running with dbt=1.1.0
12:06:47.724063 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/adambekele/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['facebook_ads_insights_staging_raw+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
12:06:47.724200 [debug] [MainThread]: Tracking: tracking
12:06:47.724429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118e3d040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118e3d220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118e3d790>]}
12:06:47.833766 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:06:47.834041 [debug] [MainThread]: Partial parsing: updated file: HackdayVault://models/stage_hashed/facebook_ads_insights_staging_hashed.sql
12:06:47.841108 [debug] [MainThread]: 1603: static parser failed on stage_hashed/facebook_ads_insights_staging_hashed.sql
12:06:47.909187 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage_hashed/facebook_ads_insights_staging_hashed.sql
12:06:47.915019 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.HackdayVault.facebook_ads_insights_staging_raw
- models.HackdayVault.facebook_accounts_staging_raw

12:06:47.918022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '234ce4ce-c9bb-463b-9b3b-697e4170be3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11909e0d0>]}
12:06:47.967551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '234ce4ce-c9bb-463b-9b3b-697e4170be3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118de78e0>]}
12:06:47.967799 [info ] [MainThread]: Found 6 models, 9 tests, 0 snapshots, 0 analyses, 545 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
12:06:47.967975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '234ce4ce-c9bb-463b-9b3b-697e4170be3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118de79d0>]}
12:06:47.968724 [info ] [MainThread]: 
12:06:47.969034 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:06:47.969545 [debug] [ThreadPool]: Acquiring new snowflake connection "list_BLINKIST_DEV"
12:06:47.977149 [debug] [ThreadPool]: Using snowflake connection "list_BLINKIST_DEV"
12:06:47.977264 [debug] [ThreadPool]: On list_BLINKIST_DEV: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "connection_name": "list_BLINKIST_DEV"} */

    show terse schemas in database BLINKIST_DEV
    limit 10000
12:06:47.977352 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:06:49.404847 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.43 seconds
12:06:49.408805 [debug] [ThreadPool]: On list_BLINKIST_DEV: Close
12:06:49.793509 [debug] [ThreadPool]: Acquiring new snowflake connection "list_BLINKIST_DEV_hackday"
12:06:49.805865 [debug] [ThreadPool]: Using snowflake connection "list_BLINKIST_DEV_hackday"
12:06:49.806126 [debug] [ThreadPool]: On list_BLINKIST_DEV_hackday: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "connection_name": "list_BLINKIST_DEV_hackday"} */

    show terse objects in BLINKIST_DEV.hackday
12:06:49.806321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:06:50.848775 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.04 seconds
12:06:50.853167 [debug] [ThreadPool]: On list_BLINKIST_DEV_hackday: Close
12:06:51.164521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '234ce4ce-c9bb-463b-9b3b-697e4170be3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118df9040>]}
12:06:51.165930 [info ] [MainThread]: Concurrency: 4 threads (target='hackday')
12:06:51.166558 [info ] [MainThread]: 
12:06:51.173008 [debug] [Thread-1  ]: Began running node model.HackdayVault.facebook_ads_insights_staging_raw
12:06:51.173893 [info ] [Thread-1  ]: 1 of 2 START view model hackday.facebook_ads_insights_staging_raw .............. [RUN]
12:06:51.174554 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.HackdayVault.facebook_ads_insights_staging_raw"
12:06:51.174805 [debug] [Thread-1  ]: Began compiling node model.HackdayVault.facebook_ads_insights_staging_raw
12:06:51.175054 [debug] [Thread-1  ]: Compiling model.HackdayVault.facebook_ads_insights_staging_raw
12:06:51.179379 [debug] [Thread-1  ]: Writing injected SQL for node "model.HackdayVault.facebook_ads_insights_staging_raw"
12:06:51.184065 [debug] [Thread-1  ]: finished collecting timing info
12:06:51.184351 [debug] [Thread-1  ]: Began executing node model.HackdayVault.facebook_ads_insights_staging_raw
12:06:51.209944 [debug] [Thread-1  ]: Writing runtime SQL for node "model.HackdayVault.facebook_ads_insights_staging_raw"
12:06:51.213322 [debug] [Thread-1  ]: Using snowflake connection "model.HackdayVault.facebook_ads_insights_staging_raw"
12:06:51.213608 [debug] [Thread-1  ]: On model.HackdayVault.facebook_ads_insights_staging_raw: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_ads_insights_staging_raw"} */

  create or replace  view BLINKIST_DEV.hackday.facebook_ads_insights_staging_raw
  
   as (
    SELECT
    *
FROM FIVETRAN_DATABASE.facebook.ads_insights
  );
12:06:51.213746 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:06:52.238148 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.02 seconds
12:06:52.250848 [debug] [Thread-1  ]: finished collecting timing info
12:06:52.251161 [debug] [Thread-1  ]: On model.HackdayVault.facebook_ads_insights_staging_raw: Close
12:06:52.554691 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '234ce4ce-c9bb-463b-9b3b-697e4170be3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118df9040>]}
12:06:52.555583 [info ] [Thread-1  ]: 1 of 2 OK created view model hackday.facebook_ads_insights_staging_raw ......... [[32mSUCCESS 1[0m in 1.38s]
12:06:52.556409 [debug] [Thread-1  ]: Finished running node model.HackdayVault.facebook_ads_insights_staging_raw
12:06:52.557374 [debug] [Thread-3  ]: Began running node model.HackdayVault.facebook_ads_insights_staging_hashed
12:06:52.557996 [info ] [Thread-3  ]: 2 of 2 START view model hackday.facebook_ads_insights_staging_hashed ........... [RUN]
12:06:52.558826 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.HackdayVault.facebook_ads_insights_staging_hashed"
12:06:52.559065 [debug] [Thread-3  ]: Began compiling node model.HackdayVault.facebook_ads_insights_staging_hashed
12:06:52.559288 [debug] [Thread-3  ]: Compiling model.HackdayVault.facebook_ads_insights_staging_hashed
12:06:52.578581 [debug] [Thread-3  ]: Using snowflake connection "model.HackdayVault.facebook_ads_insights_staging_hashed"
12:06:52.578913 [debug] [Thread-3  ]: On model.HackdayVault.facebook_ads_insights_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_ads_insights_staging_hashed"} */

    describe table BLINKIST_DEV.hackday.facebook_ads_insights_staging_raw
12:06:52.579076 [debug] [Thread-3  ]: Opening a new connection, currently in state init
12:06:53.486670 [debug] [Thread-3  ]: SQL status: SUCCESS 35 in 0.91 seconds
12:06:53.541327 [debug] [Thread-3  ]: Using snowflake connection "model.HackdayVault.facebook_ads_insights_staging_hashed"
12:06:53.541580 [debug] [Thread-3  ]: On model.HackdayVault.facebook_ads_insights_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_ads_insights_staging_hashed"} */

    describe table BLINKIST_DEV.hackday.facebook_ads_insights_staging_raw
12:06:53.737040 [debug] [Thread-3  ]: SQL status: SUCCESS 35 in 0.2 seconds
12:06:53.802137 [debug] [Thread-3  ]: Writing injected SQL for node "model.HackdayVault.facebook_ads_insights_staging_hashed"
12:06:53.808263 [debug] [Thread-3  ]: finished collecting timing info
12:06:53.808398 [debug] [Thread-3  ]: Began executing node model.HackdayVault.facebook_ads_insights_staging_hashed
12:06:53.810527 [debug] [Thread-3  ]: Writing runtime SQL for node "model.HackdayVault.facebook_ads_insights_staging_hashed"
12:06:53.815756 [debug] [Thread-3  ]: Using snowflake connection "model.HackdayVault.facebook_ads_insights_staging_hashed"
12:06:53.815875 [debug] [Thread-3  ]: On model.HackdayVault.facebook_ads_insights_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_ads_insights_staging_hashed"} */

  create or replace  view BLINKIST_DEV.hackday.facebook_ads_insights_staging_hashed
  
   as (
    







-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    "AD_ID",
    "DATE",
    "COUNTRY",
    "ACCOUNT_ID",
    "ADSET_ID",
    "CLICKS",
    "IMPRESSIONS",
    "INLINE_LINK_CLICKS",
    "UNIQUE_CLICKS",
    "UNIQUE_INLINE_LINK_CLICKS",
    "FULL_VIEW_REACH",
    "COST_PER_INLINE_LINK_CLICK",
    "COST_PER_INLINE_POST_ENGAGEMENT",
    "COST_PER_UNIQUE_CLICK",
    "COST_PER_UNIQUE_INLINE_LINK_CLICK",
    "COST_PER_ESTIMATED_AD_RECALLERS",
    "SOCIAL_SPEND",
    "UNIQUE_LINK_CLICKS_CTR",
    "ESTIMATED_AD_RECALL_RATE",
    "ESTIMATED_AD_RECALLERS",
    "UNIQUE_CTR",
    "UNIQUE_INLINE_LINK_CLICK_CTR",
    "CPC",
    "CPM",
    "CPP",
    "CTR",
    "FREQUENCY",
    "SPEND",
    "ACCOUNT_NAME",
    "AD_NAME",
    "INLINE_LINK_CLICK_CTR",
    "INLINE_POST_ENGAGEMENT",
    "LOCATION",
    "OBJECTIVE",
    "_FIVETRAN_SYNCED"

    FROM BLINKIST_DEV.hackday.facebook_ads_insights_staging_raw
),

derived_columns AS (

    SELECT

    "AD_ID",
    "DATE",
    "COUNTRY",
    "ACCOUNT_ID",
    "ADSET_ID",
    "CLICKS",
    "IMPRESSIONS",
    "INLINE_LINK_CLICKS",
    "UNIQUE_CLICKS",
    "UNIQUE_INLINE_LINK_CLICKS",
    "FULL_VIEW_REACH",
    "COST_PER_INLINE_LINK_CLICK",
    "COST_PER_INLINE_POST_ENGAGEMENT",
    "COST_PER_UNIQUE_CLICK",
    "COST_PER_UNIQUE_INLINE_LINK_CLICK",
    "COST_PER_ESTIMATED_AD_RECALLERS",
    "SOCIAL_SPEND",
    "UNIQUE_LINK_CLICKS_CTR",
    "ESTIMATED_AD_RECALL_RATE",
    "ESTIMATED_AD_RECALLERS",
    "UNIQUE_CTR",
    "UNIQUE_INLINE_LINK_CLICK_CTR",
    "CPC",
    "CPM",
    "CPP",
    "CTR",
    "FREQUENCY",
    "SPEND",
    "ACCOUNT_NAME",
    "AD_NAME",
    "INLINE_LINK_CLICK_CTR",
    "INLINE_POST_ENGAGEMENT",
    "LOCATION",
    "OBJECTIVE",
    "_FIVETRAN_SYNCED",
    'FIVETRAN_FACEBOOK_ADS_INSIGHTS_RAW' AS "RECORD_SOURCE"

    FROM source_data
),

hashed_columns AS (

    SELECT

    "AD_ID",
    "DATE",
    "COUNTRY",
    "ACCOUNT_ID",
    "ADSET_ID",
    "CLICKS",
    "IMPRESSIONS",
    "INLINE_LINK_CLICKS",
    "UNIQUE_CLICKS",
    "UNIQUE_INLINE_LINK_CLICKS",
    "FULL_VIEW_REACH",
    "COST_PER_INLINE_LINK_CLICK",
    "COST_PER_INLINE_POST_ENGAGEMENT",
    "COST_PER_UNIQUE_CLICK",
    "COST_PER_UNIQUE_INLINE_LINK_CLICK",
    "COST_PER_ESTIMATED_AD_RECALLERS",
    "SOCIAL_SPEND",
    "UNIQUE_LINK_CLICKS_CTR",
    "ESTIMATED_AD_RECALL_RATE",
    "ESTIMATED_AD_RECALLERS",
    "UNIQUE_CTR",
    "UNIQUE_INLINE_LINK_CLICK_CTR",
    "CPC",
    "CPM",
    "CPP",
    "CTR",
    "FREQUENCY",
    "SPEND",
    "ACCOUNT_NAME",
    "AD_NAME",
    "INLINE_LINK_CLICK_CTR",
    "INLINE_POST_ENGAGEMENT",
    "LOCATION",
    "OBJECTIVE",
    "_FIVETRAN_SYNCED",
    "RECORD_SOURCE",

    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("COUNTRY_CODE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("DATE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("AD_ID" AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS "facebook_ads_insights_hk"

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    "AD_ID",
    "DATE",
    "COUNTRY",
    "ACCOUNT_ID",
    "ADSET_ID",
    "CLICKS",
    "IMPRESSIONS",
    "INLINE_LINK_CLICKS",
    "UNIQUE_CLICKS",
    "UNIQUE_INLINE_LINK_CLICKS",
    "FULL_VIEW_REACH",
    "COST_PER_INLINE_LINK_CLICK",
    "COST_PER_INLINE_POST_ENGAGEMENT",
    "COST_PER_UNIQUE_CLICK",
    "COST_PER_UNIQUE_INLINE_LINK_CLICK",
    "COST_PER_ESTIMATED_AD_RECALLERS",
    "SOCIAL_SPEND",
    "UNIQUE_LINK_CLICKS_CTR",
    "ESTIMATED_AD_RECALL_RATE",
    "ESTIMATED_AD_RECALLERS",
    "UNIQUE_CTR",
    "UNIQUE_INLINE_LINK_CLICK_CTR",
    "CPC",
    "CPM",
    "CPP",
    "CTR",
    "FREQUENCY",
    "SPEND",
    "ACCOUNT_NAME",
    "AD_NAME",
    "INLINE_LINK_CLICK_CTR",
    "INLINE_POST_ENGAGEMENT",
    "LOCATION",
    "OBJECTIVE",
    "_FIVETRAN_SYNCED",
    "RECORD_SOURCE",
    "FACEBOOK_ADS_INSIGHTS_HK"

    FROM hashed_columns
)

SELECT * FROM columns_to_select
  );
12:06:54.087801 [debug] [Thread-3  ]: Snowflake adapter: Snowflake query id: 01a54556-0000-a4a0-0002-346600347fb2
12:06:54.088196 [debug] [Thread-3  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 145 at position 38
invalid identifier 'COUNTRY_CODE'
12:06:54.088632 [debug] [Thread-3  ]: finished collecting timing info
12:06:54.088804 [debug] [Thread-3  ]: On model.HackdayVault.facebook_ads_insights_staging_hashed: Close
12:06:54.405342 [debug] [Thread-3  ]: Database Error in model facebook_ads_insights_staging_hashed (models/stage_hashed/facebook_ads_insights_staging_hashed.sql)
  000904 (42000): SQL compilation error: error line 145 at position 38
  invalid identifier 'COUNTRY_CODE'
  compiled SQL at target/run/HackdayVault/models/stage_hashed/facebook_ads_insights_staging_hashed.sql
12:06:54.406094 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '234ce4ce-c9bb-463b-9b3b-697e4170be3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11976a640>]}
12:06:54.406772 [error] [Thread-3  ]: 2 of 2 ERROR creating view model hackday.facebook_ads_insights_staging_hashed .. [[31mERROR[0m in 1.85s]
12:06:54.407585 [debug] [Thread-3  ]: Finished running node model.HackdayVault.facebook_ads_insights_staging_hashed
12:06:54.409254 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:06:54.409766 [info ] [MainThread]: 
12:06:54.410179 [info ] [MainThread]: Finished running 2 view models in 6.44s.
12:06:54.410545 [debug] [MainThread]: Connection 'master' was properly closed.
12:06:54.410740 [debug] [MainThread]: Connection 'model.HackdayVault.facebook_ads_insights_staging_raw' was properly closed.
12:06:54.410933 [debug] [MainThread]: Connection 'model.HackdayVault.facebook_ads_insights_staging_hashed' was properly closed.
12:06:54.495349 [info ] [MainThread]: 
12:06:54.495720 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
12:06:54.495981 [info ] [MainThread]: 
12:06:54.496206 [error] [MainThread]: [33mDatabase Error in model facebook_ads_insights_staging_hashed (models/stage_hashed/facebook_ads_insights_staging_hashed.sql)[0m
12:06:54.496423 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 145 at position 38
12:06:54.496627 [error] [MainThread]:   invalid identifier 'COUNTRY_CODE'
12:06:54.496829 [error] [MainThread]:   compiled SQL at target/run/HackdayVault/models/stage_hashed/facebook_ads_insights_staging_hashed.sql
12:06:54.497039 [info ] [MainThread]: 
12:06:54.497250 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
12:06:54.497545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1195df3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1195f4130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1196fc940>]}


============================== 2022-06-29 12:07:32.050211 | 1f310eaa-bf9e-4236-802f-407c0390a260 ==============================
12:07:32.050235 [info ] [MainThread]: Running with dbt=1.1.0
12:07:32.051951 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/adambekele/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['facebook_ads_insights_staging_raw+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
12:07:32.052094 [debug] [MainThread]: Tracking: tracking
12:07:32.052364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f0fe550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f0fef70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f0fe5b0>]}
12:07:32.195594 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:07:32.195863 [debug] [MainThread]: Partial parsing: updated file: HackdayVault://models/stage_hashed/facebook_ads_insights_staging_hashed.sql
12:07:32.203987 [debug] [MainThread]: 1603: static parser failed on stage_hashed/facebook_ads_insights_staging_hashed.sql
12:07:32.271554 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage_hashed/facebook_ads_insights_staging_hashed.sql
12:07:32.277224 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.HackdayVault.facebook_ads_insights_staging_raw
- models.HackdayVault.facebook_accounts_staging_raw

12:07:32.280111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f310eaa-bf9e-4236-802f-407c0390a260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f4190d0>]}
12:07:32.319987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f310eaa-bf9e-4236-802f-407c0390a260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f29ba30>]}
12:07:32.320222 [info ] [MainThread]: Found 6 models, 9 tests, 0 snapshots, 0 analyses, 545 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
12:07:32.320397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f310eaa-bf9e-4236-802f-407c0390a260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f29baf0>]}
12:07:32.321182 [info ] [MainThread]: 
12:07:32.321492 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:07:32.321966 [debug] [ThreadPool]: Acquiring new snowflake connection "list_BLINKIST_DEV"
12:07:32.329364 [debug] [ThreadPool]: Using snowflake connection "list_BLINKIST_DEV"
12:07:32.329502 [debug] [ThreadPool]: On list_BLINKIST_DEV: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "connection_name": "list_BLINKIST_DEV"} */

    show terse schemas in database BLINKIST_DEV
    limit 10000
12:07:32.329595 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:07:33.724487 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.39 seconds
12:07:33.728300 [debug] [ThreadPool]: On list_BLINKIST_DEV: Close
12:07:34.036457 [debug] [ThreadPool]: Acquiring new snowflake connection "list_BLINKIST_DEV_hackday"
12:07:34.048809 [debug] [ThreadPool]: Using snowflake connection "list_BLINKIST_DEV_hackday"
12:07:34.049122 [debug] [ThreadPool]: On list_BLINKIST_DEV_hackday: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "connection_name": "list_BLINKIST_DEV_hackday"} */

    show terse objects in BLINKIST_DEV.hackday
12:07:34.049352 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:07:34.956405 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.91 seconds
12:07:34.960436 [debug] [ThreadPool]: On list_BLINKIST_DEV_hackday: Close
12:07:35.275613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f310eaa-bf9e-4236-802f-407c0390a260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f29bdc0>]}
12:07:35.276648 [info ] [MainThread]: Concurrency: 4 threads (target='hackday')
12:07:35.277237 [info ] [MainThread]: 
12:07:35.284113 [debug] [Thread-1  ]: Began running node model.HackdayVault.facebook_ads_insights_staging_raw
12:07:35.285067 [info ] [Thread-1  ]: 1 of 2 START view model hackday.facebook_ads_insights_staging_raw .............. [RUN]
12:07:35.285739 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.HackdayVault.facebook_ads_insights_staging_raw"
12:07:35.285997 [debug] [Thread-1  ]: Began compiling node model.HackdayVault.facebook_ads_insights_staging_raw
12:07:35.286238 [debug] [Thread-1  ]: Compiling model.HackdayVault.facebook_ads_insights_staging_raw
12:07:35.290309 [debug] [Thread-1  ]: Writing injected SQL for node "model.HackdayVault.facebook_ads_insights_staging_raw"
12:07:35.294222 [debug] [Thread-1  ]: finished collecting timing info
12:07:35.294495 [debug] [Thread-1  ]: Began executing node model.HackdayVault.facebook_ads_insights_staging_raw
12:07:35.319918 [debug] [Thread-1  ]: Writing runtime SQL for node "model.HackdayVault.facebook_ads_insights_staging_raw"
12:07:35.324873 [debug] [Thread-1  ]: Using snowflake connection "model.HackdayVault.facebook_ads_insights_staging_raw"
12:07:35.325070 [debug] [Thread-1  ]: On model.HackdayVault.facebook_ads_insights_staging_raw: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_ads_insights_staging_raw"} */

  create or replace  view BLINKIST_DEV.hackday.facebook_ads_insights_staging_raw
  
   as (
    SELECT
    *
FROM FIVETRAN_DATABASE.facebook.ads_insights
  );
12:07:35.325155 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:07:36.382499 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.06 seconds
12:07:36.396092 [debug] [Thread-1  ]: finished collecting timing info
12:07:36.396486 [debug] [Thread-1  ]: On model.HackdayVault.facebook_ads_insights_staging_raw: Close
12:07:36.689569 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f310eaa-bf9e-4236-802f-407c0390a260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f901ee0>]}
12:07:36.690388 [info ] [Thread-1  ]: 1 of 2 OK created view model hackday.facebook_ads_insights_staging_raw ......... [[32mSUCCESS 1[0m in 1.40s]
12:07:36.691172 [debug] [Thread-1  ]: Finished running node model.HackdayVault.facebook_ads_insights_staging_raw
12:07:36.692085 [debug] [Thread-3  ]: Began running node model.HackdayVault.facebook_ads_insights_staging_hashed
12:07:36.692711 [info ] [Thread-3  ]: 2 of 2 START view model hackday.facebook_ads_insights_staging_hashed ........... [RUN]
12:07:36.693503 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.HackdayVault.facebook_ads_insights_staging_hashed"
12:07:36.693744 [debug] [Thread-3  ]: Began compiling node model.HackdayVault.facebook_ads_insights_staging_hashed
12:07:36.694073 [debug] [Thread-3  ]: Compiling model.HackdayVault.facebook_ads_insights_staging_hashed
12:07:36.713448 [debug] [Thread-3  ]: Using snowflake connection "model.HackdayVault.facebook_ads_insights_staging_hashed"
12:07:36.713787 [debug] [Thread-3  ]: On model.HackdayVault.facebook_ads_insights_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_ads_insights_staging_hashed"} */

    describe table BLINKIST_DEV.hackday.facebook_ads_insights_staging_raw
12:07:36.713958 [debug] [Thread-3  ]: Opening a new connection, currently in state init
12:07:37.947464 [debug] [Thread-3  ]: SQL status: SUCCESS 35 in 1.23 seconds
12:07:37.994971 [debug] [Thread-3  ]: Using snowflake connection "model.HackdayVault.facebook_ads_insights_staging_hashed"
12:07:37.995218 [debug] [Thread-3  ]: On model.HackdayVault.facebook_ads_insights_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_ads_insights_staging_hashed"} */

    describe table BLINKIST_DEV.hackday.facebook_ads_insights_staging_raw
12:07:38.193163 [debug] [Thread-3  ]: SQL status: SUCCESS 35 in 0.2 seconds
12:07:38.259805 [debug] [Thread-3  ]: Writing injected SQL for node "model.HackdayVault.facebook_ads_insights_staging_hashed"
12:07:38.266849 [debug] [Thread-3  ]: finished collecting timing info
12:07:38.266986 [debug] [Thread-3  ]: Began executing node model.HackdayVault.facebook_ads_insights_staging_hashed
12:07:38.268994 [debug] [Thread-3  ]: Writing runtime SQL for node "model.HackdayVault.facebook_ads_insights_staging_hashed"
12:07:38.275786 [debug] [Thread-3  ]: Using snowflake connection "model.HackdayVault.facebook_ads_insights_staging_hashed"
12:07:38.275896 [debug] [Thread-3  ]: On model.HackdayVault.facebook_ads_insights_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_ads_insights_staging_hashed"} */

  create or replace  view BLINKIST_DEV.hackday.facebook_ads_insights_staging_hashed
  
   as (
    







-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    "AD_ID",
    "DATE",
    "COUNTRY",
    "ACCOUNT_ID",
    "ADSET_ID",
    "CLICKS",
    "IMPRESSIONS",
    "INLINE_LINK_CLICKS",
    "UNIQUE_CLICKS",
    "UNIQUE_INLINE_LINK_CLICKS",
    "FULL_VIEW_REACH",
    "COST_PER_INLINE_LINK_CLICK",
    "COST_PER_INLINE_POST_ENGAGEMENT",
    "COST_PER_UNIQUE_CLICK",
    "COST_PER_UNIQUE_INLINE_LINK_CLICK",
    "COST_PER_ESTIMATED_AD_RECALLERS",
    "SOCIAL_SPEND",
    "UNIQUE_LINK_CLICKS_CTR",
    "ESTIMATED_AD_RECALL_RATE",
    "ESTIMATED_AD_RECALLERS",
    "UNIQUE_CTR",
    "UNIQUE_INLINE_LINK_CLICK_CTR",
    "CPC",
    "CPM",
    "CPP",
    "CTR",
    "FREQUENCY",
    "SPEND",
    "ACCOUNT_NAME",
    "AD_NAME",
    "INLINE_LINK_CLICK_CTR",
    "INLINE_POST_ENGAGEMENT",
    "LOCATION",
    "OBJECTIVE",
    "_FIVETRAN_SYNCED"

    FROM BLINKIST_DEV.hackday.facebook_ads_insights_staging_raw
),

derived_columns AS (

    SELECT

    "AD_ID",
    "DATE",
    "COUNTRY",
    "ACCOUNT_ID",
    "ADSET_ID",
    "CLICKS",
    "IMPRESSIONS",
    "INLINE_LINK_CLICKS",
    "UNIQUE_CLICKS",
    "UNIQUE_INLINE_LINK_CLICKS",
    "FULL_VIEW_REACH",
    "COST_PER_INLINE_LINK_CLICK",
    "COST_PER_INLINE_POST_ENGAGEMENT",
    "COST_PER_UNIQUE_CLICK",
    "COST_PER_UNIQUE_INLINE_LINK_CLICK",
    "COST_PER_ESTIMATED_AD_RECALLERS",
    "SOCIAL_SPEND",
    "UNIQUE_LINK_CLICKS_CTR",
    "ESTIMATED_AD_RECALL_RATE",
    "ESTIMATED_AD_RECALLERS",
    "UNIQUE_CTR",
    "UNIQUE_INLINE_LINK_CLICK_CTR",
    "CPC",
    "CPM",
    "CPP",
    "CTR",
    "FREQUENCY",
    "SPEND",
    "ACCOUNT_NAME",
    "AD_NAME",
    "INLINE_LINK_CLICK_CTR",
    "INLINE_POST_ENGAGEMENT",
    "LOCATION",
    "OBJECTIVE",
    "_FIVETRAN_SYNCED",
    'FIVETRAN_FACEBOOK_ADS_INSIGHTS_RAW' AS "RECORD_SOURCE",
    "COUNTRY" AS "COUNTRY_CODE"

    FROM source_data
),

hashed_columns AS (

    SELECT

    "AD_ID",
    "DATE",
    "COUNTRY",
    "ACCOUNT_ID",
    "ADSET_ID",
    "CLICKS",
    "IMPRESSIONS",
    "INLINE_LINK_CLICKS",
    "UNIQUE_CLICKS",
    "UNIQUE_INLINE_LINK_CLICKS",
    "FULL_VIEW_REACH",
    "COST_PER_INLINE_LINK_CLICK",
    "COST_PER_INLINE_POST_ENGAGEMENT",
    "COST_PER_UNIQUE_CLICK",
    "COST_PER_UNIQUE_INLINE_LINK_CLICK",
    "COST_PER_ESTIMATED_AD_RECALLERS",
    "SOCIAL_SPEND",
    "UNIQUE_LINK_CLICKS_CTR",
    "ESTIMATED_AD_RECALL_RATE",
    "ESTIMATED_AD_RECALLERS",
    "UNIQUE_CTR",
    "UNIQUE_INLINE_LINK_CLICK_CTR",
    "CPC",
    "CPM",
    "CPP",
    "CTR",
    "FREQUENCY",
    "SPEND",
    "ACCOUNT_NAME",
    "AD_NAME",
    "INLINE_LINK_CLICK_CTR",
    "INLINE_POST_ENGAGEMENT",
    "LOCATION",
    "OBJECTIVE",
    "_FIVETRAN_SYNCED",
    "RECORD_SOURCE",
    "COUNTRY_CODE",

    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("COUNTRY_CODE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("DATE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("AD_ID" AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS "facebook_ads_insights_hk"

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    "AD_ID",
    "DATE",
    "COUNTRY",
    "ACCOUNT_ID",
    "ADSET_ID",
    "CLICKS",
    "IMPRESSIONS",
    "INLINE_LINK_CLICKS",
    "UNIQUE_CLICKS",
    "UNIQUE_INLINE_LINK_CLICKS",
    "FULL_VIEW_REACH",
    "COST_PER_INLINE_LINK_CLICK",
    "COST_PER_INLINE_POST_ENGAGEMENT",
    "COST_PER_UNIQUE_CLICK",
    "COST_PER_UNIQUE_INLINE_LINK_CLICK",
    "COST_PER_ESTIMATED_AD_RECALLERS",
    "SOCIAL_SPEND",
    "UNIQUE_LINK_CLICKS_CTR",
    "ESTIMATED_AD_RECALL_RATE",
    "ESTIMATED_AD_RECALLERS",
    "UNIQUE_CTR",
    "UNIQUE_INLINE_LINK_CLICK_CTR",
    "CPC",
    "CPM",
    "CPP",
    "CTR",
    "FREQUENCY",
    "SPEND",
    "ACCOUNT_NAME",
    "AD_NAME",
    "INLINE_LINK_CLICK_CTR",
    "INLINE_POST_ENGAGEMENT",
    "LOCATION",
    "OBJECTIVE",
    "_FIVETRAN_SYNCED",
    "RECORD_SOURCE",
    "COUNTRY_CODE",
    "FACEBOOK_ADS_INSIGHTS_HK"

    FROM hashed_columns
)

SELECT * FROM columns_to_select
  );
12:07:38.565329 [debug] [Thread-3  ]: Snowflake adapter: Snowflake query id: 01a54557-0000-a4a9-0002-3466003483d2
12:07:38.565619 [debug] [Thread-3  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 196 at position 4
invalid identifier 'FACEBOOK_ADS_INSIGHTS_HK'
12:07:38.566021 [debug] [Thread-3  ]: finished collecting timing info
12:07:38.566261 [debug] [Thread-3  ]: On model.HackdayVault.facebook_ads_insights_staging_hashed: Close
12:07:38.964582 [debug] [Thread-3  ]: Database Error in model facebook_ads_insights_staging_hashed (models/stage_hashed/facebook_ads_insights_staging_hashed.sql)
  000904 (42000): SQL compilation error: error line 196 at position 4
  invalid identifier 'FACEBOOK_ADS_INSIGHTS_HK'
  compiled SQL at target/run/HackdayVault/models/stage_hashed/facebook_ads_insights_staging_hashed.sql
12:07:38.965522 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f310eaa-bf9e-4236-802f-407c0390a260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f966370>]}
12:07:38.966216 [error] [Thread-3  ]: 2 of 2 ERROR creating view model hackday.facebook_ads_insights_staging_hashed .. [[31mERROR[0m in 2.27s]
12:07:38.966984 [debug] [Thread-3  ]: Finished running node model.HackdayVault.facebook_ads_insights_staging_hashed
12:07:38.968646 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:07:38.969210 [info ] [MainThread]: 
12:07:38.969645 [info ] [MainThread]: Finished running 2 view models in 6.65s.
12:07:38.970039 [debug] [MainThread]: Connection 'master' was properly closed.
12:07:38.970247 [debug] [MainThread]: Connection 'model.HackdayVault.facebook_ads_insights_staging_raw' was properly closed.
12:07:38.970447 [debug] [MainThread]: Connection 'model.HackdayVault.facebook_ads_insights_staging_hashed' was properly closed.
12:07:39.055307 [info ] [MainThread]: 
12:07:39.055642 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
12:07:39.055884 [info ] [MainThread]: 
12:07:39.056085 [error] [MainThread]: [33mDatabase Error in model facebook_ads_insights_staging_hashed (models/stage_hashed/facebook_ads_insights_staging_hashed.sql)[0m
12:07:39.056278 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 196 at position 4
12:07:39.056468 [error] [MainThread]:   invalid identifier 'FACEBOOK_ADS_INSIGHTS_HK'
12:07:39.056654 [error] [MainThread]:   compiled SQL at target/run/HackdayVault/models/stage_hashed/facebook_ads_insights_staging_hashed.sql
12:07:39.056856 [info ] [MainThread]: 
12:07:39.057065 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
12:07:39.057330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f684c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f93fb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f97b970>]}


============================== 2022-06-29 12:09:54.942650 | 839e309b-393d-4297-9f61-35bb3ada979c ==============================
12:09:54.942686 [info ] [MainThread]: Running with dbt=1.1.0
12:09:54.943273 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/adambekele/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['facebook_ads_insights_staging_raw+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
12:09:54.943416 [debug] [MainThread]: Tracking: tracking
12:09:54.943734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1627a7f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1627a7a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1627a7fa0>]}
12:09:55.088283 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:09:55.088547 [debug] [MainThread]: Partial parsing: updated file: HackdayVault://models/stage_hashed/facebook_ads_insights_staging_hashed.sql
12:09:55.095472 [debug] [MainThread]: 1603: static parser failed on stage_hashed/facebook_ads_insights_staging_hashed.sql
12:09:55.175844 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage_hashed/facebook_ads_insights_staging_hashed.sql
12:09:55.180861 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.HackdayVault.facebook_ads_insights_staging_raw
- models.HackdayVault.facebook_accounts_staging_raw

12:09:55.183754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '839e309b-393d-4297-9f61-35bb3ada979c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162ae20d0>]}
12:09:55.222913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '839e309b-393d-4297-9f61-35bb3ada979c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16277c7c0>]}
12:09:55.223145 [info ] [MainThread]: Found 6 models, 9 tests, 0 snapshots, 0 analyses, 545 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
12:09:55.223322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '839e309b-393d-4297-9f61-35bb3ada979c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16277c880>]}
12:09:55.224070 [info ] [MainThread]: 
12:09:55.224359 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:09:55.224832 [debug] [ThreadPool]: Acquiring new snowflake connection "list_BLINKIST_DEV"
12:09:55.232184 [debug] [ThreadPool]: Using snowflake connection "list_BLINKIST_DEV"
12:09:55.232313 [debug] [ThreadPool]: On list_BLINKIST_DEV: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "connection_name": "list_BLINKIST_DEV"} */

    show terse schemas in database BLINKIST_DEV
    limit 10000
12:09:55.232400 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:09:56.581406 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.35 seconds
12:09:56.585135 [debug] [ThreadPool]: On list_BLINKIST_DEV: Close
12:09:56.890055 [debug] [ThreadPool]: Acquiring new snowflake connection "list_BLINKIST_DEV_hackday"
12:09:56.902126 [debug] [ThreadPool]: Using snowflake connection "list_BLINKIST_DEV_hackday"
12:09:56.902439 [debug] [ThreadPool]: On list_BLINKIST_DEV_hackday: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "connection_name": "list_BLINKIST_DEV_hackday"} */

    show terse objects in BLINKIST_DEV.hackday
12:09:56.902632 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:09:57.978065 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.08 seconds
12:09:57.982215 [debug] [ThreadPool]: On list_BLINKIST_DEV_hackday: Close
12:09:58.299933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '839e309b-393d-4297-9f61-35bb3ada979c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16277cb50>]}
12:09:58.301034 [info ] [MainThread]: Concurrency: 4 threads (target='hackday')
12:09:58.301757 [info ] [MainThread]: 
12:09:58.308802 [debug] [Thread-1  ]: Began running node model.HackdayVault.facebook_ads_insights_staging_raw
12:09:58.309776 [info ] [Thread-1  ]: 1 of 2 START view model hackday.facebook_ads_insights_staging_raw .............. [RUN]
12:09:58.310564 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.HackdayVault.facebook_ads_insights_staging_raw"
12:09:58.310807 [debug] [Thread-1  ]: Began compiling node model.HackdayVault.facebook_ads_insights_staging_raw
12:09:58.311043 [debug] [Thread-1  ]: Compiling model.HackdayVault.facebook_ads_insights_staging_raw
12:09:58.315519 [debug] [Thread-1  ]: Writing injected SQL for node "model.HackdayVault.facebook_ads_insights_staging_raw"
12:09:58.319352 [debug] [Thread-1  ]: finished collecting timing info
12:09:58.319639 [debug] [Thread-1  ]: Began executing node model.HackdayVault.facebook_ads_insights_staging_raw
12:09:58.345153 [debug] [Thread-1  ]: Writing runtime SQL for node "model.HackdayVault.facebook_ads_insights_staging_raw"
12:09:58.350813 [debug] [Thread-1  ]: Using snowflake connection "model.HackdayVault.facebook_ads_insights_staging_raw"
12:09:58.351063 [debug] [Thread-1  ]: On model.HackdayVault.facebook_ads_insights_staging_raw: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_ads_insights_staging_raw"} */

  create or replace  view BLINKIST_DEV.hackday.facebook_ads_insights_staging_raw
  
   as (
    SELECT
    *
FROM FIVETRAN_DATABASE.facebook.ads_insights
  );
12:09:58.351194 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:09:59.350989 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
12:09:59.364491 [debug] [Thread-1  ]: finished collecting timing info
12:09:59.365032 [debug] [Thread-1  ]: On model.HackdayVault.facebook_ads_insights_staging_raw: Close
12:09:59.661280 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '839e309b-393d-4297-9f61-35bb3ada979c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162fb1c70>]}
12:09:59.662112 [info ] [Thread-1  ]: 1 of 2 OK created view model hackday.facebook_ads_insights_staging_raw ......... [[32mSUCCESS 1[0m in 1.35s]
12:09:59.662948 [debug] [Thread-1  ]: Finished running node model.HackdayVault.facebook_ads_insights_staging_raw
12:09:59.663988 [debug] [Thread-3  ]: Began running node model.HackdayVault.facebook_ads_insights_staging_hashed
12:09:59.664361 [info ] [Thread-3  ]: 2 of 2 START view model hackday.facebook_ads_insights_staging_hashed ........... [RUN]
12:09:59.664983 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.HackdayVault.facebook_ads_insights_staging_hashed"
12:09:59.665223 [debug] [Thread-3  ]: Began compiling node model.HackdayVault.facebook_ads_insights_staging_hashed
12:09:59.665448 [debug] [Thread-3  ]: Compiling model.HackdayVault.facebook_ads_insights_staging_hashed
12:09:59.685000 [debug] [Thread-3  ]: Using snowflake connection "model.HackdayVault.facebook_ads_insights_staging_hashed"
12:09:59.685382 [debug] [Thread-3  ]: On model.HackdayVault.facebook_ads_insights_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_ads_insights_staging_hashed"} */

    describe table BLINKIST_DEV.hackday.facebook_ads_insights_staging_raw
12:09:59.685570 [debug] [Thread-3  ]: Opening a new connection, currently in state init
12:10:00.565612 [debug] [Thread-3  ]: SQL status: SUCCESS 35 in 0.88 seconds
12:10:00.614397 [debug] [Thread-3  ]: Using snowflake connection "model.HackdayVault.facebook_ads_insights_staging_hashed"
12:10:00.614580 [debug] [Thread-3  ]: On model.HackdayVault.facebook_ads_insights_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_ads_insights_staging_hashed"} */

    describe table BLINKIST_DEV.hackday.facebook_ads_insights_staging_raw
12:10:00.791888 [debug] [Thread-3  ]: SQL status: SUCCESS 35 in 0.18 seconds
12:10:00.860214 [debug] [Thread-3  ]: Writing injected SQL for node "model.HackdayVault.facebook_ads_insights_staging_hashed"
12:10:00.866437 [debug] [Thread-3  ]: finished collecting timing info
12:10:00.866574 [debug] [Thread-3  ]: Began executing node model.HackdayVault.facebook_ads_insights_staging_hashed
12:10:00.868705 [debug] [Thread-3  ]: Writing runtime SQL for node "model.HackdayVault.facebook_ads_insights_staging_hashed"
12:10:00.874196 [debug] [Thread-3  ]: Using snowflake connection "model.HackdayVault.facebook_ads_insights_staging_hashed"
12:10:00.874316 [debug] [Thread-3  ]: On model.HackdayVault.facebook_ads_insights_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_ads_insights_staging_hashed"} */

  create or replace  view BLINKIST_DEV.hackday.facebook_ads_insights_staging_hashed
  
   as (
    







-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    "AD_ID",
    "DATE",
    "COUNTRY",
    "ACCOUNT_ID",
    "ADSET_ID",
    "CLICKS",
    "IMPRESSIONS",
    "INLINE_LINK_CLICKS",
    "UNIQUE_CLICKS",
    "UNIQUE_INLINE_LINK_CLICKS",
    "FULL_VIEW_REACH",
    "COST_PER_INLINE_LINK_CLICK",
    "COST_PER_INLINE_POST_ENGAGEMENT",
    "COST_PER_UNIQUE_CLICK",
    "COST_PER_UNIQUE_INLINE_LINK_CLICK",
    "COST_PER_ESTIMATED_AD_RECALLERS",
    "SOCIAL_SPEND",
    "UNIQUE_LINK_CLICKS_CTR",
    "ESTIMATED_AD_RECALL_RATE",
    "ESTIMATED_AD_RECALLERS",
    "UNIQUE_CTR",
    "UNIQUE_INLINE_LINK_CLICK_CTR",
    "CPC",
    "CPM",
    "CPP",
    "CTR",
    "FREQUENCY",
    "SPEND",
    "ACCOUNT_NAME",
    "AD_NAME",
    "INLINE_LINK_CLICK_CTR",
    "INLINE_POST_ENGAGEMENT",
    "LOCATION",
    "OBJECTIVE",
    "_FIVETRAN_SYNCED"

    FROM BLINKIST_DEV.hackday.facebook_ads_insights_staging_raw
),

derived_columns AS (

    SELECT

    "AD_ID",
    "DATE",
    "COUNTRY",
    "ACCOUNT_ID",
    "ADSET_ID",
    "CLICKS",
    "IMPRESSIONS",
    "INLINE_LINK_CLICKS",
    "UNIQUE_CLICKS",
    "UNIQUE_INLINE_LINK_CLICKS",
    "FULL_VIEW_REACH",
    "COST_PER_INLINE_LINK_CLICK",
    "COST_PER_INLINE_POST_ENGAGEMENT",
    "COST_PER_UNIQUE_CLICK",
    "COST_PER_UNIQUE_INLINE_LINK_CLICK",
    "COST_PER_ESTIMATED_AD_RECALLERS",
    "SOCIAL_SPEND",
    "UNIQUE_LINK_CLICKS_CTR",
    "ESTIMATED_AD_RECALL_RATE",
    "ESTIMATED_AD_RECALLERS",
    "UNIQUE_CTR",
    "UNIQUE_INLINE_LINK_CLICK_CTR",
    "CPC",
    "CPM",
    "CPP",
    "CTR",
    "FREQUENCY",
    "SPEND",
    "ACCOUNT_NAME",
    "AD_NAME",
    "INLINE_LINK_CLICK_CTR",
    "INLINE_POST_ENGAGEMENT",
    "LOCATION",
    "OBJECTIVE",
    "_FIVETRAN_SYNCED",
    'FIVETRAN_FACEBOOK_ADS_INSIGHTS_RAW' AS "RECORD_SOURCE",
    "COUNTRY" AS "COUNTRY_CODE"

    FROM source_data
),

hashed_columns AS (

    SELECT

    "AD_ID",
    "DATE",
    "COUNTRY",
    "ACCOUNT_ID",
    "ADSET_ID",
    "CLICKS",
    "IMPRESSIONS",
    "INLINE_LINK_CLICKS",
    "UNIQUE_CLICKS",
    "UNIQUE_INLINE_LINK_CLICKS",
    "FULL_VIEW_REACH",
    "COST_PER_INLINE_LINK_CLICK",
    "COST_PER_INLINE_POST_ENGAGEMENT",
    "COST_PER_UNIQUE_CLICK",
    "COST_PER_UNIQUE_INLINE_LINK_CLICK",
    "COST_PER_ESTIMATED_AD_RECALLERS",
    "SOCIAL_SPEND",
    "UNIQUE_LINK_CLICKS_CTR",
    "ESTIMATED_AD_RECALL_RATE",
    "ESTIMATED_AD_RECALLERS",
    "UNIQUE_CTR",
    "UNIQUE_INLINE_LINK_CLICK_CTR",
    "CPC",
    "CPM",
    "CPP",
    "CTR",
    "FREQUENCY",
    "SPEND",
    "ACCOUNT_NAME",
    "AD_NAME",
    "INLINE_LINK_CLICK_CTR",
    "INLINE_POST_ENGAGEMENT",
    "LOCATION",
    "OBJECTIVE",
    "_FIVETRAN_SYNCED",
    "RECORD_SOURCE",
    "COUNTRY_CODE",

    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("COUNTRY_CODE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("DATE" AS VARCHAR))), ''), '^^'),
        IFNULL(NULLIF(UPPER(TRIM(CAST("AD_ID" AS VARCHAR))), ''), '^^')
    ), '^^||^^||^^')) AS BINARY(16)) AS "FACEBOOK_ADS_INSIGHTS_HK"

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    "AD_ID",
    "DATE",
    "COUNTRY",
    "ACCOUNT_ID",
    "ADSET_ID",
    "CLICKS",
    "IMPRESSIONS",
    "INLINE_LINK_CLICKS",
    "UNIQUE_CLICKS",
    "UNIQUE_INLINE_LINK_CLICKS",
    "FULL_VIEW_REACH",
    "COST_PER_INLINE_LINK_CLICK",
    "COST_PER_INLINE_POST_ENGAGEMENT",
    "COST_PER_UNIQUE_CLICK",
    "COST_PER_UNIQUE_INLINE_LINK_CLICK",
    "COST_PER_ESTIMATED_AD_RECALLERS",
    "SOCIAL_SPEND",
    "UNIQUE_LINK_CLICKS_CTR",
    "ESTIMATED_AD_RECALL_RATE",
    "ESTIMATED_AD_RECALLERS",
    "UNIQUE_CTR",
    "UNIQUE_INLINE_LINK_CLICK_CTR",
    "CPC",
    "CPM",
    "CPP",
    "CTR",
    "FREQUENCY",
    "SPEND",
    "ACCOUNT_NAME",
    "AD_NAME",
    "INLINE_LINK_CLICK_CTR",
    "INLINE_POST_ENGAGEMENT",
    "LOCATION",
    "OBJECTIVE",
    "_FIVETRAN_SYNCED",
    "RECORD_SOURCE",
    "COUNTRY_CODE",
    "FACEBOOK_ADS_INSIGHTS_HK"

    FROM hashed_columns
)

SELECT * FROM columns_to_select
  );
12:10:01.228597 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.35 seconds
12:10:01.233096 [debug] [Thread-3  ]: finished collecting timing info
12:10:01.233536 [debug] [Thread-3  ]: On model.HackdayVault.facebook_ads_insights_staging_hashed: Close
12:10:01.541148 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '839e309b-393d-4297-9f61-35bb3ada979c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16712da60>]}
12:10:01.542124 [info ] [Thread-3  ]: 2 of 2 OK created view model hackday.facebook_ads_insights_staging_hashed ...... [[32mSUCCESS 1[0m in 1.88s]
12:10:01.542916 [debug] [Thread-3  ]: Finished running node model.HackdayVault.facebook_ads_insights_staging_hashed
12:10:01.544321 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:10:01.544918 [info ] [MainThread]: 
12:10:01.545355 [info ] [MainThread]: Finished running 2 view models in 6.32s.
12:10:01.545727 [debug] [MainThread]: Connection 'master' was properly closed.
12:10:01.545932 [debug] [MainThread]: Connection 'model.HackdayVault.facebook_ads_insights_staging_raw' was properly closed.
12:10:01.546123 [debug] [MainThread]: Connection 'model.HackdayVault.facebook_ads_insights_staging_hashed' was properly closed.
12:10:01.634502 [info ] [MainThread]: 
12:10:01.634848 [info ] [MainThread]: [32mCompleted successfully[0m
12:10:01.635097 [info ] [MainThread]: 
12:10:01.635301 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
12:10:01.635589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162feef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162feed30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162fee7f0>]}


============================== 2022-06-29 12:12:22.827120 | 4f886195-d770-432f-9aa6-ee3f0a67e1b1 ==============================
12:12:22.827136 [info ] [MainThread]: Running with dbt=1.1.0
12:12:22.827715 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/adambekele/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['facebook_accounts_staging_raw+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
12:12:22.827885 [debug] [MainThread]: Tracking: tracking
12:12:22.828125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a7f90d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a7f9e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a7f98b0>]}
12:12:22.972611 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:12:22.972876 [debug] [MainThread]: Partial parsing: updated file: HackdayVault://models/stage_hashed/facebook_accounts_staging_hashed.sql
12:12:22.979851 [debug] [MainThread]: 1603: static parser failed on stage_hashed/facebook_accounts_staging_hashed.sql
12:12:23.048527 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage_hashed/facebook_accounts_staging_hashed.sql
12:12:23.053542 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.HackdayVault.facebook_accounts_staging_raw
- models.HackdayVault.facebook_ads_insights_staging_raw

12:12:23.056464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f886195-d770-432f-9aa6-ee3f0a67e1b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15aa750d0>]}
12:12:23.116509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f886195-d770-432f-9aa6-ee3f0a67e1b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a9b29a0>]}
12:12:23.116779 [info ] [MainThread]: Found 6 models, 9 tests, 0 snapshots, 0 analyses, 545 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
12:12:23.116982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f886195-d770-432f-9aa6-ee3f0a67e1b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a9b29d0>]}
12:12:23.117812 [info ] [MainThread]: 
12:12:23.118142 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:12:23.118671 [debug] [ThreadPool]: Acquiring new snowflake connection "list_BLINKIST_DEV"
12:12:23.126865 [debug] [ThreadPool]: Using snowflake connection "list_BLINKIST_DEV"
12:12:23.127225 [debug] [ThreadPool]: On list_BLINKIST_DEV: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "connection_name": "list_BLINKIST_DEV"} */

    show terse schemas in database BLINKIST_DEV
    limit 10000
12:12:23.127339 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:12:24.377797 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.25 seconds
12:12:24.381195 [debug] [ThreadPool]: On list_BLINKIST_DEV: Close
12:12:24.693898 [debug] [ThreadPool]: Acquiring new snowflake connection "list_BLINKIST_DEV_hackday"
12:12:24.707437 [debug] [ThreadPool]: Using snowflake connection "list_BLINKIST_DEV_hackday"
12:12:24.707798 [debug] [ThreadPool]: On list_BLINKIST_DEV_hackday: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "connection_name": "list_BLINKIST_DEV_hackday"} */

    show terse objects in BLINKIST_DEV.hackday
12:12:24.707990 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:12:25.803184 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.1 seconds
12:12:25.807805 [debug] [ThreadPool]: On list_BLINKIST_DEV_hackday: Close
12:12:26.106270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f886195-d770-432f-9aa6-ee3f0a67e1b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a9b2ca0>]}
12:12:26.107243 [info ] [MainThread]: Concurrency: 4 threads (target='hackday')
12:12:26.107829 [info ] [MainThread]: 
12:12:26.113654 [debug] [Thread-1  ]: Began running node model.HackdayVault.facebook_accounts_staging_raw
12:12:26.114541 [info ] [Thread-1  ]: 1 of 2 START view model hackday.facebook_accounts_staging_raw .................. [RUN]
12:12:26.115251 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.HackdayVault.facebook_accounts_staging_raw"
12:12:26.115497 [debug] [Thread-1  ]: Began compiling node model.HackdayVault.facebook_accounts_staging_raw
12:12:26.115726 [debug] [Thread-1  ]: Compiling model.HackdayVault.facebook_accounts_staging_raw
12:12:26.119996 [debug] [Thread-1  ]: Writing injected SQL for node "model.HackdayVault.facebook_accounts_staging_raw"
12:12:26.125179 [debug] [Thread-1  ]: finished collecting timing info
12:12:26.125500 [debug] [Thread-1  ]: Began executing node model.HackdayVault.facebook_accounts_staging_raw
12:12:26.150517 [debug] [Thread-1  ]: Writing runtime SQL for node "model.HackdayVault.facebook_accounts_staging_raw"
12:12:26.154045 [debug] [Thread-1  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_staging_raw"
12:12:26.154298 [debug] [Thread-1  ]: On model.HackdayVault.facebook_accounts_staging_raw: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_staging_raw"} */

  create or replace  view BLINKIST_DEV.hackday.facebook_accounts_staging_raw
  
   as (
    SELECT
    *
FROM FIVETRAN_DATABASE.facebook_ads.account_history
  );
12:12:26.154428 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:12:27.274055 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.12 seconds
12:12:27.286457 [debug] [Thread-1  ]: finished collecting timing info
12:12:27.286945 [debug] [Thread-1  ]: On model.HackdayVault.facebook_accounts_staging_raw: Close
12:12:27.585249 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f886195-d770-432f-9aa6-ee3f0a67e1b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f150c70>]}
12:12:27.586093 [info ] [Thread-1  ]: 1 of 2 OK created view model hackday.facebook_accounts_staging_raw ............. [[32mSUCCESS 1[0m in 1.47s]
12:12:27.586738 [debug] [Thread-1  ]: Finished running node model.HackdayVault.facebook_accounts_staging_raw
12:12:27.587402 [debug] [Thread-3  ]: Began running node model.HackdayVault.facebook_accounts_staging_hashed
12:12:27.588002 [info ] [Thread-3  ]: 2 of 2 START view model hackday.facebook_accounts_staging_hashed ............... [RUN]
12:12:27.588784 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
12:12:27.589031 [debug] [Thread-3  ]: Began compiling node model.HackdayVault.facebook_accounts_staging_hashed
12:12:27.589249 [debug] [Thread-3  ]: Compiling model.HackdayVault.facebook_accounts_staging_hashed
12:12:27.606183 [debug] [Thread-3  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
12:12:27.606508 [debug] [Thread-3  ]: On model.HackdayVault.facebook_accounts_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_staging_hashed"} */

    describe table BLINKIST_DEV.hackday.facebook_accounts_staging_raw
12:12:27.606672 [debug] [Thread-3  ]: Opening a new connection, currently in state init
12:12:28.558978 [debug] [Thread-3  ]: SQL status: SUCCESS 83 in 0.95 seconds
12:12:28.636466 [debug] [Thread-3  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
12:12:28.636608 [debug] [Thread-3  ]: On model.HackdayVault.facebook_accounts_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_staging_hashed"} */

    describe table BLINKIST_DEV.hackday.facebook_accounts_staging_raw
12:12:28.884867 [debug] [Thread-3  ]: SQL status: SUCCESS 83 in 0.25 seconds
12:12:28.993546 [debug] [Thread-3  ]: Writing injected SQL for node "model.HackdayVault.facebook_accounts_staging_hashed"
12:12:28.994066 [debug] [Thread-3  ]: finished collecting timing info
12:12:28.994172 [debug] [Thread-3  ]: Began executing node model.HackdayVault.facebook_accounts_staging_hashed
12:12:28.995761 [debug] [Thread-3  ]: Writing runtime SQL for node "model.HackdayVault.facebook_accounts_staging_hashed"
12:12:28.998791 [debug] [Thread-3  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
12:12:28.998882 [debug] [Thread-3  ]: On model.HackdayVault.facebook_accounts_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_staging_hashed"} */

  create or replace  view BLINKIST_DEV.hackday.facebook_accounts_staging_hashed
  
   as (
    







-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    "_FIVETRAN_ID",
    "AGE",
    "AMOUNT_SPENT",
    "BALANCE",
    "BUSINESS_CITY",
    "BUSINESS_COUNTRY_CODE",
    "BUSINESS_NAME",
    "BUSINESS_STATE",
    "BUSINESS_STREET",
    "BUSINESS_STREET_2",
    "BUSINESS_ZIP",
    "CAN_CREATE_BRAND_LIFT_STUDY",
    "CREATED_TIME",
    "CURRENCY",
    "END_ADVERTISER",
    "END_ADVERTISER_NAME",
    "HAS_ADVERTISER_OPTED_IN_ODAX",
    "HAS_MIGRATED_PERMISSIONS",
    "IO_NUMBER",
    "IS_ATTRIBUTION_SPEC_SYSTEM_DEFAULT",
    "IS_DIRECT_DEALS_ENABLED",
    "IS_IN_3_DS_AUTHORIZATION_ENABLED_MARKET",
    "IS_NOTIFICATIONS_ENABLED",
    "IS_PERSONAL",
    "IS_PREPAY_ACCOUNT",
    "IS_TAX_ID_REQUIRED",
    "MEDIA_AGENCY",
    "MIN_CAMPAIGN_GROUP_SPEND_CAP",
    "MIN_DAILY_BUDGET",
    "NAME",
    "NEXT_BILL_DATE",
    "OFFSITE_PIXELS_TOS_ACCEPTED",
    "OWNER",
    "PARTNER",
    "SALESFORCE_INVOICE_GROUP_ID",
    "SPEND_CAP",
    "TAX_ID",
    "TAX_ID_TYPE",
    "TIMEZONE_ID",
    "TIMEZONE_NAME",
    "TIMEZONE_OFFSET_HOURS_UTC",
    "ACCOUNT_STATUS",
    "DISABLE_REASON",
    "TAX_ID_STATUS",
    "AGENCY_CLIENT_DECLARATION_AGENCY_REPRESENTING_CLIENT",
    "AGENCY_CLIENT_DECLARATION_CLIENT_BASED_IN_FRANCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_CITY",
    "AGENCY_CLIENT_DECLARATION_CLIENT_COUNTRY_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_EMAIL_ADDRESS",
    "AGENCY_CLIENT_DECLARATION_CLIENT_NAME",
    "AGENCY_CLIENT_DECLARATION_CLIENT_POSTAL_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_PROVINCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET_2",
    "AGENCY_CLIENT_DECLARATION_HAS_WRITTEN_MANDATE_FROM_ADVERTISER",
    "AGENCY_CLIENT_DECLARATION_IS_CLIENT_PAYING_INVOICES",
    "BUSINESS_MANAGER_BLOCK_OFFLINE_ANALYTICS",
    "BUSINESS_MANAGER_CREATED_BY",
    "BUSINESS_MANAGER_CREATED_TIME",
    "BUSINESS_MANAGER_EXTENDED_UPDATED_TIME",
    "BUSINESS_MANAGER_IS_HIDDEN",
    "BUSINESS_MANAGER_LINK",
    "BUSINESS_MANAGER_NAME",
    "BUSINESS_MANAGER_PAYMENT_ACCOUNT_ID",
    "BUSINESS_MANAGER_PRIMARY_PAGE",
    "BUSINESS_MANAGER_PROFILE_PICTURE_URI",
    "BUSINESS_MANAGER_TIMEZONE_ID",
    "BUSINESS_MANAGER_TWO_FACTOR_TYPE",
    "BUSINESS_MANAGER_UPDATED_BY",
    "BUSINESS_MANAGER_UPDATE_TIME",
    "BUSINESS_MANAGER_VERIFICATION_STATUS",
    "BUSINESS_MANAGER_VERTICAL",
    "BUSINESS_MANAGER_VERTICAL_ID",
    "BUSINESS_MANAGER_MANAGER_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_AUTO_ENROLL",
    "EXTENDED_CREDIT_INVOICE_GROUP_CUSTOMER_PO_NUMBER",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAIL",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAILS",
    "EXTENDED_CREDIT_INVOICE_GROUP_NAME",
    "CAPABILITIES",
    "ID",
    "_FIVETRAN_SYNCED"

    FROM BLINKIST_DEV.hackday.facebook_accounts_staging_raw
),

derived_columns AS (

    SELECT

    "_FIVETRAN_ID",
    "AGE",
    "AMOUNT_SPENT",
    "BALANCE",
    "BUSINESS_CITY",
    "BUSINESS_COUNTRY_CODE",
    "BUSINESS_NAME",
    "BUSINESS_STATE",
    "BUSINESS_STREET",
    "BUSINESS_STREET_2",
    "BUSINESS_ZIP",
    "CAN_CREATE_BRAND_LIFT_STUDY",
    "CREATED_TIME",
    "CURRENCY",
    "END_ADVERTISER",
    "END_ADVERTISER_NAME",
    "HAS_ADVERTISER_OPTED_IN_ODAX",
    "HAS_MIGRATED_PERMISSIONS",
    "IO_NUMBER",
    "IS_ATTRIBUTION_SPEC_SYSTEM_DEFAULT",
    "IS_DIRECT_DEALS_ENABLED",
    "IS_IN_3_DS_AUTHORIZATION_ENABLED_MARKET",
    "IS_NOTIFICATIONS_ENABLED",
    "IS_PERSONAL",
    "IS_PREPAY_ACCOUNT",
    "IS_TAX_ID_REQUIRED",
    "MEDIA_AGENCY",
    "MIN_CAMPAIGN_GROUP_SPEND_CAP",
    "MIN_DAILY_BUDGET",
    "NAME",
    "NEXT_BILL_DATE",
    "OFFSITE_PIXELS_TOS_ACCEPTED",
    "OWNER",
    "PARTNER",
    "SALESFORCE_INVOICE_GROUP_ID",
    "SPEND_CAP",
    "TAX_ID",
    "TAX_ID_TYPE",
    "TIMEZONE_ID",
    "TIMEZONE_NAME",
    "TIMEZONE_OFFSET_HOURS_UTC",
    "ACCOUNT_STATUS",
    "DISABLE_REASON",
    "TAX_ID_STATUS",
    "AGENCY_CLIENT_DECLARATION_AGENCY_REPRESENTING_CLIENT",
    "AGENCY_CLIENT_DECLARATION_CLIENT_BASED_IN_FRANCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_CITY",
    "AGENCY_CLIENT_DECLARATION_CLIENT_COUNTRY_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_EMAIL_ADDRESS",
    "AGENCY_CLIENT_DECLARATION_CLIENT_NAME",
    "AGENCY_CLIENT_DECLARATION_CLIENT_POSTAL_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_PROVINCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET_2",
    "AGENCY_CLIENT_DECLARATION_HAS_WRITTEN_MANDATE_FROM_ADVERTISER",
    "AGENCY_CLIENT_DECLARATION_IS_CLIENT_PAYING_INVOICES",
    "BUSINESS_MANAGER_BLOCK_OFFLINE_ANALYTICS",
    "BUSINESS_MANAGER_CREATED_BY",
    "BUSINESS_MANAGER_CREATED_TIME",
    "BUSINESS_MANAGER_EXTENDED_UPDATED_TIME",
    "BUSINESS_MANAGER_IS_HIDDEN",
    "BUSINESS_MANAGER_LINK",
    "BUSINESS_MANAGER_NAME",
    "BUSINESS_MANAGER_PAYMENT_ACCOUNT_ID",
    "BUSINESS_MANAGER_PRIMARY_PAGE",
    "BUSINESS_MANAGER_PROFILE_PICTURE_URI",
    "BUSINESS_MANAGER_TIMEZONE_ID",
    "BUSINESS_MANAGER_TWO_FACTOR_TYPE",
    "BUSINESS_MANAGER_UPDATED_BY",
    "BUSINESS_MANAGER_UPDATE_TIME",
    "BUSINESS_MANAGER_VERIFICATION_STATUS",
    "BUSINESS_MANAGER_VERTICAL",
    "BUSINESS_MANAGER_VERTICAL_ID",
    "BUSINESS_MANAGER_MANAGER_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_AUTO_ENROLL",
    "EXTENDED_CREDIT_INVOICE_GROUP_CUSTOMER_PO_NUMBER",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAIL",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAILS",
    "EXTENDED_CREDIT_INVOICE_GROUP_NAME",
    "CAPABILITIES",
    "ID",
    "_FIVETRAN_SYNCED",
    'FIVETRAN_FACEBOOK_ACCOUNTS_RAW' AS "RECORD_SOURCE",
    "CURRENCY" AS "CURRENCY_CODE",
    "ID" AS "ACCOUNT_ID"

    FROM source_data
),

hashed_columns AS (

    SELECT

    "_FIVETRAN_ID",
    "AGE",
    "AMOUNT_SPENT",
    "BALANCE",
    "BUSINESS_CITY",
    "BUSINESS_COUNTRY_CODE",
    "BUSINESS_NAME",
    "BUSINESS_STATE",
    "BUSINESS_STREET",
    "BUSINESS_STREET_2",
    "BUSINESS_ZIP",
    "CAN_CREATE_BRAND_LIFT_STUDY",
    "CREATED_TIME",
    "CURRENCY",
    "END_ADVERTISER",
    "END_ADVERTISER_NAME",
    "HAS_ADVERTISER_OPTED_IN_ODAX",
    "HAS_MIGRATED_PERMISSIONS",
    "IO_NUMBER",
    "IS_ATTRIBUTION_SPEC_SYSTEM_DEFAULT",
    "IS_DIRECT_DEALS_ENABLED",
    "IS_IN_3_DS_AUTHORIZATION_ENABLED_MARKET",
    "IS_NOTIFICATIONS_ENABLED",
    "IS_PERSONAL",
    "IS_PREPAY_ACCOUNT",
    "IS_TAX_ID_REQUIRED",
    "MEDIA_AGENCY",
    "MIN_CAMPAIGN_GROUP_SPEND_CAP",
    "MIN_DAILY_BUDGET",
    "NAME",
    "NEXT_BILL_DATE",
    "OFFSITE_PIXELS_TOS_ACCEPTED",
    "OWNER",
    "PARTNER",
    "SALESFORCE_INVOICE_GROUP_ID",
    "SPEND_CAP",
    "TAX_ID",
    "TAX_ID_TYPE",
    "TIMEZONE_ID",
    "TIMEZONE_NAME",
    "TIMEZONE_OFFSET_HOURS_UTC",
    "ACCOUNT_STATUS",
    "DISABLE_REASON",
    "TAX_ID_STATUS",
    "AGENCY_CLIENT_DECLARATION_AGENCY_REPRESENTING_CLIENT",
    "AGENCY_CLIENT_DECLARATION_CLIENT_BASED_IN_FRANCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_CITY",
    "AGENCY_CLIENT_DECLARATION_CLIENT_COUNTRY_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_EMAIL_ADDRESS",
    "AGENCY_CLIENT_DECLARATION_CLIENT_NAME",
    "AGENCY_CLIENT_DECLARATION_CLIENT_POSTAL_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_PROVINCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET_2",
    "AGENCY_CLIENT_DECLARATION_HAS_WRITTEN_MANDATE_FROM_ADVERTISER",
    "AGENCY_CLIENT_DECLARATION_IS_CLIENT_PAYING_INVOICES",
    "BUSINESS_MANAGER_BLOCK_OFFLINE_ANALYTICS",
    "BUSINESS_MANAGER_CREATED_BY",
    "BUSINESS_MANAGER_CREATED_TIME",
    "BUSINESS_MANAGER_EXTENDED_UPDATED_TIME",
    "BUSINESS_MANAGER_IS_HIDDEN",
    "BUSINESS_MANAGER_LINK",
    "BUSINESS_MANAGER_NAME",
    "BUSINESS_MANAGER_PAYMENT_ACCOUNT_ID",
    "BUSINESS_MANAGER_PRIMARY_PAGE",
    "BUSINESS_MANAGER_PROFILE_PICTURE_URI",
    "BUSINESS_MANAGER_TIMEZONE_ID",
    "BUSINESS_MANAGER_TWO_FACTOR_TYPE",
    "BUSINESS_MANAGER_UPDATED_BY",
    "BUSINESS_MANAGER_UPDATE_TIME",
    "BUSINESS_MANAGER_VERIFICATION_STATUS",
    "BUSINESS_MANAGER_VERTICAL",
    "BUSINESS_MANAGER_VERTICAL_ID",
    "BUSINESS_MANAGER_MANAGER_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_AUTO_ENROLL",
    "EXTENDED_CREDIT_INVOICE_GROUP_CUSTOMER_PO_NUMBER",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAIL",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAILS",
    "EXTENDED_CREDIT_INVOICE_GROUP_NAME",
    "CAPABILITIES",
    "ID",
    "_FIVETRAN_SYNCED",
    "RECORD_SOURCE",
    "CURRENCY_CODE",
    "ACCOUNT_ID",

    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("ACCOUNT_ID" AS VARCHAR))), ''), '^^')
    ), '^^')) AS BINARY(16)) AS "FACEBOOK_ACCOUNTS_HK"

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    "_FIVETRAN_ID",
    "AGE",
    "AMOUNT_SPENT",
    "BALANCE",
    "BUSINESS_CITY",
    "BUSINESS_COUNTRY_CODE",
    "BUSINESS_NAME",
    "BUSINESS_STATE",
    "BUSINESS_STREET",
    "BUSINESS_STREET_2",
    "BUSINESS_ZIP",
    "CAN_CREATE_BRAND_LIFT_STUDY",
    "CREATED_TIME",
    "CURRENCY",
    "END_ADVERTISER",
    "END_ADVERTISER_NAME",
    "HAS_ADVERTISER_OPTED_IN_ODAX",
    "HAS_MIGRATED_PERMISSIONS",
    "IO_NUMBER",
    "IS_ATTRIBUTION_SPEC_SYSTEM_DEFAULT",
    "IS_DIRECT_DEALS_ENABLED",
    "IS_IN_3_DS_AUTHORIZATION_ENABLED_MARKET",
    "IS_NOTIFICATIONS_ENABLED",
    "IS_PERSONAL",
    "IS_PREPAY_ACCOUNT",
    "IS_TAX_ID_REQUIRED",
    "MEDIA_AGENCY",
    "MIN_CAMPAIGN_GROUP_SPEND_CAP",
    "MIN_DAILY_BUDGET",
    "NAME",
    "NEXT_BILL_DATE",
    "OFFSITE_PIXELS_TOS_ACCEPTED",
    "OWNER",
    "PARTNER",
    "SALESFORCE_INVOICE_GROUP_ID",
    "SPEND_CAP",
    "TAX_ID",
    "TAX_ID_TYPE",
    "TIMEZONE_ID",
    "TIMEZONE_NAME",
    "TIMEZONE_OFFSET_HOURS_UTC",
    "ACCOUNT_STATUS",
    "DISABLE_REASON",
    "TAX_ID_STATUS",
    "AGENCY_CLIENT_DECLARATION_AGENCY_REPRESENTING_CLIENT",
    "AGENCY_CLIENT_DECLARATION_CLIENT_BASED_IN_FRANCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_CITY",
    "AGENCY_CLIENT_DECLARATION_CLIENT_COUNTRY_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_EMAIL_ADDRESS",
    "AGENCY_CLIENT_DECLARATION_CLIENT_NAME",
    "AGENCY_CLIENT_DECLARATION_CLIENT_POSTAL_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_PROVINCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET_2",
    "AGENCY_CLIENT_DECLARATION_HAS_WRITTEN_MANDATE_FROM_ADVERTISER",
    "AGENCY_CLIENT_DECLARATION_IS_CLIENT_PAYING_INVOICES",
    "BUSINESS_MANAGER_BLOCK_OFFLINE_ANALYTICS",
    "BUSINESS_MANAGER_CREATED_BY",
    "BUSINESS_MANAGER_CREATED_TIME",
    "BUSINESS_MANAGER_EXTENDED_UPDATED_TIME",
    "BUSINESS_MANAGER_IS_HIDDEN",
    "BUSINESS_MANAGER_LINK",
    "BUSINESS_MANAGER_NAME",
    "BUSINESS_MANAGER_PAYMENT_ACCOUNT_ID",
    "BUSINESS_MANAGER_PRIMARY_PAGE",
    "BUSINESS_MANAGER_PROFILE_PICTURE_URI",
    "BUSINESS_MANAGER_TIMEZONE_ID",
    "BUSINESS_MANAGER_TWO_FACTOR_TYPE",
    "BUSINESS_MANAGER_UPDATED_BY",
    "BUSINESS_MANAGER_UPDATE_TIME",
    "BUSINESS_MANAGER_VERIFICATION_STATUS",
    "BUSINESS_MANAGER_VERTICAL",
    "BUSINESS_MANAGER_VERTICAL_ID",
    "BUSINESS_MANAGER_MANAGER_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_AUTO_ENROLL",
    "EXTENDED_CREDIT_INVOICE_GROUP_CUSTOMER_PO_NUMBER",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAIL",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAILS",
    "EXTENDED_CREDIT_INVOICE_GROUP_NAME",
    "CAPABILITIES",
    "ID",
    "_FIVETRAN_SYNCED",
    "RECORD_SOURCE",
    "CURRENCY_CODE",
    "ACCOUNT_ID",
    "FACEBOOK_ACCOUNTS_HK"

    FROM hashed_columns
)

SELECT * FROM columns_to_select
  );
12:12:29.556068 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.56 seconds
12:12:29.560267 [debug] [Thread-3  ]: finished collecting timing info
12:12:29.560838 [debug] [Thread-3  ]: On model.HackdayVault.facebook_accounts_staging_hashed: Close
12:12:29.861726 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f886195-d770-432f-9aa6-ee3f0a67e1b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f1b0c10>]}
12:12:29.862877 [info ] [Thread-3  ]: 2 of 2 OK created view model hackday.facebook_accounts_staging_hashed .......... [[32mSUCCESS 1[0m in 2.27s]
12:12:29.863687 [debug] [Thread-3  ]: Finished running node model.HackdayVault.facebook_accounts_staging_hashed
12:12:29.865248 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:12:29.865769 [info ] [MainThread]: 
12:12:29.866185 [info ] [MainThread]: Finished running 2 view models in 6.75s.
12:12:29.866542 [debug] [MainThread]: Connection 'master' was properly closed.
12:12:29.866763 [debug] [MainThread]: Connection 'model.HackdayVault.facebook_accounts_staging_raw' was properly closed.
12:12:29.866953 [debug] [MainThread]: Connection 'model.HackdayVault.facebook_accounts_staging_hashed' was properly closed.
12:12:29.955613 [info ] [MainThread]: 
12:12:29.955958 [info ] [MainThread]: [32mCompleted successfully[0m
12:12:29.956197 [info ] [MainThread]: 
12:12:29.956395 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
12:12:29.956669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a9b2b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a9b2880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f00ab50>]}


============================== 2022-06-29 12:18:46.118329 | 0a3addfb-0ff8-4731-b652-d80bf2c1949e ==============================
12:18:46.118348 [info ] [MainThread]: Running with dbt=1.1.0
12:18:46.118933 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/adambekele/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['facebook_accounts_staging_raw+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
12:18:46.119090 [debug] [MainThread]: Tracking: tracking
12:18:46.119358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1618910d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161891e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1618918b0>]}
12:18:46.281644 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
12:18:46.281788 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
12:18:46.282038 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.HackdayVault.facebook_ads_insights_staging_raw
- models.HackdayVault.facebook_accounts_staging_raw

12:18:46.285629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a3addfb-0ff8-4731-b652-d80bf2c1949e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161c260d0>]}
12:18:46.328360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a3addfb-0ff8-4731-b652-d80bf2c1949e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16186d0d0>]}
12:18:46.328689 [info ] [MainThread]: Found 6 models, 9 tests, 0 snapshots, 0 analyses, 545 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
12:18:46.328899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a3addfb-0ff8-4731-b652-d80bf2c1949e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16186d0a0>]}
12:18:46.329708 [info ] [MainThread]: 
12:18:46.330024 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:18:46.330526 [debug] [ThreadPool]: Acquiring new snowflake connection "list_BLINKIST_DEV"
12:18:46.338237 [debug] [ThreadPool]: Using snowflake connection "list_BLINKIST_DEV"
12:18:46.338361 [debug] [ThreadPool]: On list_BLINKIST_DEV: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "connection_name": "list_BLINKIST_DEV"} */

    show terse schemas in database BLINKIST_DEV
    limit 10000
12:18:46.338454 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:18:50.983270 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 4.64 seconds
12:18:50.986842 [debug] [ThreadPool]: On list_BLINKIST_DEV: Close
12:18:51.288399 [debug] [ThreadPool]: Acquiring new snowflake connection "list_BLINKIST_DEV_hackday"
12:18:51.301294 [debug] [ThreadPool]: Using snowflake connection "list_BLINKIST_DEV_hackday"
12:18:51.301648 [debug] [ThreadPool]: On list_BLINKIST_DEV_hackday: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "connection_name": "list_BLINKIST_DEV_hackday"} */

    show terse objects in BLINKIST_DEV.hackday
12:18:51.301850 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:18:52.391074 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.09 seconds
12:18:52.394554 [debug] [ThreadPool]: On list_BLINKIST_DEV_hackday: Close
12:18:52.711073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a3addfb-0ff8-4731-b652-d80bf2c1949e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120eedf0>]}
12:18:52.712304 [info ] [MainThread]: Concurrency: 4 threads (target='hackday')
12:18:52.712926 [info ] [MainThread]: 
12:18:52.719636 [debug] [Thread-1  ]: Began running node model.HackdayVault.facebook_accounts_staging_raw
12:18:52.720156 [info ] [Thread-1  ]: 1 of 2 START view model hackday.facebook_accounts_staging_raw .................. [RUN]
12:18:52.720850 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.HackdayVault.facebook_accounts_staging_raw"
12:18:52.721094 [debug] [Thread-1  ]: Began compiling node model.HackdayVault.facebook_accounts_staging_raw
12:18:52.721333 [debug] [Thread-1  ]: Compiling model.HackdayVault.facebook_accounts_staging_raw
12:18:52.725768 [debug] [Thread-1  ]: Writing injected SQL for node "model.HackdayVault.facebook_accounts_staging_raw"
12:18:52.727470 [debug] [Thread-1  ]: finished collecting timing info
12:18:52.727769 [debug] [Thread-1  ]: Began executing node model.HackdayVault.facebook_accounts_staging_raw
12:18:52.753942 [debug] [Thread-1  ]: Writing runtime SQL for node "model.HackdayVault.facebook_accounts_staging_raw"
12:18:52.755226 [debug] [Thread-1  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_staging_raw"
12:18:52.755424 [debug] [Thread-1  ]: On model.HackdayVault.facebook_accounts_staging_raw: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_staging_raw"} */

  create or replace  view BLINKIST_DEV.hackday.facebook_accounts_staging_raw
  
   as (
    SELECT
    *
FROM FIVETRAN_DATABASE.facebook_ads.account_history
  );
12:18:52.755572 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:18:54.178075 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.42 seconds
12:18:54.191509 [debug] [Thread-1  ]: finished collecting timing info
12:18:54.191991 [debug] [Thread-1  ]: On model.HackdayVault.facebook_accounts_staging_raw: Close
12:18:54.480700 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a3addfb-0ff8-4731-b652-d80bf2c1949e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1661cde20>]}
12:18:54.481529 [info ] [Thread-1  ]: 1 of 2 OK created view model hackday.facebook_accounts_staging_raw ............. [[32mSUCCESS 1[0m in 1.76s]
12:18:54.482452 [debug] [Thread-1  ]: Finished running node model.HackdayVault.facebook_accounts_staging_raw
12:18:54.483552 [debug] [Thread-3  ]: Began running node model.HackdayVault.facebook_accounts_staging_hashed
12:18:54.484104 [info ] [Thread-3  ]: 2 of 2 START view model hackday.facebook_accounts_staging_hashed ............... [RUN]
12:18:54.484999 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
12:18:54.485346 [debug] [Thread-3  ]: Began compiling node model.HackdayVault.facebook_accounts_staging_hashed
12:18:54.485795 [debug] [Thread-3  ]: Compiling model.HackdayVault.facebook_accounts_staging_hashed
12:18:54.528126 [debug] [Thread-3  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
12:18:54.528509 [debug] [Thread-3  ]: On model.HackdayVault.facebook_accounts_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_staging_hashed"} */

    describe table BLINKIST_DEV.hackday.facebook_accounts_staging_raw
12:18:54.528671 [debug] [Thread-3  ]: Opening a new connection, currently in state init
12:18:56.406294 [debug] [Thread-3  ]: SQL status: SUCCESS 83 in 1.88 seconds
12:18:56.535377 [debug] [Thread-3  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
12:18:56.535709 [debug] [Thread-3  ]: On model.HackdayVault.facebook_accounts_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_staging_hashed"} */

    describe table BLINKIST_DEV.hackday.facebook_accounts_staging_raw
12:18:58.010510 [debug] [Thread-3  ]: SQL status: SUCCESS 83 in 1.47 seconds
12:18:58.133084 [debug] [Thread-3  ]: Writing injected SQL for node "model.HackdayVault.facebook_accounts_staging_hashed"
12:18:58.135840 [debug] [Thread-3  ]: finished collecting timing info
12:18:58.135938 [debug] [Thread-3  ]: Began executing node model.HackdayVault.facebook_accounts_staging_hashed
12:18:58.137497 [debug] [Thread-3  ]: Writing runtime SQL for node "model.HackdayVault.facebook_accounts_staging_hashed"
12:18:58.140494 [debug] [Thread-3  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
12:18:58.140580 [debug] [Thread-3  ]: On model.HackdayVault.facebook_accounts_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_staging_hashed"} */

  create or replace  view BLINKIST_DEV.hackday.facebook_accounts_staging_hashed
  
   as (
    







-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    "_FIVETRAN_ID",
    "AGE",
    "AMOUNT_SPENT",
    "BALANCE",
    "BUSINESS_CITY",
    "BUSINESS_COUNTRY_CODE",
    "BUSINESS_NAME",
    "BUSINESS_STATE",
    "BUSINESS_STREET",
    "BUSINESS_STREET_2",
    "BUSINESS_ZIP",
    "CAN_CREATE_BRAND_LIFT_STUDY",
    "CREATED_TIME",
    "CURRENCY",
    "END_ADVERTISER",
    "END_ADVERTISER_NAME",
    "HAS_ADVERTISER_OPTED_IN_ODAX",
    "HAS_MIGRATED_PERMISSIONS",
    "IO_NUMBER",
    "IS_ATTRIBUTION_SPEC_SYSTEM_DEFAULT",
    "IS_DIRECT_DEALS_ENABLED",
    "IS_IN_3_DS_AUTHORIZATION_ENABLED_MARKET",
    "IS_NOTIFICATIONS_ENABLED",
    "IS_PERSONAL",
    "IS_PREPAY_ACCOUNT",
    "IS_TAX_ID_REQUIRED",
    "MEDIA_AGENCY",
    "MIN_CAMPAIGN_GROUP_SPEND_CAP",
    "MIN_DAILY_BUDGET",
    "NAME",
    "NEXT_BILL_DATE",
    "OFFSITE_PIXELS_TOS_ACCEPTED",
    "OWNER",
    "PARTNER",
    "SALESFORCE_INVOICE_GROUP_ID",
    "SPEND_CAP",
    "TAX_ID",
    "TAX_ID_TYPE",
    "TIMEZONE_ID",
    "TIMEZONE_NAME",
    "TIMEZONE_OFFSET_HOURS_UTC",
    "ACCOUNT_STATUS",
    "DISABLE_REASON",
    "TAX_ID_STATUS",
    "AGENCY_CLIENT_DECLARATION_AGENCY_REPRESENTING_CLIENT",
    "AGENCY_CLIENT_DECLARATION_CLIENT_BASED_IN_FRANCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_CITY",
    "AGENCY_CLIENT_DECLARATION_CLIENT_COUNTRY_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_EMAIL_ADDRESS",
    "AGENCY_CLIENT_DECLARATION_CLIENT_NAME",
    "AGENCY_CLIENT_DECLARATION_CLIENT_POSTAL_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_PROVINCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET_2",
    "AGENCY_CLIENT_DECLARATION_HAS_WRITTEN_MANDATE_FROM_ADVERTISER",
    "AGENCY_CLIENT_DECLARATION_IS_CLIENT_PAYING_INVOICES",
    "BUSINESS_MANAGER_BLOCK_OFFLINE_ANALYTICS",
    "BUSINESS_MANAGER_CREATED_BY",
    "BUSINESS_MANAGER_CREATED_TIME",
    "BUSINESS_MANAGER_EXTENDED_UPDATED_TIME",
    "BUSINESS_MANAGER_IS_HIDDEN",
    "BUSINESS_MANAGER_LINK",
    "BUSINESS_MANAGER_NAME",
    "BUSINESS_MANAGER_PAYMENT_ACCOUNT_ID",
    "BUSINESS_MANAGER_PRIMARY_PAGE",
    "BUSINESS_MANAGER_PROFILE_PICTURE_URI",
    "BUSINESS_MANAGER_TIMEZONE_ID",
    "BUSINESS_MANAGER_TWO_FACTOR_TYPE",
    "BUSINESS_MANAGER_UPDATED_BY",
    "BUSINESS_MANAGER_UPDATE_TIME",
    "BUSINESS_MANAGER_VERIFICATION_STATUS",
    "BUSINESS_MANAGER_VERTICAL",
    "BUSINESS_MANAGER_VERTICAL_ID",
    "BUSINESS_MANAGER_MANAGER_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_AUTO_ENROLL",
    "EXTENDED_CREDIT_INVOICE_GROUP_CUSTOMER_PO_NUMBER",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAIL",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAILS",
    "EXTENDED_CREDIT_INVOICE_GROUP_NAME",
    "CAPABILITIES",
    "ID",
    "_FIVETRAN_SYNCED"

    FROM BLINKIST_DEV.hackday.facebook_accounts_staging_raw
),

derived_columns AS (

    SELECT

    "_FIVETRAN_ID",
    "AGE",
    "AMOUNT_SPENT",
    "BALANCE",
    "BUSINESS_CITY",
    "BUSINESS_COUNTRY_CODE",
    "BUSINESS_NAME",
    "BUSINESS_STATE",
    "BUSINESS_STREET",
    "BUSINESS_STREET_2",
    "BUSINESS_ZIP",
    "CAN_CREATE_BRAND_LIFT_STUDY",
    "CREATED_TIME",
    "CURRENCY",
    "END_ADVERTISER",
    "END_ADVERTISER_NAME",
    "HAS_ADVERTISER_OPTED_IN_ODAX",
    "HAS_MIGRATED_PERMISSIONS",
    "IO_NUMBER",
    "IS_ATTRIBUTION_SPEC_SYSTEM_DEFAULT",
    "IS_DIRECT_DEALS_ENABLED",
    "IS_IN_3_DS_AUTHORIZATION_ENABLED_MARKET",
    "IS_NOTIFICATIONS_ENABLED",
    "IS_PERSONAL",
    "IS_PREPAY_ACCOUNT",
    "IS_TAX_ID_REQUIRED",
    "MEDIA_AGENCY",
    "MIN_CAMPAIGN_GROUP_SPEND_CAP",
    "MIN_DAILY_BUDGET",
    "NAME",
    "NEXT_BILL_DATE",
    "OFFSITE_PIXELS_TOS_ACCEPTED",
    "OWNER",
    "PARTNER",
    "SALESFORCE_INVOICE_GROUP_ID",
    "SPEND_CAP",
    "TAX_ID",
    "TAX_ID_TYPE",
    "TIMEZONE_ID",
    "TIMEZONE_NAME",
    "TIMEZONE_OFFSET_HOURS_UTC",
    "ACCOUNT_STATUS",
    "DISABLE_REASON",
    "TAX_ID_STATUS",
    "AGENCY_CLIENT_DECLARATION_AGENCY_REPRESENTING_CLIENT",
    "AGENCY_CLIENT_DECLARATION_CLIENT_BASED_IN_FRANCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_CITY",
    "AGENCY_CLIENT_DECLARATION_CLIENT_COUNTRY_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_EMAIL_ADDRESS",
    "AGENCY_CLIENT_DECLARATION_CLIENT_NAME",
    "AGENCY_CLIENT_DECLARATION_CLIENT_POSTAL_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_PROVINCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET_2",
    "AGENCY_CLIENT_DECLARATION_HAS_WRITTEN_MANDATE_FROM_ADVERTISER",
    "AGENCY_CLIENT_DECLARATION_IS_CLIENT_PAYING_INVOICES",
    "BUSINESS_MANAGER_BLOCK_OFFLINE_ANALYTICS",
    "BUSINESS_MANAGER_CREATED_BY",
    "BUSINESS_MANAGER_CREATED_TIME",
    "BUSINESS_MANAGER_EXTENDED_UPDATED_TIME",
    "BUSINESS_MANAGER_IS_HIDDEN",
    "BUSINESS_MANAGER_LINK",
    "BUSINESS_MANAGER_NAME",
    "BUSINESS_MANAGER_PAYMENT_ACCOUNT_ID",
    "BUSINESS_MANAGER_PRIMARY_PAGE",
    "BUSINESS_MANAGER_PROFILE_PICTURE_URI",
    "BUSINESS_MANAGER_TIMEZONE_ID",
    "BUSINESS_MANAGER_TWO_FACTOR_TYPE",
    "BUSINESS_MANAGER_UPDATED_BY",
    "BUSINESS_MANAGER_UPDATE_TIME",
    "BUSINESS_MANAGER_VERIFICATION_STATUS",
    "BUSINESS_MANAGER_VERTICAL",
    "BUSINESS_MANAGER_VERTICAL_ID",
    "BUSINESS_MANAGER_MANAGER_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_AUTO_ENROLL",
    "EXTENDED_CREDIT_INVOICE_GROUP_CUSTOMER_PO_NUMBER",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAIL",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAILS",
    "EXTENDED_CREDIT_INVOICE_GROUP_NAME",
    "CAPABILITIES",
    "ID",
    "_FIVETRAN_SYNCED",
    'FIVETRAN_FACEBOOK_ACCOUNTS_RAW' AS "RECORD_SOURCE",
    "CURRENCY" AS "CURRENCY_CODE",
    "ID" AS "ACCOUNT_ID"

    FROM source_data
),

hashed_columns AS (

    SELECT

    "_FIVETRAN_ID",
    "AGE",
    "AMOUNT_SPENT",
    "BALANCE",
    "BUSINESS_CITY",
    "BUSINESS_COUNTRY_CODE",
    "BUSINESS_NAME",
    "BUSINESS_STATE",
    "BUSINESS_STREET",
    "BUSINESS_STREET_2",
    "BUSINESS_ZIP",
    "CAN_CREATE_BRAND_LIFT_STUDY",
    "CREATED_TIME",
    "CURRENCY",
    "END_ADVERTISER",
    "END_ADVERTISER_NAME",
    "HAS_ADVERTISER_OPTED_IN_ODAX",
    "HAS_MIGRATED_PERMISSIONS",
    "IO_NUMBER",
    "IS_ATTRIBUTION_SPEC_SYSTEM_DEFAULT",
    "IS_DIRECT_DEALS_ENABLED",
    "IS_IN_3_DS_AUTHORIZATION_ENABLED_MARKET",
    "IS_NOTIFICATIONS_ENABLED",
    "IS_PERSONAL",
    "IS_PREPAY_ACCOUNT",
    "IS_TAX_ID_REQUIRED",
    "MEDIA_AGENCY",
    "MIN_CAMPAIGN_GROUP_SPEND_CAP",
    "MIN_DAILY_BUDGET",
    "NAME",
    "NEXT_BILL_DATE",
    "OFFSITE_PIXELS_TOS_ACCEPTED",
    "OWNER",
    "PARTNER",
    "SALESFORCE_INVOICE_GROUP_ID",
    "SPEND_CAP",
    "TAX_ID",
    "TAX_ID_TYPE",
    "TIMEZONE_ID",
    "TIMEZONE_NAME",
    "TIMEZONE_OFFSET_HOURS_UTC",
    "ACCOUNT_STATUS",
    "DISABLE_REASON",
    "TAX_ID_STATUS",
    "AGENCY_CLIENT_DECLARATION_AGENCY_REPRESENTING_CLIENT",
    "AGENCY_CLIENT_DECLARATION_CLIENT_BASED_IN_FRANCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_CITY",
    "AGENCY_CLIENT_DECLARATION_CLIENT_COUNTRY_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_EMAIL_ADDRESS",
    "AGENCY_CLIENT_DECLARATION_CLIENT_NAME",
    "AGENCY_CLIENT_DECLARATION_CLIENT_POSTAL_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_PROVINCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET_2",
    "AGENCY_CLIENT_DECLARATION_HAS_WRITTEN_MANDATE_FROM_ADVERTISER",
    "AGENCY_CLIENT_DECLARATION_IS_CLIENT_PAYING_INVOICES",
    "BUSINESS_MANAGER_BLOCK_OFFLINE_ANALYTICS",
    "BUSINESS_MANAGER_CREATED_BY",
    "BUSINESS_MANAGER_CREATED_TIME",
    "BUSINESS_MANAGER_EXTENDED_UPDATED_TIME",
    "BUSINESS_MANAGER_IS_HIDDEN",
    "BUSINESS_MANAGER_LINK",
    "BUSINESS_MANAGER_NAME",
    "BUSINESS_MANAGER_PAYMENT_ACCOUNT_ID",
    "BUSINESS_MANAGER_PRIMARY_PAGE",
    "BUSINESS_MANAGER_PROFILE_PICTURE_URI",
    "BUSINESS_MANAGER_TIMEZONE_ID",
    "BUSINESS_MANAGER_TWO_FACTOR_TYPE",
    "BUSINESS_MANAGER_UPDATED_BY",
    "BUSINESS_MANAGER_UPDATE_TIME",
    "BUSINESS_MANAGER_VERIFICATION_STATUS",
    "BUSINESS_MANAGER_VERTICAL",
    "BUSINESS_MANAGER_VERTICAL_ID",
    "BUSINESS_MANAGER_MANAGER_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_AUTO_ENROLL",
    "EXTENDED_CREDIT_INVOICE_GROUP_CUSTOMER_PO_NUMBER",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAIL",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAILS",
    "EXTENDED_CREDIT_INVOICE_GROUP_NAME",
    "CAPABILITIES",
    "ID",
    "_FIVETRAN_SYNCED",
    "RECORD_SOURCE",
    "CURRENCY_CODE",
    "ACCOUNT_ID",

    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("ACCOUNT_ID" AS VARCHAR))), ''), '^^')
    ), '^^')) AS BINARY(16)) AS "FACEBOOK_ACCOUNTS_HK"

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    "_FIVETRAN_ID",
    "AGE",
    "AMOUNT_SPENT",
    "BALANCE",
    "BUSINESS_CITY",
    "BUSINESS_COUNTRY_CODE",
    "BUSINESS_NAME",
    "BUSINESS_STATE",
    "BUSINESS_STREET",
    "BUSINESS_STREET_2",
    "BUSINESS_ZIP",
    "CAN_CREATE_BRAND_LIFT_STUDY",
    "CREATED_TIME",
    "CURRENCY",
    "END_ADVERTISER",
    "END_ADVERTISER_NAME",
    "HAS_ADVERTISER_OPTED_IN_ODAX",
    "HAS_MIGRATED_PERMISSIONS",
    "IO_NUMBER",
    "IS_ATTRIBUTION_SPEC_SYSTEM_DEFAULT",
    "IS_DIRECT_DEALS_ENABLED",
    "IS_IN_3_DS_AUTHORIZATION_ENABLED_MARKET",
    "IS_NOTIFICATIONS_ENABLED",
    "IS_PERSONAL",
    "IS_PREPAY_ACCOUNT",
    "IS_TAX_ID_REQUIRED",
    "MEDIA_AGENCY",
    "MIN_CAMPAIGN_GROUP_SPEND_CAP",
    "MIN_DAILY_BUDGET",
    "NAME",
    "NEXT_BILL_DATE",
    "OFFSITE_PIXELS_TOS_ACCEPTED",
    "OWNER",
    "PARTNER",
    "SALESFORCE_INVOICE_GROUP_ID",
    "SPEND_CAP",
    "TAX_ID",
    "TAX_ID_TYPE",
    "TIMEZONE_ID",
    "TIMEZONE_NAME",
    "TIMEZONE_OFFSET_HOURS_UTC",
    "ACCOUNT_STATUS",
    "DISABLE_REASON",
    "TAX_ID_STATUS",
    "AGENCY_CLIENT_DECLARATION_AGENCY_REPRESENTING_CLIENT",
    "AGENCY_CLIENT_DECLARATION_CLIENT_BASED_IN_FRANCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_CITY",
    "AGENCY_CLIENT_DECLARATION_CLIENT_COUNTRY_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_EMAIL_ADDRESS",
    "AGENCY_CLIENT_DECLARATION_CLIENT_NAME",
    "AGENCY_CLIENT_DECLARATION_CLIENT_POSTAL_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_PROVINCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET_2",
    "AGENCY_CLIENT_DECLARATION_HAS_WRITTEN_MANDATE_FROM_ADVERTISER",
    "AGENCY_CLIENT_DECLARATION_IS_CLIENT_PAYING_INVOICES",
    "BUSINESS_MANAGER_BLOCK_OFFLINE_ANALYTICS",
    "BUSINESS_MANAGER_CREATED_BY",
    "BUSINESS_MANAGER_CREATED_TIME",
    "BUSINESS_MANAGER_EXTENDED_UPDATED_TIME",
    "BUSINESS_MANAGER_IS_HIDDEN",
    "BUSINESS_MANAGER_LINK",
    "BUSINESS_MANAGER_NAME",
    "BUSINESS_MANAGER_PAYMENT_ACCOUNT_ID",
    "BUSINESS_MANAGER_PRIMARY_PAGE",
    "BUSINESS_MANAGER_PROFILE_PICTURE_URI",
    "BUSINESS_MANAGER_TIMEZONE_ID",
    "BUSINESS_MANAGER_TWO_FACTOR_TYPE",
    "BUSINESS_MANAGER_UPDATED_BY",
    "BUSINESS_MANAGER_UPDATE_TIME",
    "BUSINESS_MANAGER_VERIFICATION_STATUS",
    "BUSINESS_MANAGER_VERTICAL",
    "BUSINESS_MANAGER_VERTICAL_ID",
    "BUSINESS_MANAGER_MANAGER_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_AUTO_ENROLL",
    "EXTENDED_CREDIT_INVOICE_GROUP_CUSTOMER_PO_NUMBER",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAIL",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAILS",
    "EXTENDED_CREDIT_INVOICE_GROUP_NAME",
    "CAPABILITIES",
    "ID",
    "_FIVETRAN_SYNCED",
    "RECORD_SOURCE",
    "CURRENCY_CODE",
    "ACCOUNT_ID",
    "FACEBOOK_ACCOUNTS_HK"

    FROM hashed_columns
)

SELECT * FROM columns_to_select
  );
12:18:58.547767 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.41 seconds
12:18:58.550389 [debug] [Thread-3  ]: finished collecting timing info
12:18:58.550861 [debug] [Thread-3  ]: On model.HackdayVault.facebook_accounts_staging_hashed: Close
12:18:58.865875 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a3addfb-0ff8-4731-b652-d80bf2c1949e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16620aac0>]}
12:18:58.867303 [info ] [Thread-3  ]: 2 of 2 OK created view model hackday.facebook_accounts_staging_hashed .......... [[32mSUCCESS 1[0m in 4.38s]
12:18:58.868553 [debug] [Thread-3  ]: Finished running node model.HackdayVault.facebook_accounts_staging_hashed
12:18:58.870233 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:18:58.870855 [info ] [MainThread]: 
12:18:58.871294 [info ] [MainThread]: Finished running 2 view models in 12.54s.
12:18:58.871674 [debug] [MainThread]: Connection 'master' was properly closed.
12:18:58.871878 [debug] [MainThread]: Connection 'model.HackdayVault.facebook_accounts_staging_raw' was properly closed.
12:18:58.872082 [debug] [MainThread]: Connection 'model.HackdayVault.facebook_accounts_staging_hashed' was properly closed.
12:18:58.957982 [info ] [MainThread]: 
12:18:58.958282 [info ] [MainThread]: [32mCompleted successfully[0m
12:18:58.958519 [info ] [MainThread]: 
12:18:58.958712 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
12:18:58.958968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16625a460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16625a5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x166305e50>]}


============================== 2022-06-29 12:19:25.547655 | 42843b01-0bb6-4f4b-b830-08d739bf5fdb ==============================
12:19:25.547684 [info ] [MainThread]: Running with dbt=1.1.0
12:19:25.548344 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/adambekele/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['facebook_accounts_staging_raw+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
12:19:25.548508 [debug] [MainThread]: Tracking: tracking
12:19:25.548829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161a4ad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161a4a6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161a4a880>]}
12:19:25.655184 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
12:19:25.655338 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
12:19:25.655592 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.HackdayVault.facebook_accounts_staging_raw
- models.HackdayVault.facebook_ads_insights_staging_raw

12:19:25.659352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42843b01-0bb6-4f4b-b830-08d739bf5fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161cbd0d0>]}
12:19:25.697965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42843b01-0bb6-4f4b-b830-08d739bf5fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161bf5040>]}
12:19:25.698209 [info ] [MainThread]: Found 6 models, 9 tests, 0 snapshots, 0 analyses, 545 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
12:19:25.698389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42843b01-0bb6-4f4b-b830-08d739bf5fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161bf50d0>]}
12:19:25.699155 [info ] [MainThread]: 
12:19:25.699455 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:19:25.699903 [debug] [ThreadPool]: Acquiring new snowflake connection "list_BLINKIST_DEV"
12:19:25.707212 [debug] [ThreadPool]: Using snowflake connection "list_BLINKIST_DEV"
12:19:25.707329 [debug] [ThreadPool]: On list_BLINKIST_DEV: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "connection_name": "list_BLINKIST_DEV"} */

    show terse schemas in database BLINKIST_DEV
    limit 10000
12:19:25.707415 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:19:26.999692 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.29 seconds
12:19:27.002405 [debug] [ThreadPool]: On list_BLINKIST_DEV: Close
12:19:27.313492 [debug] [ThreadPool]: Acquiring new snowflake connection "list_BLINKIST_DEV_hackday"
12:19:27.325691 [debug] [ThreadPool]: Using snowflake connection "list_BLINKIST_DEV_hackday"
12:19:27.325979 [debug] [ThreadPool]: On list_BLINKIST_DEV_hackday: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "connection_name": "list_BLINKIST_DEV_hackday"} */

    show terse objects in BLINKIST_DEV.hackday
12:19:27.326186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:19:28.501909 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.18 seconds
12:19:28.506285 [debug] [ThreadPool]: On list_BLINKIST_DEV_hackday: Close
12:19:28.807206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42843b01-0bb6-4f4b-b830-08d739bf5fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161a561c0>]}
12:19:28.808218 [info ] [MainThread]: Concurrency: 4 threads (target='hackday')
12:19:28.808696 [info ] [MainThread]: 
12:19:28.815603 [debug] [Thread-1  ]: Began running node model.HackdayVault.facebook_accounts_staging_raw
12:19:28.816125 [info ] [Thread-1  ]: 1 of 2 START view model hackday.facebook_accounts_staging_raw .................. [RUN]
12:19:28.816838 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.HackdayVault.facebook_accounts_staging_raw"
12:19:28.817088 [debug] [Thread-1  ]: Began compiling node model.HackdayVault.facebook_accounts_staging_raw
12:19:28.817316 [debug] [Thread-1  ]: Compiling model.HackdayVault.facebook_accounts_staging_raw
12:19:28.821175 [debug] [Thread-1  ]: Writing injected SQL for node "model.HackdayVault.facebook_accounts_staging_raw"
12:19:28.825496 [debug] [Thread-1  ]: finished collecting timing info
12:19:28.825794 [debug] [Thread-1  ]: Began executing node model.HackdayVault.facebook_accounts_staging_raw
12:19:28.849379 [debug] [Thread-1  ]: Writing runtime SQL for node "model.HackdayVault.facebook_accounts_staging_raw"
12:19:28.854457 [debug] [Thread-1  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_staging_raw"
12:19:28.854727 [debug] [Thread-1  ]: On model.HackdayVault.facebook_accounts_staging_raw: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_staging_raw"} */

  create or replace  view BLINKIST_DEV.hackday.facebook_accounts_staging_raw
  
   as (
    SELECT
    *
FROM FIVETRAN_DATABASE.facebook_ads.account_history
  );
12:19:28.854864 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:19:29.903842 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.05 seconds
12:19:29.915758 [debug] [Thread-1  ]: finished collecting timing info
12:19:29.916221 [debug] [Thread-1  ]: On model.HackdayVault.facebook_accounts_staging_raw: Close
12:19:30.218262 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42843b01-0bb6-4f4b-b830-08d739bf5fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161df6040>]}
12:19:30.219705 [info ] [Thread-1  ]: 1 of 2 OK created view model hackday.facebook_accounts_staging_raw ............. [[32mSUCCESS 1[0m in 1.40s]
12:19:30.220668 [debug] [Thread-1  ]: Finished running node model.HackdayVault.facebook_accounts_staging_raw
12:19:30.221528 [debug] [Thread-3  ]: Began running node model.HackdayVault.facebook_accounts_staging_hashed
12:19:30.222035 [info ] [Thread-3  ]: 2 of 2 START view model hackday.facebook_accounts_staging_hashed ............... [RUN]
12:19:30.222731 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
12:19:30.222982 [debug] [Thread-3  ]: Began compiling node model.HackdayVault.facebook_accounts_staging_hashed
12:19:30.223214 [debug] [Thread-3  ]: Compiling model.HackdayVault.facebook_accounts_staging_hashed
12:19:30.263864 [debug] [Thread-3  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
12:19:30.264248 [debug] [Thread-3  ]: On model.HackdayVault.facebook_accounts_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_staging_hashed"} */

    describe table BLINKIST_DEV.hackday.facebook_accounts_staging_raw
12:19:30.264405 [debug] [Thread-3  ]: Opening a new connection, currently in state init
12:19:31.298247 [debug] [Thread-3  ]: SQL status: SUCCESS 83 in 1.03 seconds
12:19:31.366872 [debug] [Thread-3  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
12:19:31.367327 [debug] [Thread-3  ]: On model.HackdayVault.facebook_accounts_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_staging_hashed"} */

    describe table BLINKIST_DEV.hackday.facebook_accounts_staging_raw
12:19:31.530337 [debug] [Thread-3  ]: SQL status: SUCCESS 83 in 0.16 seconds
12:19:31.617248 [debug] [Thread-3  ]: Writing injected SQL for node "model.HackdayVault.facebook_accounts_staging_hashed"
12:19:31.619103 [debug] [Thread-3  ]: finished collecting timing info
12:19:31.619219 [debug] [Thread-3  ]: Began executing node model.HackdayVault.facebook_accounts_staging_hashed
12:19:31.620835 [debug] [Thread-3  ]: Writing runtime SQL for node "model.HackdayVault.facebook_accounts_staging_hashed"
12:19:31.630504 [debug] [Thread-3  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
12:19:31.630631 [debug] [Thread-3  ]: On model.HackdayVault.facebook_accounts_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_staging_hashed"} */

  create or replace  view BLINKIST_DEV.hackday.facebook_accounts_staging_hashed
  
   as (
    







-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    "_FIVETRAN_ID",
    "AGE",
    "AMOUNT_SPENT",
    "BALANCE",
    "BUSINESS_CITY",
    "BUSINESS_COUNTRY_CODE",
    "BUSINESS_NAME",
    "BUSINESS_STATE",
    "BUSINESS_STREET",
    "BUSINESS_STREET_2",
    "BUSINESS_ZIP",
    "CAN_CREATE_BRAND_LIFT_STUDY",
    "CREATED_TIME",
    "CURRENCY",
    "END_ADVERTISER",
    "END_ADVERTISER_NAME",
    "HAS_ADVERTISER_OPTED_IN_ODAX",
    "HAS_MIGRATED_PERMISSIONS",
    "IO_NUMBER",
    "IS_ATTRIBUTION_SPEC_SYSTEM_DEFAULT",
    "IS_DIRECT_DEALS_ENABLED",
    "IS_IN_3_DS_AUTHORIZATION_ENABLED_MARKET",
    "IS_NOTIFICATIONS_ENABLED",
    "IS_PERSONAL",
    "IS_PREPAY_ACCOUNT",
    "IS_TAX_ID_REQUIRED",
    "MEDIA_AGENCY",
    "MIN_CAMPAIGN_GROUP_SPEND_CAP",
    "MIN_DAILY_BUDGET",
    "NAME",
    "NEXT_BILL_DATE",
    "OFFSITE_PIXELS_TOS_ACCEPTED",
    "OWNER",
    "PARTNER",
    "SALESFORCE_INVOICE_GROUP_ID",
    "SPEND_CAP",
    "TAX_ID",
    "TAX_ID_TYPE",
    "TIMEZONE_ID",
    "TIMEZONE_NAME",
    "TIMEZONE_OFFSET_HOURS_UTC",
    "ACCOUNT_STATUS",
    "DISABLE_REASON",
    "TAX_ID_STATUS",
    "AGENCY_CLIENT_DECLARATION_AGENCY_REPRESENTING_CLIENT",
    "AGENCY_CLIENT_DECLARATION_CLIENT_BASED_IN_FRANCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_CITY",
    "AGENCY_CLIENT_DECLARATION_CLIENT_COUNTRY_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_EMAIL_ADDRESS",
    "AGENCY_CLIENT_DECLARATION_CLIENT_NAME",
    "AGENCY_CLIENT_DECLARATION_CLIENT_POSTAL_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_PROVINCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET_2",
    "AGENCY_CLIENT_DECLARATION_HAS_WRITTEN_MANDATE_FROM_ADVERTISER",
    "AGENCY_CLIENT_DECLARATION_IS_CLIENT_PAYING_INVOICES",
    "BUSINESS_MANAGER_BLOCK_OFFLINE_ANALYTICS",
    "BUSINESS_MANAGER_CREATED_BY",
    "BUSINESS_MANAGER_CREATED_TIME",
    "BUSINESS_MANAGER_EXTENDED_UPDATED_TIME",
    "BUSINESS_MANAGER_IS_HIDDEN",
    "BUSINESS_MANAGER_LINK",
    "BUSINESS_MANAGER_NAME",
    "BUSINESS_MANAGER_PAYMENT_ACCOUNT_ID",
    "BUSINESS_MANAGER_PRIMARY_PAGE",
    "BUSINESS_MANAGER_PROFILE_PICTURE_URI",
    "BUSINESS_MANAGER_TIMEZONE_ID",
    "BUSINESS_MANAGER_TWO_FACTOR_TYPE",
    "BUSINESS_MANAGER_UPDATED_BY",
    "BUSINESS_MANAGER_UPDATE_TIME",
    "BUSINESS_MANAGER_VERIFICATION_STATUS",
    "BUSINESS_MANAGER_VERTICAL",
    "BUSINESS_MANAGER_VERTICAL_ID",
    "BUSINESS_MANAGER_MANAGER_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_AUTO_ENROLL",
    "EXTENDED_CREDIT_INVOICE_GROUP_CUSTOMER_PO_NUMBER",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAIL",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAILS",
    "EXTENDED_CREDIT_INVOICE_GROUP_NAME",
    "CAPABILITIES",
    "ID",
    "_FIVETRAN_SYNCED"

    FROM BLINKIST_DEV.hackday.facebook_accounts_staging_raw
),

derived_columns AS (

    SELECT

    "_FIVETRAN_ID",
    "AGE",
    "AMOUNT_SPENT",
    "BALANCE",
    "BUSINESS_CITY",
    "BUSINESS_COUNTRY_CODE",
    "BUSINESS_NAME",
    "BUSINESS_STATE",
    "BUSINESS_STREET",
    "BUSINESS_STREET_2",
    "BUSINESS_ZIP",
    "CAN_CREATE_BRAND_LIFT_STUDY",
    "CREATED_TIME",
    "CURRENCY",
    "END_ADVERTISER",
    "END_ADVERTISER_NAME",
    "HAS_ADVERTISER_OPTED_IN_ODAX",
    "HAS_MIGRATED_PERMISSIONS",
    "IO_NUMBER",
    "IS_ATTRIBUTION_SPEC_SYSTEM_DEFAULT",
    "IS_DIRECT_DEALS_ENABLED",
    "IS_IN_3_DS_AUTHORIZATION_ENABLED_MARKET",
    "IS_NOTIFICATIONS_ENABLED",
    "IS_PERSONAL",
    "IS_PREPAY_ACCOUNT",
    "IS_TAX_ID_REQUIRED",
    "MEDIA_AGENCY",
    "MIN_CAMPAIGN_GROUP_SPEND_CAP",
    "MIN_DAILY_BUDGET",
    "NAME",
    "NEXT_BILL_DATE",
    "OFFSITE_PIXELS_TOS_ACCEPTED",
    "OWNER",
    "PARTNER",
    "SALESFORCE_INVOICE_GROUP_ID",
    "SPEND_CAP",
    "TAX_ID",
    "TAX_ID_TYPE",
    "TIMEZONE_ID",
    "TIMEZONE_NAME",
    "TIMEZONE_OFFSET_HOURS_UTC",
    "ACCOUNT_STATUS",
    "DISABLE_REASON",
    "TAX_ID_STATUS",
    "AGENCY_CLIENT_DECLARATION_AGENCY_REPRESENTING_CLIENT",
    "AGENCY_CLIENT_DECLARATION_CLIENT_BASED_IN_FRANCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_CITY",
    "AGENCY_CLIENT_DECLARATION_CLIENT_COUNTRY_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_EMAIL_ADDRESS",
    "AGENCY_CLIENT_DECLARATION_CLIENT_NAME",
    "AGENCY_CLIENT_DECLARATION_CLIENT_POSTAL_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_PROVINCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET_2",
    "AGENCY_CLIENT_DECLARATION_HAS_WRITTEN_MANDATE_FROM_ADVERTISER",
    "AGENCY_CLIENT_DECLARATION_IS_CLIENT_PAYING_INVOICES",
    "BUSINESS_MANAGER_BLOCK_OFFLINE_ANALYTICS",
    "BUSINESS_MANAGER_CREATED_BY",
    "BUSINESS_MANAGER_CREATED_TIME",
    "BUSINESS_MANAGER_EXTENDED_UPDATED_TIME",
    "BUSINESS_MANAGER_IS_HIDDEN",
    "BUSINESS_MANAGER_LINK",
    "BUSINESS_MANAGER_NAME",
    "BUSINESS_MANAGER_PAYMENT_ACCOUNT_ID",
    "BUSINESS_MANAGER_PRIMARY_PAGE",
    "BUSINESS_MANAGER_PROFILE_PICTURE_URI",
    "BUSINESS_MANAGER_TIMEZONE_ID",
    "BUSINESS_MANAGER_TWO_FACTOR_TYPE",
    "BUSINESS_MANAGER_UPDATED_BY",
    "BUSINESS_MANAGER_UPDATE_TIME",
    "BUSINESS_MANAGER_VERIFICATION_STATUS",
    "BUSINESS_MANAGER_VERTICAL",
    "BUSINESS_MANAGER_VERTICAL_ID",
    "BUSINESS_MANAGER_MANAGER_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_AUTO_ENROLL",
    "EXTENDED_CREDIT_INVOICE_GROUP_CUSTOMER_PO_NUMBER",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAIL",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAILS",
    "EXTENDED_CREDIT_INVOICE_GROUP_NAME",
    "CAPABILITIES",
    "ID",
    "_FIVETRAN_SYNCED",
    'FIVETRAN_FACEBOOK_ACCOUNTS_RAW' AS "RECORD_SOURCE",
    "CURRENCY" AS "CURRENCY_CODE",
    "ID" AS "ACCOUNT_ID"

    FROM source_data
),

hashed_columns AS (

    SELECT

    "_FIVETRAN_ID",
    "AGE",
    "AMOUNT_SPENT",
    "BALANCE",
    "BUSINESS_CITY",
    "BUSINESS_COUNTRY_CODE",
    "BUSINESS_NAME",
    "BUSINESS_STATE",
    "BUSINESS_STREET",
    "BUSINESS_STREET_2",
    "BUSINESS_ZIP",
    "CAN_CREATE_BRAND_LIFT_STUDY",
    "CREATED_TIME",
    "CURRENCY",
    "END_ADVERTISER",
    "END_ADVERTISER_NAME",
    "HAS_ADVERTISER_OPTED_IN_ODAX",
    "HAS_MIGRATED_PERMISSIONS",
    "IO_NUMBER",
    "IS_ATTRIBUTION_SPEC_SYSTEM_DEFAULT",
    "IS_DIRECT_DEALS_ENABLED",
    "IS_IN_3_DS_AUTHORIZATION_ENABLED_MARKET",
    "IS_NOTIFICATIONS_ENABLED",
    "IS_PERSONAL",
    "IS_PREPAY_ACCOUNT",
    "IS_TAX_ID_REQUIRED",
    "MEDIA_AGENCY",
    "MIN_CAMPAIGN_GROUP_SPEND_CAP",
    "MIN_DAILY_BUDGET",
    "NAME",
    "NEXT_BILL_DATE",
    "OFFSITE_PIXELS_TOS_ACCEPTED",
    "OWNER",
    "PARTNER",
    "SALESFORCE_INVOICE_GROUP_ID",
    "SPEND_CAP",
    "TAX_ID",
    "TAX_ID_TYPE",
    "TIMEZONE_ID",
    "TIMEZONE_NAME",
    "TIMEZONE_OFFSET_HOURS_UTC",
    "ACCOUNT_STATUS",
    "DISABLE_REASON",
    "TAX_ID_STATUS",
    "AGENCY_CLIENT_DECLARATION_AGENCY_REPRESENTING_CLIENT",
    "AGENCY_CLIENT_DECLARATION_CLIENT_BASED_IN_FRANCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_CITY",
    "AGENCY_CLIENT_DECLARATION_CLIENT_COUNTRY_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_EMAIL_ADDRESS",
    "AGENCY_CLIENT_DECLARATION_CLIENT_NAME",
    "AGENCY_CLIENT_DECLARATION_CLIENT_POSTAL_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_PROVINCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET_2",
    "AGENCY_CLIENT_DECLARATION_HAS_WRITTEN_MANDATE_FROM_ADVERTISER",
    "AGENCY_CLIENT_DECLARATION_IS_CLIENT_PAYING_INVOICES",
    "BUSINESS_MANAGER_BLOCK_OFFLINE_ANALYTICS",
    "BUSINESS_MANAGER_CREATED_BY",
    "BUSINESS_MANAGER_CREATED_TIME",
    "BUSINESS_MANAGER_EXTENDED_UPDATED_TIME",
    "BUSINESS_MANAGER_IS_HIDDEN",
    "BUSINESS_MANAGER_LINK",
    "BUSINESS_MANAGER_NAME",
    "BUSINESS_MANAGER_PAYMENT_ACCOUNT_ID",
    "BUSINESS_MANAGER_PRIMARY_PAGE",
    "BUSINESS_MANAGER_PROFILE_PICTURE_URI",
    "BUSINESS_MANAGER_TIMEZONE_ID",
    "BUSINESS_MANAGER_TWO_FACTOR_TYPE",
    "BUSINESS_MANAGER_UPDATED_BY",
    "BUSINESS_MANAGER_UPDATE_TIME",
    "BUSINESS_MANAGER_VERIFICATION_STATUS",
    "BUSINESS_MANAGER_VERTICAL",
    "BUSINESS_MANAGER_VERTICAL_ID",
    "BUSINESS_MANAGER_MANAGER_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_AUTO_ENROLL",
    "EXTENDED_CREDIT_INVOICE_GROUP_CUSTOMER_PO_NUMBER",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAIL",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAILS",
    "EXTENDED_CREDIT_INVOICE_GROUP_NAME",
    "CAPABILITIES",
    "ID",
    "_FIVETRAN_SYNCED",
    "RECORD_SOURCE",
    "CURRENCY_CODE",
    "ACCOUNT_ID",

    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("ACCOUNT_ID" AS VARCHAR))), ''), '^^')
    ), '^^')) AS BINARY(16)) AS "FACEBOOK_ACCOUNTS_HK"

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    "_FIVETRAN_ID",
    "AGE",
    "AMOUNT_SPENT",
    "BALANCE",
    "BUSINESS_CITY",
    "BUSINESS_COUNTRY_CODE",
    "BUSINESS_NAME",
    "BUSINESS_STATE",
    "BUSINESS_STREET",
    "BUSINESS_STREET_2",
    "BUSINESS_ZIP",
    "CAN_CREATE_BRAND_LIFT_STUDY",
    "CREATED_TIME",
    "CURRENCY",
    "END_ADVERTISER",
    "END_ADVERTISER_NAME",
    "HAS_ADVERTISER_OPTED_IN_ODAX",
    "HAS_MIGRATED_PERMISSIONS",
    "IO_NUMBER",
    "IS_ATTRIBUTION_SPEC_SYSTEM_DEFAULT",
    "IS_DIRECT_DEALS_ENABLED",
    "IS_IN_3_DS_AUTHORIZATION_ENABLED_MARKET",
    "IS_NOTIFICATIONS_ENABLED",
    "IS_PERSONAL",
    "IS_PREPAY_ACCOUNT",
    "IS_TAX_ID_REQUIRED",
    "MEDIA_AGENCY",
    "MIN_CAMPAIGN_GROUP_SPEND_CAP",
    "MIN_DAILY_BUDGET",
    "NAME",
    "NEXT_BILL_DATE",
    "OFFSITE_PIXELS_TOS_ACCEPTED",
    "OWNER",
    "PARTNER",
    "SALESFORCE_INVOICE_GROUP_ID",
    "SPEND_CAP",
    "TAX_ID",
    "TAX_ID_TYPE",
    "TIMEZONE_ID",
    "TIMEZONE_NAME",
    "TIMEZONE_OFFSET_HOURS_UTC",
    "ACCOUNT_STATUS",
    "DISABLE_REASON",
    "TAX_ID_STATUS",
    "AGENCY_CLIENT_DECLARATION_AGENCY_REPRESENTING_CLIENT",
    "AGENCY_CLIENT_DECLARATION_CLIENT_BASED_IN_FRANCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_CITY",
    "AGENCY_CLIENT_DECLARATION_CLIENT_COUNTRY_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_EMAIL_ADDRESS",
    "AGENCY_CLIENT_DECLARATION_CLIENT_NAME",
    "AGENCY_CLIENT_DECLARATION_CLIENT_POSTAL_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_PROVINCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET_2",
    "AGENCY_CLIENT_DECLARATION_HAS_WRITTEN_MANDATE_FROM_ADVERTISER",
    "AGENCY_CLIENT_DECLARATION_IS_CLIENT_PAYING_INVOICES",
    "BUSINESS_MANAGER_BLOCK_OFFLINE_ANALYTICS",
    "BUSINESS_MANAGER_CREATED_BY",
    "BUSINESS_MANAGER_CREATED_TIME",
    "BUSINESS_MANAGER_EXTENDED_UPDATED_TIME",
    "BUSINESS_MANAGER_IS_HIDDEN",
    "BUSINESS_MANAGER_LINK",
    "BUSINESS_MANAGER_NAME",
    "BUSINESS_MANAGER_PAYMENT_ACCOUNT_ID",
    "BUSINESS_MANAGER_PRIMARY_PAGE",
    "BUSINESS_MANAGER_PROFILE_PICTURE_URI",
    "BUSINESS_MANAGER_TIMEZONE_ID",
    "BUSINESS_MANAGER_TWO_FACTOR_TYPE",
    "BUSINESS_MANAGER_UPDATED_BY",
    "BUSINESS_MANAGER_UPDATE_TIME",
    "BUSINESS_MANAGER_VERIFICATION_STATUS",
    "BUSINESS_MANAGER_VERTICAL",
    "BUSINESS_MANAGER_VERTICAL_ID",
    "BUSINESS_MANAGER_MANAGER_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_AUTO_ENROLL",
    "EXTENDED_CREDIT_INVOICE_GROUP_CUSTOMER_PO_NUMBER",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAIL",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAILS",
    "EXTENDED_CREDIT_INVOICE_GROUP_NAME",
    "CAPABILITIES",
    "ID",
    "_FIVETRAN_SYNCED",
    "RECORD_SOURCE",
    "CURRENCY_CODE",
    "ACCOUNT_ID",
    "FACEBOOK_ACCOUNTS_HK"

    FROM hashed_columns
)

SELECT * FROM columns_to_select
  );
12:19:32.144853 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.51 seconds
12:19:32.147495 [debug] [Thread-3  ]: finished collecting timing info
12:19:32.147821 [debug] [Thread-3  ]: On model.HackdayVault.facebook_accounts_staging_hashed: Close
12:19:32.445278 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42843b01-0bb6-4f4b-b830-08d739bf5fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1661cc670>]}
12:19:32.446014 [info ] [Thread-3  ]: 2 of 2 OK created view model hackday.facebook_accounts_staging_hashed .......... [[32mSUCCESS 1[0m in 2.22s]
12:19:32.446604 [debug] [Thread-3  ]: Finished running node model.HackdayVault.facebook_accounts_staging_hashed
12:19:32.448326 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:19:32.449027 [info ] [MainThread]: 
12:19:32.449626 [info ] [MainThread]: Finished running 2 view models in 6.75s.
12:19:32.450006 [debug] [MainThread]: Connection 'master' was properly closed.
12:19:32.450094 [debug] [MainThread]: Connection 'model.HackdayVault.facebook_accounts_staging_raw' was properly closed.
12:19:32.450171 [debug] [MainThread]: Connection 'model.HackdayVault.facebook_accounts_staging_hashed' was properly closed.
12:19:32.487784 [info ] [MainThread]: 
12:19:32.488015 [info ] [MainThread]: [32mCompleted successfully[0m
12:19:32.488183 [info ] [MainThread]: 
12:19:32.488313 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
12:19:32.488494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1663f2d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1663f2f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1663f2d90>]}


============================== 2022-06-29 12:20:23.705057 | 01410a99-151a-4daa-b7f2-b208491eb3ee ==============================
12:20:23.705104 [info ] [MainThread]: Running with dbt=1.1.0
12:20:23.705736 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/adambekele/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['facebook_accounts_hub'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
12:20:23.705909 [debug] [MainThread]: Tracking: tracking
12:20:23.706211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12099a9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12099a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12099aca0>]}
12:20:23.823257 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
12:20:23.823408 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
12:20:23.823657 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.HackdayVault.facebook_ads_insights_staging_raw
- models.HackdayVault.facebook_accounts_staging_raw

12:20:23.827226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01410a99-151a-4daa-b7f2-b208491eb3ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d2a0d0>]}
12:20:23.868565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01410a99-151a-4daa-b7f2-b208491eb3ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120982070>]}
12:20:23.868802 [info ] [MainThread]: Found 6 models, 9 tests, 0 snapshots, 0 analyses, 545 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
12:20:23.868997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01410a99-151a-4daa-b7f2-b208491eb3ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1209821c0>]}
12:20:23.869273 [warn ] [MainThread]: The selection criterion 'facebook_accounts_hub' does not match any nodes
12:20:23.869864 [info ] [MainThread]: 
12:20:23.870044 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
12:20:23.910809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12096d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12096da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12096daf0>]}


============================== 2022-06-29 12:21:03.239334 | 50fc64d6-26d4-4f16-b7e5-dd70fa5adcea ==============================
12:21:03.239352 [info ] [MainThread]: Running with dbt=1.1.0
12:21:03.239863 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/adambekele/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['facebook_accounts_hub'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
12:21:03.240006 [debug] [MainThread]: Tracking: tracking
12:21:03.240233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e500a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e500eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e500400>]}
12:21:03.364536 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
12:21:03.364680 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
12:21:03.364924 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.HackdayVault.facebook_ads_insights_staging_raw
- models.HackdayVault.facebook_accounts_staging_raw

12:21:03.368605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50fc64d6-26d4-4f16-b7e5-dd70fa5adcea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e77f0d0>]}
12:21:03.409967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50fc64d6-26d4-4f16-b7e5-dd70fa5adcea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e4ed220>]}
12:21:03.410198 [info ] [MainThread]: Found 6 models, 9 tests, 0 snapshots, 0 analyses, 545 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
12:21:03.410366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50fc64d6-26d4-4f16-b7e5-dd70fa5adcea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e4ed130>]}
12:21:03.410625 [warn ] [MainThread]: The selection criterion 'facebook_accounts_hub' does not match any nodes
12:21:03.411184 [info ] [MainThread]: 
12:21:03.411354 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
12:21:03.450611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e4ed100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e4e0850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e4e0970>]}


============================== 2022-06-29 12:21:38.035871 | 952d5e2d-fc7d-4e33-9a9f-578d57fe2ec2 ==============================
12:21:38.035896 [info ] [MainThread]: Running with dbt=1.1.0
12:21:38.036503 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/adambekele/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['facebook_accounts_hub'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
12:21:38.036657 [debug] [MainThread]: Tracking: tracking
12:21:38.036917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bd28fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bd289a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bd4efa0>]}
12:21:38.153050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
12:21:38.153193 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
12:21:38.153430 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.HackdayVault.facebook_accounts_staging_raw
- models.HackdayVault.facebook_ads_insights_staging_raw

12:21:38.157074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '952d5e2d-fc7d-4e33-9a9f-578d57fe2ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bf9f0d0>]}
12:21:38.201218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '952d5e2d-fc7d-4e33-9a9f-578d57fe2ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bd01340>]}
12:21:38.201468 [info ] [MainThread]: Found 6 models, 9 tests, 0 snapshots, 0 analyses, 545 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
12:21:38.201661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '952d5e2d-fc7d-4e33-9a9f-578d57fe2ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bd010d0>]}
12:21:38.201948 [warn ] [MainThread]: The selection criterion 'facebook_accounts_hub' does not match any nodes
12:21:38.202541 [info ] [MainThread]: 
12:21:38.202732 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
12:21:38.242129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bd01040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bd01250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bd00a60>]}


============================== 2022-06-29 12:22:40.921344 | 87d54bf8-f4f4-478c-b80e-3e9d475cc5d8 ==============================
12:22:40.921363 [info ] [MainThread]: Running with dbt=1.1.0
12:22:40.921948 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/adambekele/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['facebook_accounts_hub'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
12:22:40.922109 [debug] [MainThread]: Tracking: tracking
12:22:40.922380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a697b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a697550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a684d90>]}
12:22:41.047545 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
12:22:41.047684 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
12:22:41.047941 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.HackdayVault.facebook_accounts_staging_raw
- models.HackdayVault.facebook_ads_insights_staging_raw

12:22:41.051573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87d54bf8-f4f4-478c-b80e-3e9d475cc5d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a909fd0>]}
12:22:41.092132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87d54bf8-f4f4-478c-b80e-3e9d475cc5d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a66f5b0>]}
12:22:41.092366 [info ] [MainThread]: Found 6 models, 9 tests, 0 snapshots, 0 analyses, 545 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
12:22:41.092540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87d54bf8-f4f4-478c-b80e-3e9d475cc5d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a66f340>]}
12:22:41.092806 [warn ] [MainThread]: The selection criterion 'facebook_accounts_hub' does not match any nodes
12:22:41.093368 [info ] [MainThread]: 
12:22:41.093536 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
12:22:41.133080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a66f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a66f040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a66f1c0>]}


============================== 2022-06-29 12:23:33.506242 | 0743a077-d666-4402-914f-271c81bd1a9e ==============================
12:23:33.506289 [info ] [MainThread]: Running with dbt=1.1.0
12:23:33.506873 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/adambekele/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['facebook_accounts_hub'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
12:23:33.507030 [debug] [MainThread]: Tracking: tracking
12:23:33.507324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065cd2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065cd5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065cd400>]}
12:23:33.617400 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
12:23:33.617554 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
12:23:33.617795 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.HackdayVault.facebook_ads_insights_staging_raw
- models.HackdayVault.facebook_accounts_staging_raw

12:23:33.621364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0743a077-d666-4402-914f-271c81bd1a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13332cf70>]}
12:23:33.659953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0743a077-d666-4402-914f-271c81bd1a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132f6f490>]}
12:23:33.660211 [info ] [MainThread]: Found 6 models, 9 tests, 0 snapshots, 0 analyses, 545 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
12:23:33.660399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0743a077-d666-4402-914f-271c81bd1a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132f6f3d0>]}
12:23:33.660676 [warn ] [MainThread]: The selection criterion 'facebook_accounts_hub' does not match any nodes
12:23:33.661238 [info ] [MainThread]: 
12:23:33.661408 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
12:23:33.705118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132f6f070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132f6f370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132f6f2b0>]}


============================== 2022-06-29 12:24:11.330450 | 5e636b93-9b6c-4bc3-a3e0-595c26fea5ba ==============================
12:24:11.330499 [info ] [MainThread]: Running with dbt=1.1.0
12:24:11.331268 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/adambekele/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
12:24:11.331841 [debug] [MainThread]: Tracking: tracking
12:24:11.332196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f743790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f743940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f730dc0>]}
12:24:11.431429 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
12:24:11.431574 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
12:24:11.431821 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.HackdayVault.facebook_ads_insights_staging_raw
- models.HackdayVault.facebook_accounts_staging_raw

12:24:11.435560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e636b93-9b6c-4bc3-a3e0-595c26fea5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f9b5f40>]}
12:24:11.498353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e636b93-9b6c-4bc3-a3e0-595c26fea5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f71d4c0>]}
12:24:11.498639 [info ] [MainThread]: Found 6 models, 9 tests, 0 snapshots, 0 analyses, 545 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
12:24:11.498804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e636b93-9b6c-4bc3-a3e0-595c26fea5ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f71d370>]}
12:24:11.499452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f71d580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f71d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f71d070>]}


============================== 2022-06-29 12:25:09.319880 | 57ac2be1-1123-4abc-b5b1-c4a8d44f9787 ==============================
12:25:09.319902 [info ] [MainThread]: Running with dbt=1.1.0
12:25:09.321107 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/adambekele/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
12:25:09.321288 [debug] [MainThread]: Tracking: tracking
12:25:09.321516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1601c39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10655d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10652ee80>]}
12:25:09.434609 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
12:25:09.434759 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
12:25:09.435019 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.HackdayVault.facebook_ads_insights_staging_raw
- models.HackdayVault.facebook_accounts_staging_raw

12:25:09.438766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57ac2be1-1123-4abc-b5b1-c4a8d44f9787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1605670d0>]}
12:25:09.482347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57ac2be1-1123-4abc-b5b1-c4a8d44f9787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16036d310>]}
12:25:09.482588 [info ] [MainThread]: Found 6 models, 9 tests, 0 snapshots, 0 analyses, 545 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
12:25:09.482777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57ac2be1-1123-4abc-b5b1-c4a8d44f9787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16036d1c0>]}
12:25:09.483818 [info ] [MainThread]: 
12:25:09.484118 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:25:09.484701 [debug] [ThreadPool]: Acquiring new snowflake connection "list_BLINKIST_DEV_hackday"
12:25:09.492191 [debug] [ThreadPool]: Using snowflake connection "list_BLINKIST_DEV_hackday"
12:25:09.492316 [debug] [ThreadPool]: On list_BLINKIST_DEV_hackday: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "connection_name": "list_BLINKIST_DEV_hackday"} */

    show terse objects in BLINKIST_DEV.hackday
12:25:09.492409 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:25:10.743931 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.25 seconds
12:25:10.748443 [debug] [ThreadPool]: On list_BLINKIST_DEV_hackday: Close
12:25:11.041371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57ac2be1-1123-4abc-b5b1-c4a8d44f9787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160183fa0>]}
12:25:11.042665 [info ] [MainThread]: Concurrency: 4 threads (target='hackday')
12:25:11.043142 [info ] [MainThread]: 
12:25:11.051852 [debug] [Thread-1  ]: Began running node model.HackdayVault.facebook_accounts_staging_raw
12:25:11.052130 [debug] [Thread-2  ]: Began running node model.HackdayVault.facebook_ads_insights_staging_raw
12:25:11.052364 [debug] [Thread-3  ]: Began running node model.HackdayVault.my_first_dbt_model
12:25:11.052572 [debug] [Thread-4  ]: Began running node test.HackdayVault.source_not_null_fivetran_facebook_ads_account_history__fivetran_id.7e933b3975
12:25:11.053108 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.HackdayVault.facebook_accounts_staging_raw"
12:25:11.053714 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.HackdayVault.facebook_ads_insights_staging_raw"
12:25:11.054115 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.HackdayVault.my_first_dbt_model"
12:25:11.054500 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.HackdayVault.source_not_null_fivetran_facebook_ads_account_history__fivetran_id.7e933b3975"
12:25:11.054745 [debug] [Thread-1  ]: Began compiling node model.HackdayVault.facebook_accounts_staging_raw
12:25:11.054962 [debug] [Thread-2  ]: Began compiling node model.HackdayVault.facebook_ads_insights_staging_raw
12:25:11.055171 [debug] [Thread-3  ]: Began compiling node model.HackdayVault.my_first_dbt_model
12:25:11.055374 [debug] [Thread-4  ]: Began compiling node test.HackdayVault.source_not_null_fivetran_facebook_ads_account_history__fivetran_id.7e933b3975
12:25:11.055590 [debug] [Thread-1  ]: Compiling model.HackdayVault.facebook_accounts_staging_raw
12:25:11.055791 [debug] [Thread-2  ]: Compiling model.HackdayVault.facebook_ads_insights_staging_raw
12:25:11.056068 [debug] [Thread-3  ]: Compiling model.HackdayVault.my_first_dbt_model
12:25:11.056288 [debug] [Thread-4  ]: Compiling test.HackdayVault.source_not_null_fivetran_facebook_ads_account_history__fivetran_id.7e933b3975
12:25:11.059908 [debug] [Thread-1  ]: Writing injected SQL for node "model.HackdayVault.facebook_accounts_staging_raw"
12:25:11.063075 [debug] [Thread-2  ]: Writing injected SQL for node "model.HackdayVault.facebook_ads_insights_staging_raw"
12:25:11.066079 [debug] [Thread-3  ]: Writing injected SQL for node "model.HackdayVault.my_first_dbt_model"
12:25:11.079480 [debug] [Thread-4  ]: Writing injected SQL for node "test.HackdayVault.source_not_null_fivetran_facebook_ads_account_history__fivetran_id.7e933b3975"
12:25:11.080956 [debug] [Thread-4  ]: finished collecting timing info
12:25:11.081129 [debug] [Thread-3  ]: finished collecting timing info
12:25:11.081488 [debug] [Thread-4  ]: Began executing node test.HackdayVault.source_not_null_fivetran_facebook_ads_account_history__fivetran_id.7e933b3975
12:25:11.081612 [debug] [Thread-2  ]: finished collecting timing info
12:25:11.081788 [debug] [Thread-3  ]: Began executing node model.HackdayVault.my_first_dbt_model
12:25:11.081970 [debug] [Thread-4  ]: finished collecting timing info
12:25:11.082131 [debug] [Thread-2  ]: Began executing node model.HackdayVault.facebook_ads_insights_staging_raw
12:25:11.082297 [debug] [Thread-3  ]: finished collecting timing info
12:25:11.082740 [debug] [Thread-4  ]: Finished running node test.HackdayVault.source_not_null_fivetran_facebook_ads_account_history__fivetran_id.7e933b3975
12:25:11.082909 [debug] [Thread-2  ]: finished collecting timing info
12:25:11.083249 [debug] [Thread-3  ]: Finished running node model.HackdayVault.my_first_dbt_model
12:25:11.083446 [debug] [Thread-4  ]: Began running node test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_ad_id.75b5b8e4ad
12:25:11.083841 [debug] [Thread-2  ]: Finished running node model.HackdayVault.facebook_ads_insights_staging_raw
12:25:11.084022 [debug] [Thread-3  ]: Began running node test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_country.90398cd374
12:25:11.084451 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_ad_id.75b5b8e4ad"
12:25:11.084640 [debug] [Thread-2  ]: Began running node test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_date.a05f86e494
12:25:11.084987 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_country.90398cd374"
12:25:11.085143 [debug] [Thread-4  ]: Began compiling node test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_ad_id.75b5b8e4ad
12:25:11.085381 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_date.a05f86e494"
12:25:11.085529 [debug] [Thread-3  ]: Began compiling node test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_country.90398cd374
12:25:11.085676 [debug] [Thread-4  ]: Compiling test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_ad_id.75b5b8e4ad
12:25:11.085823 [debug] [Thread-2  ]: Began compiling node test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_date.a05f86e494
12:25:11.085958 [debug] [Thread-3  ]: Compiling test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_country.90398cd374
12:25:11.090195 [debug] [Thread-4  ]: Writing injected SQL for node "test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_ad_id.75b5b8e4ad"
12:25:11.090539 [debug] [Thread-2  ]: Compiling test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_date.a05f86e494
12:25:11.095079 [debug] [Thread-3  ]: Writing injected SQL for node "test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_country.90398cd374"
12:25:11.095263 [debug] [Thread-1  ]: finished collecting timing info
12:25:11.098529 [debug] [Thread-2  ]: Writing injected SQL for node "test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_date.a05f86e494"
12:25:11.098805 [debug] [Thread-1  ]: Began executing node model.HackdayVault.facebook_accounts_staging_raw
12:25:11.098903 [debug] [Thread-4  ]: finished collecting timing info
12:25:11.099088 [debug] [Thread-3  ]: finished collecting timing info
12:25:11.099203 [debug] [Thread-1  ]: finished collecting timing info
12:25:11.099340 [debug] [Thread-4  ]: Began executing node test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_ad_id.75b5b8e4ad
12:25:11.099442 [debug] [Thread-2  ]: finished collecting timing info
12:25:11.099532 [debug] [Thread-3  ]: Began executing node test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_country.90398cd374
12:25:11.099849 [debug] [Thread-1  ]: Finished running node model.HackdayVault.facebook_accounts_staging_raw
12:25:11.099971 [debug] [Thread-4  ]: finished collecting timing info
12:25:11.100079 [debug] [Thread-2  ]: Began executing node test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_date.a05f86e494
12:25:11.100183 [debug] [Thread-3  ]: finished collecting timing info
12:25:11.100311 [debug] [Thread-1  ]: Began running node test.HackdayVault.source_unique_fivetran_facebook_ads_account_history__fivetran_id.9906b22233
12:25:11.100693 [debug] [Thread-4  ]: Finished running node test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_ad_id.75b5b8e4ad
12:25:11.100828 [debug] [Thread-2  ]: finished collecting timing info
12:25:11.101098 [debug] [Thread-3  ]: Finished running node test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_country.90398cd374
12:25:11.101315 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.HackdayVault.source_unique_fivetran_facebook_ads_account_history__fivetran_id.9906b22233"
12:25:11.101465 [debug] [Thread-4  ]: Began running node model.HackdayVault.my_second_dbt_model
12:25:11.101755 [debug] [Thread-2  ]: Finished running node test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_date.a05f86e494
12:25:11.101889 [debug] [Thread-3  ]: Began running node test.HackdayVault.not_null_my_first_dbt_model_id.5fb22c2710
12:25:11.102038 [debug] [Thread-1  ]: Began compiling node test.HackdayVault.source_unique_fivetran_facebook_ads_account_history__fivetran_id.9906b22233
12:25:11.102260 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.HackdayVault.my_second_dbt_model"
12:25:11.102885 [debug] [Thread-4  ]: Began compiling node model.HackdayVault.my_second_dbt_model
12:25:11.102647 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.HackdayVault.not_null_my_first_dbt_model_id.5fb22c2710"
12:25:11.102772 [debug] [Thread-1  ]: Compiling test.HackdayVault.source_unique_fivetran_facebook_ads_account_history__fivetran_id.9906b22233
12:25:11.102417 [debug] [Thread-2  ]: Began running node test.HackdayVault.unique_my_first_dbt_model_id.16e066b321
12:25:11.103079 [debug] [Thread-4  ]: Compiling model.HackdayVault.my_second_dbt_model
12:25:11.103201 [debug] [Thread-3  ]: Began compiling node test.HackdayVault.not_null_my_first_dbt_model_id.5fb22c2710
12:25:11.108186 [debug] [Thread-1  ]: Writing injected SQL for node "test.HackdayVault.source_unique_fivetran_facebook_ads_account_history__fivetran_id.9906b22233"
12:25:11.108451 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.HackdayVault.unique_my_first_dbt_model_id.16e066b321"
12:25:11.110116 [debug] [Thread-4  ]: Writing injected SQL for node "model.HackdayVault.my_second_dbt_model"
12:25:11.110244 [debug] [Thread-3  ]: Compiling test.HackdayVault.not_null_my_first_dbt_model_id.5fb22c2710
12:25:11.110435 [debug] [Thread-2  ]: Began compiling node test.HackdayVault.unique_my_first_dbt_model_id.16e066b321
12:25:11.113077 [debug] [Thread-3  ]: Writing injected SQL for node "test.HackdayVault.not_null_my_first_dbt_model_id.5fb22c2710"
12:25:11.113187 [debug] [Thread-1  ]: finished collecting timing info
12:25:11.113333 [debug] [Thread-2  ]: Compiling test.HackdayVault.unique_my_first_dbt_model_id.16e066b321
12:25:11.113462 [debug] [Thread-4  ]: finished collecting timing info
12:25:11.113577 [debug] [Thread-1  ]: Began executing node test.HackdayVault.source_unique_fivetran_facebook_ads_account_history__fivetran_id.9906b22233
12:25:11.116034 [debug] [Thread-2  ]: Writing injected SQL for node "test.HackdayVault.unique_my_first_dbt_model_id.16e066b321"
12:25:11.116219 [debug] [Thread-4  ]: Began executing node model.HackdayVault.my_second_dbt_model
12:25:11.116311 [debug] [Thread-3  ]: finished collecting timing info
12:25:11.116457 [debug] [Thread-1  ]: finished collecting timing info
12:25:11.116614 [debug] [Thread-4  ]: finished collecting timing info
12:25:11.116717 [debug] [Thread-3  ]: Began executing node test.HackdayVault.not_null_my_first_dbt_model_id.5fb22c2710
12:25:11.117018 [debug] [Thread-1  ]: Finished running node test.HackdayVault.source_unique_fivetran_facebook_ads_account_history__fivetran_id.9906b22233
12:25:11.117126 [debug] [Thread-2  ]: finished collecting timing info
12:25:11.117321 [debug] [Thread-4  ]: Finished running node model.HackdayVault.my_second_dbt_model
12:25:11.117431 [debug] [Thread-3  ]: finished collecting timing info
12:25:11.117550 [debug] [Thread-1  ]: Began running node model.HackdayVault.facebook_ads_insights_staging_hashed
12:25:11.117695 [debug] [Thread-2  ]: Began executing node test.HackdayVault.unique_my_first_dbt_model_id.16e066b321
12:25:11.118033 [debug] [Thread-4  ]: Began running node model.HackdayVault.facebook_accounts_staging_hashed
12:25:11.118320 [debug] [Thread-3  ]: Finished running node test.HackdayVault.not_null_my_first_dbt_model_id.5fb22c2710
12:25:11.119333 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.HackdayVault.facebook_ads_insights_staging_hashed"
12:25:11.119444 [debug] [Thread-2  ]: finished collecting timing info
12:25:11.119594 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
12:25:11.119700 [debug] [Thread-3  ]: Began running node test.HackdayVault.not_null_my_second_dbt_model_id.151b76d778
12:25:11.119822 [debug] [Thread-1  ]: Began compiling node model.HackdayVault.facebook_ads_insights_staging_hashed
12:25:11.120019 [debug] [Thread-2  ]: Finished running node test.HackdayVault.unique_my_first_dbt_model_id.16e066b321
12:25:11.120113 [debug] [Thread-4  ]: Began compiling node model.HackdayVault.facebook_accounts_staging_hashed
12:25:11.120259 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.HackdayVault.not_null_my_second_dbt_model_id.151b76d778"
12:25:11.120350 [debug] [Thread-1  ]: Compiling model.HackdayVault.facebook_ads_insights_staging_hashed
12:25:11.120450 [debug] [Thread-2  ]: Began running node test.HackdayVault.unique_my_second_dbt_model_id.57a0f8c493
12:25:11.120554 [debug] [Thread-4  ]: Compiling model.HackdayVault.facebook_accounts_staging_hashed
12:25:11.120637 [debug] [Thread-3  ]: Began compiling node test.HackdayVault.not_null_my_second_dbt_model_id.151b76d778
12:25:11.138558 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.HackdayVault.unique_my_second_dbt_model_id.57a0f8c493"
12:25:11.141032 [debug] [Thread-1  ]: Using snowflake connection "model.HackdayVault.facebook_ads_insights_staging_hashed"
12:25:11.145238 [debug] [Thread-4  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
12:25:11.145373 [debug] [Thread-3  ]: Compiling test.HackdayVault.not_null_my_second_dbt_model_id.151b76d778
12:25:11.145467 [debug] [Thread-2  ]: Began compiling node test.HackdayVault.unique_my_second_dbt_model_id.57a0f8c493
12:25:11.145547 [debug] [Thread-1  ]: On model.HackdayVault.facebook_ads_insights_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_ads_insights_staging_hashed"} */

    describe table BLINKIST_DEV.hackday.facebook_ads_insights_staging_raw
12:25:11.145648 [debug] [Thread-4  ]: On model.HackdayVault.facebook_accounts_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_staging_hashed"} */

    describe table BLINKIST_DEV.hackday.facebook_accounts_staging_raw
12:25:11.148057 [debug] [Thread-3  ]: Writing injected SQL for node "test.HackdayVault.not_null_my_second_dbt_model_id.151b76d778"
12:25:11.148156 [debug] [Thread-2  ]: Compiling test.HackdayVault.unique_my_second_dbt_model_id.57a0f8c493
12:25:11.148236 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:25:11.148314 [debug] [Thread-4  ]: Opening a new connection, currently in state init
12:25:11.150244 [debug] [Thread-2  ]: Writing injected SQL for node "test.HackdayVault.unique_my_second_dbt_model_id.57a0f8c493"
12:25:11.152055 [debug] [Thread-3  ]: finished collecting timing info
12:25:11.154243 [debug] [Thread-3  ]: Began executing node test.HackdayVault.not_null_my_second_dbt_model_id.151b76d778
12:25:11.154407 [debug] [Thread-3  ]: finished collecting timing info
12:25:11.154640 [debug] [Thread-3  ]: Finished running node test.HackdayVault.not_null_my_second_dbt_model_id.151b76d778
12:25:11.154713 [debug] [Thread-2  ]: finished collecting timing info
12:25:11.172880 [debug] [Thread-2  ]: Began executing node test.HackdayVault.unique_my_second_dbt_model_id.57a0f8c493
12:25:11.173576 [debug] [Thread-2  ]: finished collecting timing info
12:25:11.173881 [debug] [Thread-2  ]: Finished running node test.HackdayVault.unique_my_second_dbt_model_id.57a0f8c493
12:25:12.182467 [debug] [Thread-4  ]: SQL status: SUCCESS 83 in 1.03 seconds
12:25:12.281584 [debug] [Thread-1  ]: SQL status: SUCCESS 35 in 1.13 seconds
12:25:12.299101 [debug] [Thread-4  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
12:25:12.299637 [debug] [Thread-4  ]: On model.HackdayVault.facebook_accounts_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_staging_hashed"} */

    describe table BLINKIST_DEV.hackday.facebook_accounts_staging_raw
12:25:12.315966 [debug] [Thread-1  ]: Using snowflake connection "model.HackdayVault.facebook_ads_insights_staging_hashed"
12:25:12.316062 [debug] [Thread-1  ]: On model.HackdayVault.facebook_ads_insights_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_ads_insights_staging_hashed"} */

    describe table BLINKIST_DEV.hackday.facebook_ads_insights_staging_raw
12:25:12.491794 [debug] [Thread-1  ]: SQL status: SUCCESS 35 in 0.18 seconds
12:25:12.493366 [debug] [Thread-4  ]: SQL status: SUCCESS 83 in 0.19 seconds
12:25:12.612930 [debug] [Thread-1  ]: Writing injected SQL for node "model.HackdayVault.facebook_ads_insights_staging_hashed"
12:25:12.627353 [debug] [Thread-1  ]: finished collecting timing info
12:25:12.628684 [debug] [Thread-1  ]: Began executing node model.HackdayVault.facebook_ads_insights_staging_hashed
12:25:12.628782 [debug] [Thread-1  ]: finished collecting timing info
12:25:12.638875 [debug] [Thread-1  ]: On model.HackdayVault.facebook_ads_insights_staging_hashed: Close
12:25:12.646040 [debug] [Thread-4  ]: Writing injected SQL for node "model.HackdayVault.facebook_accounts_staging_hashed"
12:25:12.647873 [debug] [Thread-4  ]: finished collecting timing info
12:25:12.647973 [debug] [Thread-4  ]: Began executing node model.HackdayVault.facebook_accounts_staging_hashed
12:25:12.648055 [debug] [Thread-4  ]: finished collecting timing info
12:25:12.648132 [debug] [Thread-4  ]: On model.HackdayVault.facebook_accounts_staging_hashed: Close
12:25:12.939024 [debug] [Thread-4  ]: Finished running node model.HackdayVault.facebook_accounts_staging_hashed
12:25:12.970591 [debug] [Thread-1  ]: Finished running node model.HackdayVault.facebook_ads_insights_staging_hashed
12:25:12.972114 [debug] [MainThread]: Connection 'master' was properly closed.
12:25:12.972562 [debug] [MainThread]: Connection 'model.HackdayVault.facebook_ads_insights_staging_hashed' was properly closed.
12:25:12.972796 [debug] [MainThread]: Connection 'test.HackdayVault.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
12:25:12.973010 [debug] [MainThread]: Connection 'test.HackdayVault.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
12:25:12.973213 [debug] [MainThread]: Connection 'model.HackdayVault.facebook_accounts_staging_hashed' was properly closed.
12:25:13.063760 [info ] [MainThread]: Done.
12:25:13.066922 [debug] [MainThread]: Acquiring new snowflake connection "generate_catalog"
12:25:13.067134 [info ] [MainThread]: Building catalog
12:25:13.068504 [debug] [ThreadPool]: Acquiring new snowflake connection "BLINKIST_DEV.information_schema"
12:25:13.068800 [debug] [ThreadPool]: Acquiring new snowflake connection "FIVETRAN_DATABASE.information_schema"
12:25:13.076172 [debug] [ThreadPool]: Using snowflake connection "BLINKIST_DEV.information_schema"
12:25:13.078409 [debug] [ThreadPool]: Using snowflake connection "FIVETRAN_DATABASE.information_schema"
12:25:13.078519 [debug] [ThreadPool]: On BLINKIST_DEV.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "connection_name": "BLINKIST_DEV.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from BLINKIST_DEV.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from BLINKIST_DEV.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('hackday'))
      order by "column_index"
12:25:13.078601 [debug] [ThreadPool]: On FIVETRAN_DATABASE.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "connection_name": "FIVETRAN_DATABASE.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from FIVETRAN_DATABASE.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from FIVETRAN_DATABASE.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('facebook') or upper("table_schema") = upper('facebook_ads'))
      order by "column_index"
12:25:13.078687 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:25:13.078766 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:25:16.668955 [debug] [ThreadPool]: SQL status: SUCCESS 263 in 3.59 seconds
12:25:17.405822 [debug] [ThreadPool]: On FIVETRAN_DATABASE.information_schema: Close
12:25:17.958762 [debug] [ThreadPool]: SQL status: SUCCESS 247 in 4.88 seconds
12:25:18.652166 [debug] [ThreadPool]: On BLINKIST_DEV.information_schema: Close
12:25:19.087717 [info ] [MainThread]: Catalog written to /Users/adambekele/github/HackdayDataVault/target/catalog.json
12:25:19.088439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1601c39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164d351f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164d35190>]}
12:25:19.588267 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
12:25:19.588852 [debug] [MainThread]: Connection 'BLINKIST_DEV.information_schema' was properly closed.
12:25:19.589067 [debug] [MainThread]: Connection 'FIVETRAN_DATABASE.information_schema' was properly closed.


============================== 2022-06-29 12:25:28.527615 | 2af5646e-4fd0-4111-ae7e-504ac70f1873 ==============================
12:25:28.527638 [info ] [MainThread]: Running with dbt=1.1.0
12:25:28.528169 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/adambekele/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['facebook_accounts_hub'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
12:25:28.528307 [debug] [MainThread]: Tracking: tracking
12:25:28.528559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123526a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123526340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123526f40>]}
12:25:28.634410 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
12:25:28.634559 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
12:25:28.634821 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.HackdayVault.facebook_accounts_staging_raw
- models.HackdayVault.facebook_ads_insights_staging_raw

12:25:28.638480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2af5646e-4fd0-4111-ae7e-504ac70f1873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12377bee0>]}
12:25:28.677183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2af5646e-4fd0-4111-ae7e-504ac70f1873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236b63a0>]}
12:25:28.677413 [info ] [MainThread]: Found 6 models, 9 tests, 0 snapshots, 0 analyses, 545 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
12:25:28.677589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2af5646e-4fd0-4111-ae7e-504ac70f1873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236b6250>]}
12:25:28.677861 [warn ] [MainThread]: The selection criterion 'facebook_accounts_hub' does not match any nodes
12:25:28.678421 [info ] [MainThread]: 
12:25:28.678594 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
12:25:28.715274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236b6190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236b60d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236b62b0>]}


============================== 2022-06-29 12:26:47.368368 | 6352c481-09f5-48f7-ad9e-4b167b79a7d1 ==============================
12:26:47.368395 [info ] [MainThread]: Running with dbt=1.1.0
12:26:47.369150 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/adambekele/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['facebook_accounts_staging_raw+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
12:26:47.369441 [debug] [MainThread]: Tracking: tracking
12:26:47.369868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137f510d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137f51e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137f518b0>]}
12:26:47.480795 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
12:26:47.480939 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
12:26:47.481188 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.HackdayVault.facebook_accounts_staging_raw
- models.HackdayVault.facebook_ads_insights_staging_raw

12:26:47.484775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6352c481-09f5-48f7-ad9e-4b167b79a7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1621e70d0>]}
12:26:47.530197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6352c481-09f5-48f7-ad9e-4b167b79a7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16211d0d0>]}
12:26:47.530466 [info ] [MainThread]: Found 6 models, 9 tests, 0 snapshots, 0 analyses, 545 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
12:26:47.530667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6352c481-09f5-48f7-ad9e-4b167b79a7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16211d0a0>]}
12:26:47.531485 [info ] [MainThread]: 
12:26:47.531797 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:26:47.532325 [debug] [ThreadPool]: Acquiring new snowflake connection "list_BLINKIST_DEV"
12:26:47.540077 [debug] [ThreadPool]: Using snowflake connection "list_BLINKIST_DEV"
12:26:47.540211 [debug] [ThreadPool]: On list_BLINKIST_DEV: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "connection_name": "list_BLINKIST_DEV"} */

    show terse schemas in database BLINKIST_DEV
    limit 10000
12:26:47.540304 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:26:48.817333 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.28 seconds
12:26:48.820065 [debug] [ThreadPool]: On list_BLINKIST_DEV: Close
12:26:49.137103 [debug] [ThreadPool]: Acquiring new snowflake connection "list_BLINKIST_DEV_hackday"
12:26:49.149110 [debug] [ThreadPool]: Using snowflake connection "list_BLINKIST_DEV_hackday"
12:26:49.149386 [debug] [ThreadPool]: On list_BLINKIST_DEV_hackday: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "connection_name": "list_BLINKIST_DEV_hackday"} */

    show terse objects in BLINKIST_DEV.hackday
12:26:49.149594 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:26:50.338063 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.19 seconds
12:26:50.342510 [debug] [ThreadPool]: On list_BLINKIST_DEV_hackday: Close
12:26:50.637628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6352c481-09f5-48f7-ad9e-4b167b79a7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101aedf0>]}
12:26:50.638596 [info ] [MainThread]: Concurrency: 4 threads (target='hackday')
12:26:50.639171 [info ] [MainThread]: 
12:26:50.645952 [debug] [Thread-1  ]: Began running node model.HackdayVault.facebook_accounts_staging_raw
12:26:50.646409 [info ] [Thread-1  ]: 1 of 2 START view model hackday.facebook_accounts_staging_raw .................. [RUN]
12:26:50.647060 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.HackdayVault.facebook_accounts_staging_raw"
12:26:50.647305 [debug] [Thread-1  ]: Began compiling node model.HackdayVault.facebook_accounts_staging_raw
12:26:50.647540 [debug] [Thread-1  ]: Compiling model.HackdayVault.facebook_accounts_staging_raw
12:26:50.651844 [debug] [Thread-1  ]: Writing injected SQL for node "model.HackdayVault.facebook_accounts_staging_raw"
12:26:50.656403 [debug] [Thread-1  ]: finished collecting timing info
12:26:50.656761 [debug] [Thread-1  ]: Began executing node model.HackdayVault.facebook_accounts_staging_raw
12:26:50.682000 [debug] [Thread-1  ]: Writing runtime SQL for node "model.HackdayVault.facebook_accounts_staging_raw"
12:26:50.686039 [debug] [Thread-1  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_staging_raw"
12:26:50.686286 [debug] [Thread-1  ]: On model.HackdayVault.facebook_accounts_staging_raw: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_staging_raw"} */

  create or replace  view BLINKIST_DEV.hackday.facebook_accounts_staging_raw
  
   as (
    SELECT
    *
FROM FIVETRAN_DATABASE.facebook_ads.account_history
  );
12:26:50.686419 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:26:51.897742 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.21 seconds
12:26:51.910525 [debug] [Thread-1  ]: finished collecting timing info
12:26:51.910962 [debug] [Thread-1  ]: On model.HackdayVault.facebook_accounts_staging_raw: Close
12:26:52.201158 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6352c481-09f5-48f7-ad9e-4b167b79a7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1624283a0>]}
12:26:52.202295 [info ] [Thread-1  ]: 1 of 2 OK created view model hackday.facebook_accounts_staging_raw ............. [[32mSUCCESS 1[0m in 1.55s]
12:26:52.203251 [debug] [Thread-1  ]: Finished running node model.HackdayVault.facebook_accounts_staging_raw
12:26:52.204556 [debug] [Thread-3  ]: Began running node model.HackdayVault.facebook_accounts_staging_hashed
12:26:52.205379 [info ] [Thread-3  ]: 2 of 2 START view model hackday.facebook_accounts_staging_hashed ............... [RUN]
12:26:52.207079 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
12:26:52.207480 [debug] [Thread-3  ]: Began compiling node model.HackdayVault.facebook_accounts_staging_hashed
12:26:52.207739 [debug] [Thread-3  ]: Compiling model.HackdayVault.facebook_accounts_staging_hashed
12:26:52.249411 [debug] [Thread-3  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
12:26:52.249719 [debug] [Thread-3  ]: On model.HackdayVault.facebook_accounts_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_staging_hashed"} */

    describe table BLINKIST_DEV.hackday.facebook_accounts_staging_raw
12:26:52.249853 [debug] [Thread-3  ]: Opening a new connection, currently in state init
12:26:53.118519 [debug] [Thread-3  ]: SQL status: SUCCESS 83 in 0.87 seconds
12:26:53.231709 [debug] [Thread-3  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
12:26:53.232027 [debug] [Thread-3  ]: On model.HackdayVault.facebook_accounts_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_staging_hashed"} */

    describe table BLINKIST_DEV.hackday.facebook_accounts_staging_raw
12:26:53.410474 [debug] [Thread-3  ]: SQL status: SUCCESS 83 in 0.18 seconds
12:26:53.531036 [debug] [Thread-3  ]: Writing injected SQL for node "model.HackdayVault.facebook_accounts_staging_hashed"
12:26:53.532714 [debug] [Thread-3  ]: finished collecting timing info
12:26:53.532813 [debug] [Thread-3  ]: Began executing node model.HackdayVault.facebook_accounts_staging_hashed
12:26:53.534334 [debug] [Thread-3  ]: Writing runtime SQL for node "model.HackdayVault.facebook_accounts_staging_hashed"
12:26:53.544525 [debug] [Thread-3  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
12:26:53.544621 [debug] [Thread-3  ]: On model.HackdayVault.facebook_accounts_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_staging_hashed"} */

  create or replace  view BLINKIST_DEV.hackday.facebook_accounts_staging_hashed
  
   as (
    







-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    "_FIVETRAN_ID",
    "AGE",
    "AMOUNT_SPENT",
    "BALANCE",
    "BUSINESS_CITY",
    "BUSINESS_COUNTRY_CODE",
    "BUSINESS_NAME",
    "BUSINESS_STATE",
    "BUSINESS_STREET",
    "BUSINESS_STREET_2",
    "BUSINESS_ZIP",
    "CAN_CREATE_BRAND_LIFT_STUDY",
    "CREATED_TIME",
    "CURRENCY",
    "END_ADVERTISER",
    "END_ADVERTISER_NAME",
    "HAS_ADVERTISER_OPTED_IN_ODAX",
    "HAS_MIGRATED_PERMISSIONS",
    "IO_NUMBER",
    "IS_ATTRIBUTION_SPEC_SYSTEM_DEFAULT",
    "IS_DIRECT_DEALS_ENABLED",
    "IS_IN_3_DS_AUTHORIZATION_ENABLED_MARKET",
    "IS_NOTIFICATIONS_ENABLED",
    "IS_PERSONAL",
    "IS_PREPAY_ACCOUNT",
    "IS_TAX_ID_REQUIRED",
    "MEDIA_AGENCY",
    "MIN_CAMPAIGN_GROUP_SPEND_CAP",
    "MIN_DAILY_BUDGET",
    "NAME",
    "NEXT_BILL_DATE",
    "OFFSITE_PIXELS_TOS_ACCEPTED",
    "OWNER",
    "PARTNER",
    "SALESFORCE_INVOICE_GROUP_ID",
    "SPEND_CAP",
    "TAX_ID",
    "TAX_ID_TYPE",
    "TIMEZONE_ID",
    "TIMEZONE_NAME",
    "TIMEZONE_OFFSET_HOURS_UTC",
    "ACCOUNT_STATUS",
    "DISABLE_REASON",
    "TAX_ID_STATUS",
    "AGENCY_CLIENT_DECLARATION_AGENCY_REPRESENTING_CLIENT",
    "AGENCY_CLIENT_DECLARATION_CLIENT_BASED_IN_FRANCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_CITY",
    "AGENCY_CLIENT_DECLARATION_CLIENT_COUNTRY_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_EMAIL_ADDRESS",
    "AGENCY_CLIENT_DECLARATION_CLIENT_NAME",
    "AGENCY_CLIENT_DECLARATION_CLIENT_POSTAL_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_PROVINCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET_2",
    "AGENCY_CLIENT_DECLARATION_HAS_WRITTEN_MANDATE_FROM_ADVERTISER",
    "AGENCY_CLIENT_DECLARATION_IS_CLIENT_PAYING_INVOICES",
    "BUSINESS_MANAGER_BLOCK_OFFLINE_ANALYTICS",
    "BUSINESS_MANAGER_CREATED_BY",
    "BUSINESS_MANAGER_CREATED_TIME",
    "BUSINESS_MANAGER_EXTENDED_UPDATED_TIME",
    "BUSINESS_MANAGER_IS_HIDDEN",
    "BUSINESS_MANAGER_LINK",
    "BUSINESS_MANAGER_NAME",
    "BUSINESS_MANAGER_PAYMENT_ACCOUNT_ID",
    "BUSINESS_MANAGER_PRIMARY_PAGE",
    "BUSINESS_MANAGER_PROFILE_PICTURE_URI",
    "BUSINESS_MANAGER_TIMEZONE_ID",
    "BUSINESS_MANAGER_TWO_FACTOR_TYPE",
    "BUSINESS_MANAGER_UPDATED_BY",
    "BUSINESS_MANAGER_UPDATE_TIME",
    "BUSINESS_MANAGER_VERIFICATION_STATUS",
    "BUSINESS_MANAGER_VERTICAL",
    "BUSINESS_MANAGER_VERTICAL_ID",
    "BUSINESS_MANAGER_MANAGER_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_AUTO_ENROLL",
    "EXTENDED_CREDIT_INVOICE_GROUP_CUSTOMER_PO_NUMBER",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAIL",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAILS",
    "EXTENDED_CREDIT_INVOICE_GROUP_NAME",
    "CAPABILITIES",
    "ID",
    "_FIVETRAN_SYNCED"

    FROM BLINKIST_DEV.hackday.facebook_accounts_staging_raw
),

derived_columns AS (

    SELECT

    "_FIVETRAN_ID",
    "AGE",
    "AMOUNT_SPENT",
    "BALANCE",
    "BUSINESS_CITY",
    "BUSINESS_COUNTRY_CODE",
    "BUSINESS_NAME",
    "BUSINESS_STATE",
    "BUSINESS_STREET",
    "BUSINESS_STREET_2",
    "BUSINESS_ZIP",
    "CAN_CREATE_BRAND_LIFT_STUDY",
    "CREATED_TIME",
    "CURRENCY",
    "END_ADVERTISER",
    "END_ADVERTISER_NAME",
    "HAS_ADVERTISER_OPTED_IN_ODAX",
    "HAS_MIGRATED_PERMISSIONS",
    "IO_NUMBER",
    "IS_ATTRIBUTION_SPEC_SYSTEM_DEFAULT",
    "IS_DIRECT_DEALS_ENABLED",
    "IS_IN_3_DS_AUTHORIZATION_ENABLED_MARKET",
    "IS_NOTIFICATIONS_ENABLED",
    "IS_PERSONAL",
    "IS_PREPAY_ACCOUNT",
    "IS_TAX_ID_REQUIRED",
    "MEDIA_AGENCY",
    "MIN_CAMPAIGN_GROUP_SPEND_CAP",
    "MIN_DAILY_BUDGET",
    "NAME",
    "NEXT_BILL_DATE",
    "OFFSITE_PIXELS_TOS_ACCEPTED",
    "OWNER",
    "PARTNER",
    "SALESFORCE_INVOICE_GROUP_ID",
    "SPEND_CAP",
    "TAX_ID",
    "TAX_ID_TYPE",
    "TIMEZONE_ID",
    "TIMEZONE_NAME",
    "TIMEZONE_OFFSET_HOURS_UTC",
    "ACCOUNT_STATUS",
    "DISABLE_REASON",
    "TAX_ID_STATUS",
    "AGENCY_CLIENT_DECLARATION_AGENCY_REPRESENTING_CLIENT",
    "AGENCY_CLIENT_DECLARATION_CLIENT_BASED_IN_FRANCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_CITY",
    "AGENCY_CLIENT_DECLARATION_CLIENT_COUNTRY_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_EMAIL_ADDRESS",
    "AGENCY_CLIENT_DECLARATION_CLIENT_NAME",
    "AGENCY_CLIENT_DECLARATION_CLIENT_POSTAL_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_PROVINCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET_2",
    "AGENCY_CLIENT_DECLARATION_HAS_WRITTEN_MANDATE_FROM_ADVERTISER",
    "AGENCY_CLIENT_DECLARATION_IS_CLIENT_PAYING_INVOICES",
    "BUSINESS_MANAGER_BLOCK_OFFLINE_ANALYTICS",
    "BUSINESS_MANAGER_CREATED_BY",
    "BUSINESS_MANAGER_CREATED_TIME",
    "BUSINESS_MANAGER_EXTENDED_UPDATED_TIME",
    "BUSINESS_MANAGER_IS_HIDDEN",
    "BUSINESS_MANAGER_LINK",
    "BUSINESS_MANAGER_NAME",
    "BUSINESS_MANAGER_PAYMENT_ACCOUNT_ID",
    "BUSINESS_MANAGER_PRIMARY_PAGE",
    "BUSINESS_MANAGER_PROFILE_PICTURE_URI",
    "BUSINESS_MANAGER_TIMEZONE_ID",
    "BUSINESS_MANAGER_TWO_FACTOR_TYPE",
    "BUSINESS_MANAGER_UPDATED_BY",
    "BUSINESS_MANAGER_UPDATE_TIME",
    "BUSINESS_MANAGER_VERIFICATION_STATUS",
    "BUSINESS_MANAGER_VERTICAL",
    "BUSINESS_MANAGER_VERTICAL_ID",
    "BUSINESS_MANAGER_MANAGER_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_AUTO_ENROLL",
    "EXTENDED_CREDIT_INVOICE_GROUP_CUSTOMER_PO_NUMBER",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAIL",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAILS",
    "EXTENDED_CREDIT_INVOICE_GROUP_NAME",
    "CAPABILITIES",
    "ID",
    "_FIVETRAN_SYNCED",
    'FIVETRAN_FACEBOOK_ACCOUNTS_RAW' AS "RECORD_SOURCE",
    "CURRENCY" AS "CURRENCY_CODE",
    "ID" AS "ACCOUNT_ID"

    FROM source_data
),

hashed_columns AS (

    SELECT

    "_FIVETRAN_ID",
    "AGE",
    "AMOUNT_SPENT",
    "BALANCE",
    "BUSINESS_CITY",
    "BUSINESS_COUNTRY_CODE",
    "BUSINESS_NAME",
    "BUSINESS_STATE",
    "BUSINESS_STREET",
    "BUSINESS_STREET_2",
    "BUSINESS_ZIP",
    "CAN_CREATE_BRAND_LIFT_STUDY",
    "CREATED_TIME",
    "CURRENCY",
    "END_ADVERTISER",
    "END_ADVERTISER_NAME",
    "HAS_ADVERTISER_OPTED_IN_ODAX",
    "HAS_MIGRATED_PERMISSIONS",
    "IO_NUMBER",
    "IS_ATTRIBUTION_SPEC_SYSTEM_DEFAULT",
    "IS_DIRECT_DEALS_ENABLED",
    "IS_IN_3_DS_AUTHORIZATION_ENABLED_MARKET",
    "IS_NOTIFICATIONS_ENABLED",
    "IS_PERSONAL",
    "IS_PREPAY_ACCOUNT",
    "IS_TAX_ID_REQUIRED",
    "MEDIA_AGENCY",
    "MIN_CAMPAIGN_GROUP_SPEND_CAP",
    "MIN_DAILY_BUDGET",
    "NAME",
    "NEXT_BILL_DATE",
    "OFFSITE_PIXELS_TOS_ACCEPTED",
    "OWNER",
    "PARTNER",
    "SALESFORCE_INVOICE_GROUP_ID",
    "SPEND_CAP",
    "TAX_ID",
    "TAX_ID_TYPE",
    "TIMEZONE_ID",
    "TIMEZONE_NAME",
    "TIMEZONE_OFFSET_HOURS_UTC",
    "ACCOUNT_STATUS",
    "DISABLE_REASON",
    "TAX_ID_STATUS",
    "AGENCY_CLIENT_DECLARATION_AGENCY_REPRESENTING_CLIENT",
    "AGENCY_CLIENT_DECLARATION_CLIENT_BASED_IN_FRANCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_CITY",
    "AGENCY_CLIENT_DECLARATION_CLIENT_COUNTRY_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_EMAIL_ADDRESS",
    "AGENCY_CLIENT_DECLARATION_CLIENT_NAME",
    "AGENCY_CLIENT_DECLARATION_CLIENT_POSTAL_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_PROVINCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET_2",
    "AGENCY_CLIENT_DECLARATION_HAS_WRITTEN_MANDATE_FROM_ADVERTISER",
    "AGENCY_CLIENT_DECLARATION_IS_CLIENT_PAYING_INVOICES",
    "BUSINESS_MANAGER_BLOCK_OFFLINE_ANALYTICS",
    "BUSINESS_MANAGER_CREATED_BY",
    "BUSINESS_MANAGER_CREATED_TIME",
    "BUSINESS_MANAGER_EXTENDED_UPDATED_TIME",
    "BUSINESS_MANAGER_IS_HIDDEN",
    "BUSINESS_MANAGER_LINK",
    "BUSINESS_MANAGER_NAME",
    "BUSINESS_MANAGER_PAYMENT_ACCOUNT_ID",
    "BUSINESS_MANAGER_PRIMARY_PAGE",
    "BUSINESS_MANAGER_PROFILE_PICTURE_URI",
    "BUSINESS_MANAGER_TIMEZONE_ID",
    "BUSINESS_MANAGER_TWO_FACTOR_TYPE",
    "BUSINESS_MANAGER_UPDATED_BY",
    "BUSINESS_MANAGER_UPDATE_TIME",
    "BUSINESS_MANAGER_VERIFICATION_STATUS",
    "BUSINESS_MANAGER_VERTICAL",
    "BUSINESS_MANAGER_VERTICAL_ID",
    "BUSINESS_MANAGER_MANAGER_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_AUTO_ENROLL",
    "EXTENDED_CREDIT_INVOICE_GROUP_CUSTOMER_PO_NUMBER",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAIL",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAILS",
    "EXTENDED_CREDIT_INVOICE_GROUP_NAME",
    "CAPABILITIES",
    "ID",
    "_FIVETRAN_SYNCED",
    "RECORD_SOURCE",
    "CURRENCY_CODE",
    "ACCOUNT_ID",

    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("ACCOUNT_ID" AS VARCHAR))), ''), '^^')
    ), '^^')) AS BINARY(16)) AS "FACEBOOK_ACCOUNTS_HK"

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    "_FIVETRAN_ID",
    "AGE",
    "AMOUNT_SPENT",
    "BALANCE",
    "BUSINESS_CITY",
    "BUSINESS_COUNTRY_CODE",
    "BUSINESS_NAME",
    "BUSINESS_STATE",
    "BUSINESS_STREET",
    "BUSINESS_STREET_2",
    "BUSINESS_ZIP",
    "CAN_CREATE_BRAND_LIFT_STUDY",
    "CREATED_TIME",
    "CURRENCY",
    "END_ADVERTISER",
    "END_ADVERTISER_NAME",
    "HAS_ADVERTISER_OPTED_IN_ODAX",
    "HAS_MIGRATED_PERMISSIONS",
    "IO_NUMBER",
    "IS_ATTRIBUTION_SPEC_SYSTEM_DEFAULT",
    "IS_DIRECT_DEALS_ENABLED",
    "IS_IN_3_DS_AUTHORIZATION_ENABLED_MARKET",
    "IS_NOTIFICATIONS_ENABLED",
    "IS_PERSONAL",
    "IS_PREPAY_ACCOUNT",
    "IS_TAX_ID_REQUIRED",
    "MEDIA_AGENCY",
    "MIN_CAMPAIGN_GROUP_SPEND_CAP",
    "MIN_DAILY_BUDGET",
    "NAME",
    "NEXT_BILL_DATE",
    "OFFSITE_PIXELS_TOS_ACCEPTED",
    "OWNER",
    "PARTNER",
    "SALESFORCE_INVOICE_GROUP_ID",
    "SPEND_CAP",
    "TAX_ID",
    "TAX_ID_TYPE",
    "TIMEZONE_ID",
    "TIMEZONE_NAME",
    "TIMEZONE_OFFSET_HOURS_UTC",
    "ACCOUNT_STATUS",
    "DISABLE_REASON",
    "TAX_ID_STATUS",
    "AGENCY_CLIENT_DECLARATION_AGENCY_REPRESENTING_CLIENT",
    "AGENCY_CLIENT_DECLARATION_CLIENT_BASED_IN_FRANCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_CITY",
    "AGENCY_CLIENT_DECLARATION_CLIENT_COUNTRY_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_EMAIL_ADDRESS",
    "AGENCY_CLIENT_DECLARATION_CLIENT_NAME",
    "AGENCY_CLIENT_DECLARATION_CLIENT_POSTAL_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_PROVINCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET_2",
    "AGENCY_CLIENT_DECLARATION_HAS_WRITTEN_MANDATE_FROM_ADVERTISER",
    "AGENCY_CLIENT_DECLARATION_IS_CLIENT_PAYING_INVOICES",
    "BUSINESS_MANAGER_BLOCK_OFFLINE_ANALYTICS",
    "BUSINESS_MANAGER_CREATED_BY",
    "BUSINESS_MANAGER_CREATED_TIME",
    "BUSINESS_MANAGER_EXTENDED_UPDATED_TIME",
    "BUSINESS_MANAGER_IS_HIDDEN",
    "BUSINESS_MANAGER_LINK",
    "BUSINESS_MANAGER_NAME",
    "BUSINESS_MANAGER_PAYMENT_ACCOUNT_ID",
    "BUSINESS_MANAGER_PRIMARY_PAGE",
    "BUSINESS_MANAGER_PROFILE_PICTURE_URI",
    "BUSINESS_MANAGER_TIMEZONE_ID",
    "BUSINESS_MANAGER_TWO_FACTOR_TYPE",
    "BUSINESS_MANAGER_UPDATED_BY",
    "BUSINESS_MANAGER_UPDATE_TIME",
    "BUSINESS_MANAGER_VERIFICATION_STATUS",
    "BUSINESS_MANAGER_VERTICAL",
    "BUSINESS_MANAGER_VERTICAL_ID",
    "BUSINESS_MANAGER_MANAGER_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_AUTO_ENROLL",
    "EXTENDED_CREDIT_INVOICE_GROUP_CUSTOMER_PO_NUMBER",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAIL",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAILS",
    "EXTENDED_CREDIT_INVOICE_GROUP_NAME",
    "CAPABILITIES",
    "ID",
    "_FIVETRAN_SYNCED",
    "RECORD_SOURCE",
    "CURRENCY_CODE",
    "ACCOUNT_ID",
    "FACEBOOK_ACCOUNTS_HK"

    FROM hashed_columns
)

SELECT * FROM columns_to_select
  );
12:26:53.951414 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.41 seconds
12:26:53.955923 [debug] [Thread-3  ]: finished collecting timing info
12:26:53.956453 [debug] [Thread-3  ]: On model.HackdayVault.facebook_accounts_staging_hashed: Close
12:26:54.259963 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6352c481-09f5-48f7-ad9e-4b167b79a7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16272fb20>]}
12:26:54.261345 [info ] [Thread-3  ]: 2 of 2 OK created view model hackday.facebook_accounts_staging_hashed .......... [[32mSUCCESS 1[0m in 2.05s]
12:26:54.262316 [debug] [Thread-3  ]: Finished running node model.HackdayVault.facebook_accounts_staging_hashed
12:26:54.263816 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:26:54.264300 [info ] [MainThread]: 
12:26:54.264690 [info ] [MainThread]: Finished running 2 view models in 6.73s.
12:26:54.265047 [debug] [MainThread]: Connection 'master' was properly closed.
12:26:54.265239 [debug] [MainThread]: Connection 'model.HackdayVault.facebook_accounts_staging_raw' was properly closed.
12:26:54.265427 [debug] [MainThread]: Connection 'model.HackdayVault.facebook_accounts_staging_hashed' was properly closed.
12:26:54.348040 [info ] [MainThread]: 
12:26:54.348377 [info ] [MainThread]: [32mCompleted successfully[0m
12:26:54.348648 [info ] [MainThread]: 
12:26:54.348867 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
12:26:54.349178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16262fca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080cf460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10810ee20>]}


============================== 2022-06-29 12:27:14.109603 | dba1af5f-c584-4735-8a2d-cda8ae627ca1 ==============================
12:27:14.109623 [info ] [MainThread]: Running with dbt=1.1.0
12:27:14.110422 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/adambekele/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['facebook_accounts_staging_raw+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
12:27:14.110553 [debug] [MainThread]: Tracking: tracking
12:27:14.110846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c8ea5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c8eacd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c90e0d0>]}
12:27:14.195796 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
12:27:14.196051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dba1af5f-c584-4735-8a2d-cda8ae627ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c8fcdc0>]}
12:27:14.243239 [debug] [MainThread]: Parsing macros/catalog.sql
12:27:14.244506 [debug] [MainThread]: Parsing macros/adapters.sql
12:27:14.265685 [debug] [MainThread]: Parsing macros/materializations/merge.sql
12:27:14.267666 [debug] [MainThread]: Parsing macros/materializations/seed.sql
12:27:14.270350 [debug] [MainThread]: Parsing macros/materializations/view.sql
12:27:14.270990 [debug] [MainThread]: Parsing macros/materializations/table.sql
12:27:14.272565 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
12:27:14.276786 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
12:27:14.277247 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
12:27:14.279077 [debug] [MainThread]: Parsing macros/materializations/configs.sql
12:27:14.280173 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
12:27:14.280969 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
12:27:14.289179 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
12:27:14.295995 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
12:27:14.301673 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
12:27:14.303870 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
12:27:14.304714 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
12:27:14.305565 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
12:27:14.307681 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
12:27:14.316529 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
12:27:14.317261 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
12:27:14.322527 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
12:27:14.330615 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
12:27:14.334524 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
12:27:14.335865 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
12:27:14.339582 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
12:27:14.340190 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
12:27:14.341491 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
12:27:14.342607 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
12:27:14.345618 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
12:27:14.354124 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
12:27:14.354819 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
12:27:14.355985 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
12:27:14.356720 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
12:27:14.357139 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
12:27:14.357514 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
12:27:14.357835 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
12:27:14.358522 [debug] [MainThread]: Parsing macros/etc/statement.sql
12:27:14.360655 [debug] [MainThread]: Parsing macros/etc/datetime.sql
12:27:14.364874 [debug] [MainThread]: Parsing macros/adapters/schema.sql
12:27:14.365914 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
12:27:14.367228 [debug] [MainThread]: Parsing macros/adapters/relation.sql
12:27:14.371899 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
12:27:14.373283 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
12:27:14.375383 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
12:27:14.378951 [debug] [MainThread]: Parsing macros/adapters/columns.sql
12:27:14.383709 [debug] [MainThread]: Parsing tests/generic/builtin.sql
12:27:14.385113 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
12:27:14.385595 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
12:27:14.386186 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
12:27:14.386714 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
12:27:14.389409 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
12:27:14.389967 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
12:27:14.391185 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
12:27:14.391802 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
12:27:14.393148 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
12:27:14.393626 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
12:27:14.394533 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
12:27:14.395601 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
12:27:14.400074 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
12:27:14.405167 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
12:27:14.406013 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
12:27:14.406660 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
12:27:14.407316 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
12:27:14.408116 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
12:27:14.408707 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
12:27:14.409418 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
12:27:14.409934 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
12:27:14.411527 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
12:27:14.414172 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
12:27:14.415017 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
12:27:14.415794 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
12:27:14.417446 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
12:27:14.420439 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
12:27:14.421116 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
12:27:14.422370 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
12:27:14.423477 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
12:27:14.424438 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
12:27:14.437109 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
12:27:14.438079 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
12:27:14.439320 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
12:27:14.440050 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
12:27:14.440884 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
12:27:14.441655 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
12:27:14.442728 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
12:27:14.443559 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
12:27:14.444145 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
12:27:14.445386 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
12:27:14.446407 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
12:27:14.447074 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
12:27:14.447662 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
12:27:14.449067 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
12:27:14.450072 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
12:27:14.450928 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
12:27:14.451973 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
12:27:14.453410 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
12:27:14.454071 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
12:27:14.455787 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
12:27:14.460476 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
12:27:14.460993 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
12:27:14.461556 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
12:27:14.462074 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
12:27:14.462627 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
12:27:14.464625 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
12:27:14.465527 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
12:27:14.467234 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
12:27:14.469398 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
12:27:14.471200 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
12:27:14.472049 [debug] [MainThread]: Parsing macros/sql/star.sql
12:27:14.473935 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
12:27:14.478200 [debug] [MainThread]: Parsing macros/sql/union.sql
12:27:14.484264 [debug] [MainThread]: Parsing macros/sql/groupby.sql
12:27:14.484925 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
12:27:14.488543 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
12:27:14.490185 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
12:27:14.490940 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
12:27:14.491705 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
12:27:14.495102 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
12:27:14.498032 [debug] [MainThread]: Parsing macros/sql/pivot.sql
12:27:14.500160 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
12:27:14.501487 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
12:27:14.502611 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
12:27:14.503410 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
12:27:14.506495 [debug] [MainThread]: Parsing macros/tables/bigquery/xts.sql
12:27:14.506972 [debug] [MainThread]: Parsing macros/tables/bigquery/pit.sql
12:27:14.518717 [debug] [MainThread]: Parsing macros/tables/bigquery/ma_sat.sql
12:27:14.527578 [debug] [MainThread]: Parsing macros/tables/bigquery/t_link.sql
12:27:14.528076 [debug] [MainThread]: Parsing macros/tables/bigquery/sat.sql
12:27:14.532942 [debug] [MainThread]: Parsing macros/tables/bigquery/hub.sql
12:27:14.539127 [debug] [MainThread]: Parsing macros/tables/bigquery/eff_sat.sql
12:27:14.546618 [debug] [MainThread]: Parsing macros/tables/bigquery/link.sql
12:27:14.552843 [debug] [MainThread]: Parsing macros/tables/bigquery/bridge.sql
12:27:14.575364 [debug] [MainThread]: Parsing macros/tables/snowflake/xts.sql
12:27:14.579722 [debug] [MainThread]: Parsing macros/tables/snowflake/pit.sql
12:27:14.593121 [debug] [MainThread]: Parsing macros/tables/snowflake/ma_sat.sql
12:27:14.600295 [debug] [MainThread]: Parsing macros/tables/snowflake/t_link.sql
12:27:14.603811 [debug] [MainThread]: Parsing macros/tables/snowflake/sat.sql
12:27:14.609474 [debug] [MainThread]: Parsing macros/tables/snowflake/hub.sql
12:27:14.616263 [debug] [MainThread]: Parsing macros/tables/snowflake/eff_sat.sql
12:27:14.624881 [debug] [MainThread]: Parsing macros/tables/snowflake/link.sql
12:27:14.632490 [debug] [MainThread]: Parsing macros/tables/snowflake/bridge.sql
12:27:14.655503 [debug] [MainThread]: Parsing macros/tables/sqlserver/xts.sql
12:27:14.655933 [debug] [MainThread]: Parsing macros/tables/sqlserver/pit.sql
12:27:14.656390 [debug] [MainThread]: Parsing macros/tables/sqlserver/ma_sat.sql
12:27:14.665012 [debug] [MainThread]: Parsing macros/tables/sqlserver/t_link.sql
12:27:14.665486 [debug] [MainThread]: Parsing macros/tables/sqlserver/sat.sql
12:27:14.670363 [debug] [MainThread]: Parsing macros/tables/sqlserver/hub.sql
12:27:14.677304 [debug] [MainThread]: Parsing macros/tables/sqlserver/eff_sat.sql
12:27:14.684749 [debug] [MainThread]: Parsing macros/tables/sqlserver/link.sql
12:27:14.691713 [debug] [MainThread]: Parsing macros/tables/sqlserver/bridge.sql
12:27:14.714014 [debug] [MainThread]: Parsing macros/staging/hash_columns.sql
12:27:14.715916 [debug] [MainThread]: Parsing macros/staging/source_columns.sql
12:27:14.716502 [debug] [MainThread]: Parsing macros/staging/stage.sql
12:27:14.722114 [debug] [MainThread]: Parsing macros/staging/rank_columns.sql
12:27:14.727095 [debug] [MainThread]: Parsing macros/staging/derive_columns.sql
12:27:14.730064 [debug] [MainThread]: Parsing macros/internal/metadata_processing/as_constant.sql
12:27:14.731329 [debug] [MainThread]: Parsing macros/internal/metadata_processing/escape_column_names.sql
12:27:14.738477 [debug] [MainThread]: Parsing macros/internal/metadata_processing/alias.sql
12:27:14.740198 [debug] [MainThread]: Parsing macros/internal/metadata_processing/concat_ws.sql
12:27:14.741237 [debug] [MainThread]: Parsing macros/internal/metadata_processing/multikey.sql
12:27:14.743936 [debug] [MainThread]: Parsing macros/internal/metadata_processing/expand_column_list.sql
12:27:14.745549 [debug] [MainThread]: Parsing macros/internal/metadata_processing/check_required_parameters.sql
12:27:14.746330 [debug] [MainThread]: Parsing macros/internal/metadata_processing/alias_all.sql
12:27:14.747447 [debug] [MainThread]: Parsing macros/internal/helpers/prepend_generated_by.sql
12:27:14.747627 [debug] [MainThread]: Parsing macros/internal/helpers/is_checks.sql
12:27:14.750046 [debug] [MainThread]: Parsing macros/internal/helpers/stage_processing_macros.sql
12:27:14.755398 [debug] [MainThread]: Parsing macros/materialisations/vault_insert_by_rank_materialization.sql
12:27:14.763905 [debug] [MainThread]: Parsing macros/materialisations/incremental_bridge_materialization.sql
12:27:14.766591 [debug] [MainThread]: Parsing macros/materialisations/shared_helpers.sql
12:27:14.767108 [debug] [MainThread]: Parsing macros/materialisations/vault_insert_by_period_materialization.sql
12:27:14.781620 [debug] [MainThread]: Parsing macros/materialisations/incremental_pit_bridge_replace.sql
12:27:14.782810 [debug] [MainThread]: Parsing macros/materialisations/incremental_pit_materialization.sql
12:27:14.785497 [debug] [MainThread]: Parsing macros/materialisations/mat_is_checks.sql
12:27:14.788673 [debug] [MainThread]: Parsing macros/materialisations/rank_mat_helpers/get_min_max_ranks.sql
12:27:14.790422 [debug] [MainThread]: Parsing macros/materialisations/rank_mat_helpers/replace_placeholder_with_rank_filter.sql
12:27:14.792331 [debug] [MainThread]: Parsing macros/materialisations/period_mat_helpers/replace_placeholder_with_period_filter.sql
12:27:14.796258 [debug] [MainThread]: Parsing macros/materialisations/period_mat_helpers/get_period_boundaries.sql
12:27:14.802372 [debug] [MainThread]: Parsing macros/materialisations/period_mat_helpers/get_start_stop_dates.sql
12:27:14.804668 [debug] [MainThread]: Parsing macros/materialisations/period_mat_helpers/get_period_filter_sql.sql
12:27:14.807687 [debug] [MainThread]: Parsing macros/materialisations/period_mat_helpers/get_period_of_load.sql
12:27:14.810274 [debug] [MainThread]: Parsing macros/supporting/datatypes.sql
12:27:14.810801 [debug] [MainThread]: Parsing macros/supporting/max_datetime.sql
12:27:14.811591 [debug] [MainThread]: Parsing macros/supporting/hash.sql
12:27:14.822772 [debug] [MainThread]: Parsing macros/supporting/prefix.sql
12:27:14.825680 [debug] [MainThread]: Parsing macros/supporting/current_timestamp.sql
12:27:14.826690 [debug] [MainThread]: Parsing macros/supporting/get_query_results_as_dict.sql
12:27:15.194202 [debug] [MainThread]: 1603: static parser failed on stage_hashed/facebook_accounts_staging_hashed.sql
12:27:15.269297 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage_hashed/facebook_accounts_staging_hashed.sql
12:27:15.269913 [debug] [MainThread]: 1603: static parser failed on stage_hashed/facebook_ads_insights_staging_hashed.sql
12:27:15.280304 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage_hashed/facebook_ads_insights_staging_hashed.sql
12:27:15.281081 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
12:27:15.282280 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
12:27:15.283351 [debug] [MainThread]: 1699: static parser successfully parsed stage_raw/facebook_accounts_staging_raw.sql
12:27:15.284925 [debug] [MainThread]: 1699: static parser successfully parsed stage_raw/facebook_ads_insights_staging_raw.sql
12:27:15.344462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dba1af5f-c584-4735-8a2d-cda8ae627ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cd6d0d0>]}
12:27:15.410784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dba1af5f-c584-4735-8a2d-cda8ae627ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cccfdc0>]}
12:27:15.411109 [info ] [MainThread]: Found 6 models, 9 tests, 0 snapshots, 0 analyses, 545 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
12:27:15.411350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dba1af5f-c584-4735-8a2d-cda8ae627ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c8fc490>]}
12:27:15.412341 [info ] [MainThread]: 
12:27:15.412721 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:27:15.413360 [debug] [ThreadPool]: Acquiring new snowflake connection "list_BLINKIST_DEV"
12:27:15.423010 [debug] [ThreadPool]: Using snowflake connection "list_BLINKIST_DEV"
12:27:15.423262 [debug] [ThreadPool]: On list_BLINKIST_DEV: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "connection_name": "list_BLINKIST_DEV"} */

    show terse schemas in database BLINKIST_DEV
    limit 10000
12:27:15.423376 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:27:16.737566 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.31 seconds
12:27:16.741457 [debug] [ThreadPool]: On list_BLINKIST_DEV: Close
12:27:17.037738 [debug] [ThreadPool]: Acquiring new snowflake connection "list_BLINKIST_DEV_hackday"
12:27:17.050490 [debug] [ThreadPool]: Using snowflake connection "list_BLINKIST_DEV_hackday"
12:27:17.050898 [debug] [ThreadPool]: On list_BLINKIST_DEV_hackday: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "connection_name": "list_BLINKIST_DEV_hackday"} */

    show terse objects in BLINKIST_DEV.hackday
12:27:17.051101 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:27:18.110255 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.06 seconds
12:27:18.113749 [debug] [ThreadPool]: On list_BLINKIST_DEV_hackday: Close
12:27:18.405527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dba1af5f-c584-4735-8a2d-cda8ae627ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cd7d820>]}
12:27:18.406864 [info ] [MainThread]: Concurrency: 4 threads (target='hackday')
12:27:18.407498 [info ] [MainThread]: 
12:27:18.414511 [debug] [Thread-1  ]: Began running node model.HackdayVault.facebook_accounts_staging_raw
12:27:18.415061 [info ] [Thread-1  ]: 1 of 2 START view model hackday.facebook_accounts_staging_raw .................. [RUN]
12:27:18.415742 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.HackdayVault.facebook_accounts_staging_raw"
12:27:18.415984 [debug] [Thread-1  ]: Began compiling node model.HackdayVault.facebook_accounts_staging_raw
12:27:18.416215 [debug] [Thread-1  ]: Compiling model.HackdayVault.facebook_accounts_staging_raw
12:27:18.420435 [debug] [Thread-1  ]: Writing injected SQL for node "model.HackdayVault.facebook_accounts_staging_raw"
12:27:18.424339 [debug] [Thread-1  ]: finished collecting timing info
12:27:18.424637 [debug] [Thread-1  ]: Began executing node model.HackdayVault.facebook_accounts_staging_raw
12:27:18.451152 [debug] [Thread-1  ]: Writing runtime SQL for node "model.HackdayVault.facebook_accounts_staging_raw"
12:27:18.455489 [debug] [Thread-1  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_staging_raw"
12:27:18.455792 [debug] [Thread-1  ]: On model.HackdayVault.facebook_accounts_staging_raw: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_staging_raw"} */

  create or replace  view BLINKIST_DEV.hackday.facebook_accounts_staging_raw
  
   as (
    SELECT
    *
FROM FIVETRAN_DATABASE.facebook_ads.account_history
  );
12:27:18.455940 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:27:19.501723 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.05 seconds
12:27:19.514908 [debug] [Thread-1  ]: finished collecting timing info
12:27:19.515343 [debug] [Thread-1  ]: On model.HackdayVault.facebook_accounts_staging_raw: Close
12:27:19.813848 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dba1af5f-c584-4735-8a2d-cda8ae627ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d266f10>]}
12:27:19.814599 [info ] [Thread-1  ]: 1 of 2 OK created view model hackday.facebook_accounts_staging_raw ............. [[32mSUCCESS 1[0m in 1.40s]
12:27:19.815528 [debug] [Thread-1  ]: Finished running node model.HackdayVault.facebook_accounts_staging_raw
12:27:19.816660 [debug] [Thread-3  ]: Began running node model.HackdayVault.facebook_accounts_staging_hashed
12:27:19.817133 [info ] [Thread-3  ]: 2 of 2 START view model hackday.facebook_accounts_staging_hashed ............... [RUN]
12:27:19.817811 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
12:27:19.818080 [debug] [Thread-3  ]: Began compiling node model.HackdayVault.facebook_accounts_staging_hashed
12:27:19.818318 [debug] [Thread-3  ]: Compiling model.HackdayVault.facebook_accounts_staging_hashed
12:27:19.837584 [debug] [Thread-3  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
12:27:19.837925 [debug] [Thread-3  ]: On model.HackdayVault.facebook_accounts_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_staging_hashed"} */

    describe table BLINKIST_DEV.hackday.facebook_accounts_staging_raw
12:27:19.838104 [debug] [Thread-3  ]: Opening a new connection, currently in state init
12:27:20.890800 [debug] [Thread-3  ]: SQL status: SUCCESS 83 in 1.05 seconds
12:27:20.967690 [debug] [Thread-3  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
12:27:20.967830 [debug] [Thread-3  ]: On model.HackdayVault.facebook_accounts_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_staging_hashed"} */

    describe table BLINKIST_DEV.hackday.facebook_accounts_staging_raw
12:27:21.154390 [debug] [Thread-3  ]: SQL status: SUCCESS 83 in 0.19 seconds
12:27:21.258637 [debug] [Thread-3  ]: Writing injected SQL for node "model.HackdayVault.facebook_accounts_staging_hashed"
12:27:21.260442 [debug] [Thread-3  ]: finished collecting timing info
12:27:21.260542 [debug] [Thread-3  ]: Began executing node model.HackdayVault.facebook_accounts_staging_hashed
12:27:21.262164 [debug] [Thread-3  ]: Writing runtime SQL for node "model.HackdayVault.facebook_accounts_staging_hashed"
12:27:21.273432 [debug] [Thread-3  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
12:27:21.273526 [debug] [Thread-3  ]: On model.HackdayVault.facebook_accounts_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_staging_hashed"} */

  create or replace  view BLINKIST_DEV.hackday.facebook_accounts_staging_hashed
  
   as (
    







-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    "_FIVETRAN_ID",
    "AGE",
    "AMOUNT_SPENT",
    "BALANCE",
    "BUSINESS_CITY",
    "BUSINESS_COUNTRY_CODE",
    "BUSINESS_NAME",
    "BUSINESS_STATE",
    "BUSINESS_STREET",
    "BUSINESS_STREET_2",
    "BUSINESS_ZIP",
    "CAN_CREATE_BRAND_LIFT_STUDY",
    "CREATED_TIME",
    "CURRENCY",
    "END_ADVERTISER",
    "END_ADVERTISER_NAME",
    "HAS_ADVERTISER_OPTED_IN_ODAX",
    "HAS_MIGRATED_PERMISSIONS",
    "IO_NUMBER",
    "IS_ATTRIBUTION_SPEC_SYSTEM_DEFAULT",
    "IS_DIRECT_DEALS_ENABLED",
    "IS_IN_3_DS_AUTHORIZATION_ENABLED_MARKET",
    "IS_NOTIFICATIONS_ENABLED",
    "IS_PERSONAL",
    "IS_PREPAY_ACCOUNT",
    "IS_TAX_ID_REQUIRED",
    "MEDIA_AGENCY",
    "MIN_CAMPAIGN_GROUP_SPEND_CAP",
    "MIN_DAILY_BUDGET",
    "NAME",
    "NEXT_BILL_DATE",
    "OFFSITE_PIXELS_TOS_ACCEPTED",
    "OWNER",
    "PARTNER",
    "SALESFORCE_INVOICE_GROUP_ID",
    "SPEND_CAP",
    "TAX_ID",
    "TAX_ID_TYPE",
    "TIMEZONE_ID",
    "TIMEZONE_NAME",
    "TIMEZONE_OFFSET_HOURS_UTC",
    "ACCOUNT_STATUS",
    "DISABLE_REASON",
    "TAX_ID_STATUS",
    "AGENCY_CLIENT_DECLARATION_AGENCY_REPRESENTING_CLIENT",
    "AGENCY_CLIENT_DECLARATION_CLIENT_BASED_IN_FRANCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_CITY",
    "AGENCY_CLIENT_DECLARATION_CLIENT_COUNTRY_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_EMAIL_ADDRESS",
    "AGENCY_CLIENT_DECLARATION_CLIENT_NAME",
    "AGENCY_CLIENT_DECLARATION_CLIENT_POSTAL_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_PROVINCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET_2",
    "AGENCY_CLIENT_DECLARATION_HAS_WRITTEN_MANDATE_FROM_ADVERTISER",
    "AGENCY_CLIENT_DECLARATION_IS_CLIENT_PAYING_INVOICES",
    "BUSINESS_MANAGER_BLOCK_OFFLINE_ANALYTICS",
    "BUSINESS_MANAGER_CREATED_BY",
    "BUSINESS_MANAGER_CREATED_TIME",
    "BUSINESS_MANAGER_EXTENDED_UPDATED_TIME",
    "BUSINESS_MANAGER_IS_HIDDEN",
    "BUSINESS_MANAGER_LINK",
    "BUSINESS_MANAGER_NAME",
    "BUSINESS_MANAGER_PAYMENT_ACCOUNT_ID",
    "BUSINESS_MANAGER_PRIMARY_PAGE",
    "BUSINESS_MANAGER_PROFILE_PICTURE_URI",
    "BUSINESS_MANAGER_TIMEZONE_ID",
    "BUSINESS_MANAGER_TWO_FACTOR_TYPE",
    "BUSINESS_MANAGER_UPDATED_BY",
    "BUSINESS_MANAGER_UPDATE_TIME",
    "BUSINESS_MANAGER_VERIFICATION_STATUS",
    "BUSINESS_MANAGER_VERTICAL",
    "BUSINESS_MANAGER_VERTICAL_ID",
    "BUSINESS_MANAGER_MANAGER_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_AUTO_ENROLL",
    "EXTENDED_CREDIT_INVOICE_GROUP_CUSTOMER_PO_NUMBER",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAIL",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAILS",
    "EXTENDED_CREDIT_INVOICE_GROUP_NAME",
    "CAPABILITIES",
    "ID",
    "_FIVETRAN_SYNCED"

    FROM BLINKIST_DEV.hackday.facebook_accounts_staging_raw
),

derived_columns AS (

    SELECT

    "_FIVETRAN_ID",
    "AGE",
    "AMOUNT_SPENT",
    "BALANCE",
    "BUSINESS_CITY",
    "BUSINESS_COUNTRY_CODE",
    "BUSINESS_NAME",
    "BUSINESS_STATE",
    "BUSINESS_STREET",
    "BUSINESS_STREET_2",
    "BUSINESS_ZIP",
    "CAN_CREATE_BRAND_LIFT_STUDY",
    "CREATED_TIME",
    "CURRENCY",
    "END_ADVERTISER",
    "END_ADVERTISER_NAME",
    "HAS_ADVERTISER_OPTED_IN_ODAX",
    "HAS_MIGRATED_PERMISSIONS",
    "IO_NUMBER",
    "IS_ATTRIBUTION_SPEC_SYSTEM_DEFAULT",
    "IS_DIRECT_DEALS_ENABLED",
    "IS_IN_3_DS_AUTHORIZATION_ENABLED_MARKET",
    "IS_NOTIFICATIONS_ENABLED",
    "IS_PERSONAL",
    "IS_PREPAY_ACCOUNT",
    "IS_TAX_ID_REQUIRED",
    "MEDIA_AGENCY",
    "MIN_CAMPAIGN_GROUP_SPEND_CAP",
    "MIN_DAILY_BUDGET",
    "NAME",
    "NEXT_BILL_DATE",
    "OFFSITE_PIXELS_TOS_ACCEPTED",
    "OWNER",
    "PARTNER",
    "SALESFORCE_INVOICE_GROUP_ID",
    "SPEND_CAP",
    "TAX_ID",
    "TAX_ID_TYPE",
    "TIMEZONE_ID",
    "TIMEZONE_NAME",
    "TIMEZONE_OFFSET_HOURS_UTC",
    "ACCOUNT_STATUS",
    "DISABLE_REASON",
    "TAX_ID_STATUS",
    "AGENCY_CLIENT_DECLARATION_AGENCY_REPRESENTING_CLIENT",
    "AGENCY_CLIENT_DECLARATION_CLIENT_BASED_IN_FRANCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_CITY",
    "AGENCY_CLIENT_DECLARATION_CLIENT_COUNTRY_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_EMAIL_ADDRESS",
    "AGENCY_CLIENT_DECLARATION_CLIENT_NAME",
    "AGENCY_CLIENT_DECLARATION_CLIENT_POSTAL_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_PROVINCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET_2",
    "AGENCY_CLIENT_DECLARATION_HAS_WRITTEN_MANDATE_FROM_ADVERTISER",
    "AGENCY_CLIENT_DECLARATION_IS_CLIENT_PAYING_INVOICES",
    "BUSINESS_MANAGER_BLOCK_OFFLINE_ANALYTICS",
    "BUSINESS_MANAGER_CREATED_BY",
    "BUSINESS_MANAGER_CREATED_TIME",
    "BUSINESS_MANAGER_EXTENDED_UPDATED_TIME",
    "BUSINESS_MANAGER_IS_HIDDEN",
    "BUSINESS_MANAGER_LINK",
    "BUSINESS_MANAGER_NAME",
    "BUSINESS_MANAGER_PAYMENT_ACCOUNT_ID",
    "BUSINESS_MANAGER_PRIMARY_PAGE",
    "BUSINESS_MANAGER_PROFILE_PICTURE_URI",
    "BUSINESS_MANAGER_TIMEZONE_ID",
    "BUSINESS_MANAGER_TWO_FACTOR_TYPE",
    "BUSINESS_MANAGER_UPDATED_BY",
    "BUSINESS_MANAGER_UPDATE_TIME",
    "BUSINESS_MANAGER_VERIFICATION_STATUS",
    "BUSINESS_MANAGER_VERTICAL",
    "BUSINESS_MANAGER_VERTICAL_ID",
    "BUSINESS_MANAGER_MANAGER_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_AUTO_ENROLL",
    "EXTENDED_CREDIT_INVOICE_GROUP_CUSTOMER_PO_NUMBER",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAIL",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAILS",
    "EXTENDED_CREDIT_INVOICE_GROUP_NAME",
    "CAPABILITIES",
    "ID",
    "_FIVETRAN_SYNCED",
    'FIVETRAN_FACEBOOK_ACCOUNTS_RAW' AS "RECORD_SOURCE",
    "CURRENCY" AS "CURRENCY_CODE",
    "ID" AS "ACCOUNT_ID"

    FROM source_data
),

hashed_columns AS (

    SELECT

    "_FIVETRAN_ID",
    "AGE",
    "AMOUNT_SPENT",
    "BALANCE",
    "BUSINESS_CITY",
    "BUSINESS_COUNTRY_CODE",
    "BUSINESS_NAME",
    "BUSINESS_STATE",
    "BUSINESS_STREET",
    "BUSINESS_STREET_2",
    "BUSINESS_ZIP",
    "CAN_CREATE_BRAND_LIFT_STUDY",
    "CREATED_TIME",
    "CURRENCY",
    "END_ADVERTISER",
    "END_ADVERTISER_NAME",
    "HAS_ADVERTISER_OPTED_IN_ODAX",
    "HAS_MIGRATED_PERMISSIONS",
    "IO_NUMBER",
    "IS_ATTRIBUTION_SPEC_SYSTEM_DEFAULT",
    "IS_DIRECT_DEALS_ENABLED",
    "IS_IN_3_DS_AUTHORIZATION_ENABLED_MARKET",
    "IS_NOTIFICATIONS_ENABLED",
    "IS_PERSONAL",
    "IS_PREPAY_ACCOUNT",
    "IS_TAX_ID_REQUIRED",
    "MEDIA_AGENCY",
    "MIN_CAMPAIGN_GROUP_SPEND_CAP",
    "MIN_DAILY_BUDGET",
    "NAME",
    "NEXT_BILL_DATE",
    "OFFSITE_PIXELS_TOS_ACCEPTED",
    "OWNER",
    "PARTNER",
    "SALESFORCE_INVOICE_GROUP_ID",
    "SPEND_CAP",
    "TAX_ID",
    "TAX_ID_TYPE",
    "TIMEZONE_ID",
    "TIMEZONE_NAME",
    "TIMEZONE_OFFSET_HOURS_UTC",
    "ACCOUNT_STATUS",
    "DISABLE_REASON",
    "TAX_ID_STATUS",
    "AGENCY_CLIENT_DECLARATION_AGENCY_REPRESENTING_CLIENT",
    "AGENCY_CLIENT_DECLARATION_CLIENT_BASED_IN_FRANCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_CITY",
    "AGENCY_CLIENT_DECLARATION_CLIENT_COUNTRY_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_EMAIL_ADDRESS",
    "AGENCY_CLIENT_DECLARATION_CLIENT_NAME",
    "AGENCY_CLIENT_DECLARATION_CLIENT_POSTAL_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_PROVINCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET_2",
    "AGENCY_CLIENT_DECLARATION_HAS_WRITTEN_MANDATE_FROM_ADVERTISER",
    "AGENCY_CLIENT_DECLARATION_IS_CLIENT_PAYING_INVOICES",
    "BUSINESS_MANAGER_BLOCK_OFFLINE_ANALYTICS",
    "BUSINESS_MANAGER_CREATED_BY",
    "BUSINESS_MANAGER_CREATED_TIME",
    "BUSINESS_MANAGER_EXTENDED_UPDATED_TIME",
    "BUSINESS_MANAGER_IS_HIDDEN",
    "BUSINESS_MANAGER_LINK",
    "BUSINESS_MANAGER_NAME",
    "BUSINESS_MANAGER_PAYMENT_ACCOUNT_ID",
    "BUSINESS_MANAGER_PRIMARY_PAGE",
    "BUSINESS_MANAGER_PROFILE_PICTURE_URI",
    "BUSINESS_MANAGER_TIMEZONE_ID",
    "BUSINESS_MANAGER_TWO_FACTOR_TYPE",
    "BUSINESS_MANAGER_UPDATED_BY",
    "BUSINESS_MANAGER_UPDATE_TIME",
    "BUSINESS_MANAGER_VERIFICATION_STATUS",
    "BUSINESS_MANAGER_VERTICAL",
    "BUSINESS_MANAGER_VERTICAL_ID",
    "BUSINESS_MANAGER_MANAGER_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_AUTO_ENROLL",
    "EXTENDED_CREDIT_INVOICE_GROUP_CUSTOMER_PO_NUMBER",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAIL",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAILS",
    "EXTENDED_CREDIT_INVOICE_GROUP_NAME",
    "CAPABILITIES",
    "ID",
    "_FIVETRAN_SYNCED",
    "RECORD_SOURCE",
    "CURRENCY_CODE",
    "ACCOUNT_ID",

    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("ACCOUNT_ID" AS VARCHAR))), ''), '^^')
    ), '^^')) AS BINARY(16)) AS "FACEBOOK_ACCOUNTS_HK"

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    "_FIVETRAN_ID",
    "AGE",
    "AMOUNT_SPENT",
    "BALANCE",
    "BUSINESS_CITY",
    "BUSINESS_COUNTRY_CODE",
    "BUSINESS_NAME",
    "BUSINESS_STATE",
    "BUSINESS_STREET",
    "BUSINESS_STREET_2",
    "BUSINESS_ZIP",
    "CAN_CREATE_BRAND_LIFT_STUDY",
    "CREATED_TIME",
    "CURRENCY",
    "END_ADVERTISER",
    "END_ADVERTISER_NAME",
    "HAS_ADVERTISER_OPTED_IN_ODAX",
    "HAS_MIGRATED_PERMISSIONS",
    "IO_NUMBER",
    "IS_ATTRIBUTION_SPEC_SYSTEM_DEFAULT",
    "IS_DIRECT_DEALS_ENABLED",
    "IS_IN_3_DS_AUTHORIZATION_ENABLED_MARKET",
    "IS_NOTIFICATIONS_ENABLED",
    "IS_PERSONAL",
    "IS_PREPAY_ACCOUNT",
    "IS_TAX_ID_REQUIRED",
    "MEDIA_AGENCY",
    "MIN_CAMPAIGN_GROUP_SPEND_CAP",
    "MIN_DAILY_BUDGET",
    "NAME",
    "NEXT_BILL_DATE",
    "OFFSITE_PIXELS_TOS_ACCEPTED",
    "OWNER",
    "PARTNER",
    "SALESFORCE_INVOICE_GROUP_ID",
    "SPEND_CAP",
    "TAX_ID",
    "TAX_ID_TYPE",
    "TIMEZONE_ID",
    "TIMEZONE_NAME",
    "TIMEZONE_OFFSET_HOURS_UTC",
    "ACCOUNT_STATUS",
    "DISABLE_REASON",
    "TAX_ID_STATUS",
    "AGENCY_CLIENT_DECLARATION_AGENCY_REPRESENTING_CLIENT",
    "AGENCY_CLIENT_DECLARATION_CLIENT_BASED_IN_FRANCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_CITY",
    "AGENCY_CLIENT_DECLARATION_CLIENT_COUNTRY_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_EMAIL_ADDRESS",
    "AGENCY_CLIENT_DECLARATION_CLIENT_NAME",
    "AGENCY_CLIENT_DECLARATION_CLIENT_POSTAL_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_PROVINCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET_2",
    "AGENCY_CLIENT_DECLARATION_HAS_WRITTEN_MANDATE_FROM_ADVERTISER",
    "AGENCY_CLIENT_DECLARATION_IS_CLIENT_PAYING_INVOICES",
    "BUSINESS_MANAGER_BLOCK_OFFLINE_ANALYTICS",
    "BUSINESS_MANAGER_CREATED_BY",
    "BUSINESS_MANAGER_CREATED_TIME",
    "BUSINESS_MANAGER_EXTENDED_UPDATED_TIME",
    "BUSINESS_MANAGER_IS_HIDDEN",
    "BUSINESS_MANAGER_LINK",
    "BUSINESS_MANAGER_NAME",
    "BUSINESS_MANAGER_PAYMENT_ACCOUNT_ID",
    "BUSINESS_MANAGER_PRIMARY_PAGE",
    "BUSINESS_MANAGER_PROFILE_PICTURE_URI",
    "BUSINESS_MANAGER_TIMEZONE_ID",
    "BUSINESS_MANAGER_TWO_FACTOR_TYPE",
    "BUSINESS_MANAGER_UPDATED_BY",
    "BUSINESS_MANAGER_UPDATE_TIME",
    "BUSINESS_MANAGER_VERIFICATION_STATUS",
    "BUSINESS_MANAGER_VERTICAL",
    "BUSINESS_MANAGER_VERTICAL_ID",
    "BUSINESS_MANAGER_MANAGER_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_AUTO_ENROLL",
    "EXTENDED_CREDIT_INVOICE_GROUP_CUSTOMER_PO_NUMBER",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAIL",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAILS",
    "EXTENDED_CREDIT_INVOICE_GROUP_NAME",
    "CAPABILITIES",
    "ID",
    "_FIVETRAN_SYNCED",
    "RECORD_SOURCE",
    "CURRENCY_CODE",
    "ACCOUNT_ID",
    "FACEBOOK_ACCOUNTS_HK"

    FROM hashed_columns
)

SELECT * FROM columns_to_select
  );
12:27:21.745087 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.47 seconds
12:27:21.749039 [debug] [Thread-3  ]: finished collecting timing info
12:27:21.749491 [debug] [Thread-3  ]: On model.HackdayVault.facebook_accounts_staging_hashed: Close
12:27:22.049284 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dba1af5f-c584-4735-8a2d-cda8ae627ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d269370>]}
12:27:22.050345 [info ] [Thread-3  ]: 2 of 2 OK created view model hackday.facebook_accounts_staging_hashed .......... [[32mSUCCESS 1[0m in 2.23s]
12:27:22.051227 [debug] [Thread-3  ]: Finished running node model.HackdayVault.facebook_accounts_staging_hashed
12:27:22.052778 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:27:22.053264 [info ] [MainThread]: 
12:27:22.053664 [info ] [MainThread]: Finished running 2 view models in 6.64s.
12:27:22.054028 [debug] [MainThread]: Connection 'master' was properly closed.
12:27:22.054221 [debug] [MainThread]: Connection 'model.HackdayVault.facebook_accounts_staging_raw' was properly closed.
12:27:22.054413 [debug] [MainThread]: Connection 'model.HackdayVault.facebook_accounts_staging_hashed' was properly closed.
12:27:22.141947 [info ] [MainThread]: 
12:27:22.142323 [info ] [MainThread]: [32mCompleted successfully[0m
12:27:22.142600 [info ] [MainThread]: 
12:27:22.142825 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
12:27:22.143132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cb35370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cc9ec70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12cb38730>]}


============================== 2022-06-29 12:28:01.851830 | 8658d289-13c3-497e-97d4-41744d81ffbe ==============================
12:28:01.851859 [info ] [MainThread]: Running with dbt=1.1.0
12:28:01.852599 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/adambekele/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
12:28:01.852771 [debug] [MainThread]: Tracking: tracking
12:28:01.853047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1268875e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126887310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1268aa0d0>]}
12:28:01.989860 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
12:28:01.990003 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
12:28:01.993674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8658d289-13c3-497e-97d4-41744d81ffbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126adf0d0>]}
12:28:02.048880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8658d289-13c3-497e-97d4-41744d81ffbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126a29220>]}
12:28:02.049123 [info ] [MainThread]: Found 6 models, 9 tests, 0 snapshots, 0 analyses, 545 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
12:28:02.049307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8658d289-13c3-497e-97d4-41744d81ffbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126a290d0>]}
12:28:02.050316 [info ] [MainThread]: 
12:28:02.050617 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:28:02.051179 [debug] [ThreadPool]: Acquiring new snowflake connection "list_BLINKIST_DEV_hackday"
12:28:02.059281 [debug] [ThreadPool]: Using snowflake connection "list_BLINKIST_DEV_hackday"
12:28:02.059419 [debug] [ThreadPool]: On list_BLINKIST_DEV_hackday: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "connection_name": "list_BLINKIST_DEV_hackday"} */

    show terse objects in BLINKIST_DEV.hackday
12:28:02.059520 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:28:03.356369 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.3 seconds
12:28:03.360268 [debug] [ThreadPool]: On list_BLINKIST_DEV_hackday: Close
12:28:03.672665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8658d289-13c3-497e-97d4-41744d81ffbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126847f70>]}
12:28:03.673992 [info ] [MainThread]: Concurrency: 4 threads (target='hackday')
12:28:03.674622 [info ] [MainThread]: 
12:28:03.681938 [debug] [Thread-1  ]: Began running node model.HackdayVault.facebook_accounts_staging_raw
12:28:03.682193 [debug] [Thread-2  ]: Began running node model.HackdayVault.facebook_ads_insights_staging_raw
12:28:03.682409 [debug] [Thread-3  ]: Began running node model.HackdayVault.my_first_dbt_model
12:28:03.682657 [debug] [Thread-4  ]: Began running node test.HackdayVault.source_not_null_fivetran_facebook_ads_account_history__fivetran_id.7e933b3975
12:28:03.683238 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.HackdayVault.facebook_accounts_staging_raw"
12:28:03.684902 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.HackdayVault.facebook_ads_insights_staging_raw"
12:28:03.685411 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.HackdayVault.my_first_dbt_model"
12:28:03.685828 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.HackdayVault.source_not_null_fivetran_facebook_ads_account_history__fivetran_id.7e933b3975"
12:28:03.686080 [debug] [Thread-1  ]: Began compiling node model.HackdayVault.facebook_accounts_staging_raw
12:28:03.686309 [debug] [Thread-2  ]: Began compiling node model.HackdayVault.facebook_ads_insights_staging_raw
12:28:03.686528 [debug] [Thread-3  ]: Began compiling node model.HackdayVault.my_first_dbt_model
12:28:03.686743 [debug] [Thread-4  ]: Began compiling node test.HackdayVault.source_not_null_fivetran_facebook_ads_account_history__fivetran_id.7e933b3975
12:28:03.686965 [debug] [Thread-1  ]: Compiling model.HackdayVault.facebook_accounts_staging_raw
12:28:03.687150 [debug] [Thread-2  ]: Compiling model.HackdayVault.facebook_ads_insights_staging_raw
12:28:03.687324 [debug] [Thread-3  ]: Compiling model.HackdayVault.my_first_dbt_model
12:28:03.687496 [debug] [Thread-4  ]: Compiling test.HackdayVault.source_not_null_fivetran_facebook_ads_account_history__fivetran_id.7e933b3975
12:28:03.691176 [debug] [Thread-1  ]: Writing injected SQL for node "model.HackdayVault.facebook_accounts_staging_raw"
12:28:03.694428 [debug] [Thread-2  ]: Writing injected SQL for node "model.HackdayVault.facebook_ads_insights_staging_raw"
12:28:03.697419 [debug] [Thread-3  ]: Writing injected SQL for node "model.HackdayVault.my_first_dbt_model"
12:28:03.710089 [debug] [Thread-4  ]: Writing injected SQL for node "test.HackdayVault.source_not_null_fivetran_facebook_ads_account_history__fivetran_id.7e933b3975"
12:28:03.711615 [debug] [Thread-3  ]: finished collecting timing info
12:28:03.711771 [debug] [Thread-4  ]: finished collecting timing info
12:28:03.711958 [debug] [Thread-3  ]: Began executing node model.HackdayVault.my_first_dbt_model
12:28:03.712116 [debug] [Thread-4  ]: Began executing node test.HackdayVault.source_not_null_fivetran_facebook_ads_account_history__fivetran_id.7e933b3975
12:28:03.712268 [debug] [Thread-3  ]: finished collecting timing info
12:28:03.712404 [debug] [Thread-4  ]: finished collecting timing info
12:28:03.712822 [debug] [Thread-3  ]: Finished running node model.HackdayVault.my_first_dbt_model
12:28:03.713149 [debug] [Thread-4  ]: Finished running node test.HackdayVault.source_not_null_fivetran_facebook_ads_account_history__fivetran_id.7e933b3975
12:28:03.713339 [debug] [Thread-3  ]: Began running node test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_ad_id.75b5b8e4ad
12:28:03.713742 [debug] [Thread-4  ]: Began running node test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_country.90398cd374
12:28:03.714105 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_ad_id.75b5b8e4ad"
12:28:03.714361 [debug] [Thread-4  ]: Acquiring new snowflake connection "test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_country.90398cd374"
12:28:03.714514 [debug] [Thread-3  ]: Began compiling node test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_ad_id.75b5b8e4ad
12:28:03.714650 [debug] [Thread-4  ]: Began compiling node test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_country.90398cd374
12:28:03.714794 [debug] [Thread-3  ]: Compiling test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_ad_id.75b5b8e4ad
12:28:03.714924 [debug] [Thread-4  ]: Compiling test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_country.90398cd374
12:28:03.719034 [debug] [Thread-3  ]: Writing injected SQL for node "test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_ad_id.75b5b8e4ad"
12:28:03.724303 [debug] [Thread-4  ]: Writing injected SQL for node "test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_country.90398cd374"
12:28:03.724509 [debug] [Thread-1  ]: finished collecting timing info
12:28:03.725150 [debug] [Thread-2  ]: finished collecting timing info
12:28:03.725398 [debug] [Thread-1  ]: Began executing node model.HackdayVault.facebook_accounts_staging_raw
12:28:03.725558 [debug] [Thread-2  ]: Began executing node model.HackdayVault.facebook_ads_insights_staging_raw
12:28:03.725732 [debug] [Thread-1  ]: finished collecting timing info
12:28:03.725902 [debug] [Thread-2  ]: finished collecting timing info
12:28:03.726017 [debug] [Thread-4  ]: finished collecting timing info
12:28:03.726105 [debug] [Thread-3  ]: finished collecting timing info
12:28:03.726466 [debug] [Thread-1  ]: Finished running node model.HackdayVault.facebook_accounts_staging_raw
12:28:03.726743 [debug] [Thread-2  ]: Finished running node model.HackdayVault.facebook_ads_insights_staging_raw
12:28:03.726873 [debug] [Thread-4  ]: Began executing node test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_country.90398cd374
12:28:03.726984 [debug] [Thread-3  ]: Began executing node test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_ad_id.75b5b8e4ad
12:28:03.727115 [debug] [Thread-1  ]: Began running node test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_date.a05f86e494
12:28:03.727344 [debug] [Thread-2  ]: Began running node test.HackdayVault.source_unique_fivetran_facebook_ads_account_history__fivetran_id.9906b22233
12:28:03.727519 [debug] [Thread-4  ]: finished collecting timing info
12:28:03.727624 [debug] [Thread-3  ]: finished collecting timing info
12:28:03.727819 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_date.a05f86e494"
12:28:03.728034 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.HackdayVault.source_unique_fivetran_facebook_ads_account_history__fivetran_id.9906b22233"
12:28:03.728292 [debug] [Thread-4  ]: Finished running node test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_country.90398cd374
12:28:03.728524 [debug] [Thread-3  ]: Finished running node test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_ad_id.75b5b8e4ad
12:28:03.728635 [debug] [Thread-1  ]: Began compiling node test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_date.a05f86e494
12:28:03.728740 [debug] [Thread-2  ]: Began compiling node test.HackdayVault.source_unique_fivetran_facebook_ads_account_history__fivetran_id.9906b22233
12:28:03.728855 [debug] [Thread-4  ]: Began running node model.HackdayVault.my_second_dbt_model
12:28:03.729004 [debug] [Thread-3  ]: Began running node test.HackdayVault.not_null_my_first_dbt_model_id.5fb22c2710
12:28:03.729151 [debug] [Thread-1  ]: Compiling test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_date.a05f86e494
12:28:03.729253 [debug] [Thread-2  ]: Compiling test.HackdayVault.source_unique_fivetran_facebook_ads_account_history__fivetran_id.9906b22233
12:28:03.729431 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.HackdayVault.my_second_dbt_model"
12:28:03.729606 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.HackdayVault.not_null_my_first_dbt_model_id.5fb22c2710"
12:28:03.732633 [debug] [Thread-1  ]: Writing injected SQL for node "test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_date.a05f86e494"
12:28:03.737076 [debug] [Thread-2  ]: Writing injected SQL for node "test.HackdayVault.source_unique_fivetran_facebook_ads_account_history__fivetran_id.9906b22233"
12:28:03.737209 [debug] [Thread-4  ]: Began compiling node model.HackdayVault.my_second_dbt_model
12:28:03.737313 [debug] [Thread-3  ]: Began compiling node test.HackdayVault.not_null_my_first_dbt_model_id.5fb22c2710
12:28:03.737517 [debug] [Thread-4  ]: Compiling model.HackdayVault.my_second_dbt_model
12:28:03.737628 [debug] [Thread-3  ]: Compiling test.HackdayVault.not_null_my_first_dbt_model_id.5fb22c2710
12:28:03.739375 [debug] [Thread-4  ]: Writing injected SQL for node "model.HackdayVault.my_second_dbt_model"
12:28:03.741906 [debug] [Thread-3  ]: Writing injected SQL for node "test.HackdayVault.not_null_my_first_dbt_model_id.5fb22c2710"
12:28:03.742066 [debug] [Thread-2  ]: finished collecting timing info
12:28:03.742238 [debug] [Thread-1  ]: finished collecting timing info
12:28:03.742357 [debug] [Thread-2  ]: Began executing node test.HackdayVault.source_unique_fivetran_facebook_ads_account_history__fivetran_id.9906b22233
12:28:03.742463 [debug] [Thread-1  ]: Began executing node test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_date.a05f86e494
12:28:03.742612 [debug] [Thread-2  ]: finished collecting timing info
12:28:03.742727 [debug] [Thread-4  ]: finished collecting timing info
12:28:03.742803 [debug] [Thread-1  ]: finished collecting timing info
12:28:03.742867 [debug] [Thread-3  ]: finished collecting timing info
12:28:03.743108 [debug] [Thread-2  ]: Finished running node test.HackdayVault.source_unique_fivetran_facebook_ads_account_history__fivetran_id.9906b22233
12:28:03.743213 [debug] [Thread-4  ]: Began executing node model.HackdayVault.my_second_dbt_model
12:28:03.743416 [debug] [Thread-1  ]: Finished running node test.HackdayVault.source_not_null_fivetran_facebook_insights_ads_insights_date.a05f86e494
12:28:03.743513 [debug] [Thread-3  ]: Began executing node test.HackdayVault.not_null_my_first_dbt_model_id.5fb22c2710
12:28:03.743628 [debug] [Thread-2  ]: Began running node test.HackdayVault.unique_my_first_dbt_model_id.16e066b321
12:28:03.743765 [debug] [Thread-4  ]: finished collecting timing info
12:28:03.743885 [debug] [Thread-1  ]: Began running node model.HackdayVault.facebook_accounts_staging_hashed
12:28:03.744020 [debug] [Thread-3  ]: finished collecting timing info
12:28:03.744200 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.HackdayVault.unique_my_first_dbt_model_id.16e066b321"
12:28:03.744412 [debug] [Thread-4  ]: Finished running node model.HackdayVault.my_second_dbt_model
12:28:03.744563 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
12:28:03.744758 [debug] [Thread-3  ]: Finished running node test.HackdayVault.not_null_my_first_dbt_model_id.5fb22c2710
12:28:03.744856 [debug] [Thread-2  ]: Began compiling node test.HackdayVault.unique_my_first_dbt_model_id.16e066b321
12:28:03.744961 [debug] [Thread-4  ]: Began running node model.HackdayVault.facebook_ads_insights_staging_hashed
12:28:03.745127 [debug] [Thread-1  ]: Began compiling node model.HackdayVault.facebook_accounts_staging_hashed
12:28:03.745228 [debug] [Thread-3  ]: Began running node test.HackdayVault.not_null_my_second_dbt_model_id.151b76d778
12:28:03.745334 [debug] [Thread-2  ]: Compiling test.HackdayVault.unique_my_first_dbt_model_id.16e066b321
12:28:03.745500 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.HackdayVault.facebook_ads_insights_staging_hashed"
12:28:03.745595 [debug] [Thread-1  ]: Compiling model.HackdayVault.facebook_accounts_staging_hashed
12:28:03.745847 [debug] [Thread-3  ]: Acquiring new snowflake connection "test.HackdayVault.not_null_my_second_dbt_model_id.151b76d778"
12:28:03.748101 [debug] [Thread-2  ]: Writing injected SQL for node "test.HackdayVault.unique_my_first_dbt_model_id.16e066b321"
12:28:03.748208 [debug] [Thread-4  ]: Began compiling node model.HackdayVault.facebook_ads_insights_staging_hashed
12:28:03.768276 [debug] [Thread-1  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
12:28:03.768357 [debug] [Thread-3  ]: Began compiling node test.HackdayVault.not_null_my_second_dbt_model_id.151b76d778
12:28:03.768506 [debug] [Thread-4  ]: Compiling model.HackdayVault.facebook_ads_insights_staging_hashed
12:28:03.768599 [debug] [Thread-1  ]: On model.HackdayVault.facebook_accounts_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_staging_hashed"} */

    describe table BLINKIST_DEV.hackday.facebook_accounts_staging_raw
12:28:03.768723 [debug] [Thread-3  ]: Compiling test.HackdayVault.not_null_my_second_dbt_model_id.151b76d778
12:28:03.772700 [debug] [Thread-4  ]: Using snowflake connection "model.HackdayVault.facebook_ads_insights_staging_hashed"
12:28:03.772832 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:28:03.772915 [debug] [Thread-2  ]: finished collecting timing info
12:28:03.774914 [debug] [Thread-3  ]: Writing injected SQL for node "test.HackdayVault.not_null_my_second_dbt_model_id.151b76d778"
12:28:03.775007 [debug] [Thread-4  ]: On model.HackdayVault.facebook_ads_insights_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_ads_insights_staging_hashed"} */

    describe table BLINKIST_DEV.hackday.facebook_ads_insights_staging_raw
12:28:03.775708 [debug] [Thread-2  ]: Began executing node test.HackdayVault.unique_my_first_dbt_model_id.16e066b321
12:28:03.775834 [debug] [Thread-4  ]: Opening a new connection, currently in state init
12:28:03.775956 [debug] [Thread-2  ]: finished collecting timing info
12:28:03.776615 [debug] [Thread-2  ]: Finished running node test.HackdayVault.unique_my_first_dbt_model_id.16e066b321
12:28:03.776814 [debug] [Thread-2  ]: Began running node test.HackdayVault.unique_my_second_dbt_model_id.57a0f8c493
12:28:03.776957 [debug] [Thread-2  ]: Acquiring new snowflake connection "test.HackdayVault.unique_my_second_dbt_model_id.57a0f8c493"
12:28:03.777267 [debug] [Thread-2  ]: Began compiling node test.HackdayVault.unique_my_second_dbt_model_id.57a0f8c493
12:28:03.777347 [debug] [Thread-2  ]: Compiling test.HackdayVault.unique_my_second_dbt_model_id.57a0f8c493
12:28:03.779817 [debug] [Thread-2  ]: Writing injected SQL for node "test.HackdayVault.unique_my_second_dbt_model_id.57a0f8c493"
12:28:03.780143 [debug] [Thread-3  ]: finished collecting timing info
12:28:03.780249 [debug] [Thread-3  ]: Began executing node test.HackdayVault.not_null_my_second_dbt_model_id.151b76d778
12:28:03.780337 [debug] [Thread-3  ]: finished collecting timing info
12:28:03.780618 [debug] [Thread-3  ]: Finished running node test.HackdayVault.not_null_my_second_dbt_model_id.151b76d778
12:28:03.781820 [debug] [Thread-2  ]: finished collecting timing info
12:28:03.781913 [debug] [Thread-2  ]: Began executing node test.HackdayVault.unique_my_second_dbt_model_id.57a0f8c493
12:28:03.781992 [debug] [Thread-2  ]: finished collecting timing info
12:28:03.782171 [debug] [Thread-2  ]: Finished running node test.HackdayVault.unique_my_second_dbt_model_id.57a0f8c493
12:28:04.880098 [debug] [Thread-4  ]: SQL status: SUCCESS 35 in 1.1 seconds
12:28:04.934954 [debug] [Thread-1  ]: SQL status: SUCCESS 83 in 1.16 seconds
12:28:04.965728 [debug] [Thread-4  ]: Using snowflake connection "model.HackdayVault.facebook_ads_insights_staging_hashed"
12:28:04.966192 [debug] [Thread-4  ]: On model.HackdayVault.facebook_ads_insights_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_ads_insights_staging_hashed"} */

    describe table BLINKIST_DEV.hackday.facebook_ads_insights_staging_raw
12:28:05.003439 [debug] [Thread-1  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
12:28:05.003543 [debug] [Thread-1  ]: On model.HackdayVault.facebook_accounts_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_staging_hashed"} */

    describe table BLINKIST_DEV.hackday.facebook_accounts_staging_raw
12:28:05.136668 [debug] [Thread-4  ]: SQL status: SUCCESS 35 in 0.17 seconds
12:28:05.200654 [debug] [Thread-1  ]: SQL status: SUCCESS 83 in 0.2 seconds
12:28:05.227928 [debug] [Thread-4  ]: Writing injected SQL for node "model.HackdayVault.facebook_ads_insights_staging_hashed"
12:28:05.238757 [debug] [Thread-4  ]: finished collecting timing info
12:28:05.239364 [debug] [Thread-4  ]: Began executing node model.HackdayVault.facebook_ads_insights_staging_hashed
12:28:05.239964 [debug] [Thread-4  ]: finished collecting timing info
12:28:05.240575 [debug] [Thread-4  ]: On model.HackdayVault.facebook_ads_insights_staging_hashed: Close
12:28:05.280327 [debug] [Thread-1  ]: Writing injected SQL for node "model.HackdayVault.facebook_accounts_staging_hashed"
12:28:05.281666 [debug] [Thread-1  ]: finished collecting timing info
12:28:05.281770 [debug] [Thread-1  ]: Began executing node model.HackdayVault.facebook_accounts_staging_hashed
12:28:05.281856 [debug] [Thread-1  ]: finished collecting timing info
12:28:05.281942 [debug] [Thread-1  ]: On model.HackdayVault.facebook_accounts_staging_hashed: Close
12:28:05.831876 [debug] [Thread-1  ]: Finished running node model.HackdayVault.facebook_accounts_staging_hashed
12:28:05.832592 [debug] [Thread-4  ]: Finished running node model.HackdayVault.facebook_ads_insights_staging_hashed
12:28:05.834715 [debug] [MainThread]: Connection 'master' was properly closed.
12:28:05.835249 [debug] [MainThread]: Connection 'model.HackdayVault.facebook_accounts_staging_hashed' was properly closed.
12:28:05.835549 [debug] [MainThread]: Connection 'test.HackdayVault.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
12:28:05.835779 [debug] [MainThread]: Connection 'test.HackdayVault.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
12:28:05.835974 [debug] [MainThread]: Connection 'model.HackdayVault.facebook_ads_insights_staging_hashed' was properly closed.
12:28:05.931633 [info ] [MainThread]: Done.
12:28:05.932535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126a37d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126f0d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1271864f0>]}


============================== 2022-06-29 13:38:00.526669 | 5e96bfe4-3c47-438c-aaf9-fc4186125844 ==============================
13:38:00.526687 [info ] [MainThread]: Running with dbt=1.1.0
13:38:00.527185 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/adambekele/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['facebook_accounts_staging_raw+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
13:38:00.527337 [debug] [MainThread]: Tracking: tracking
13:38:00.527614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1191f4250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1191f4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1191d7e20>]}
13:38:00.639777 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
13:38:00.639924 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
13:38:00.643718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e96bfe4-3c47-438c-aaf9-fc4186125844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1194400d0>]}
13:38:00.688889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e96bfe4-3c47-438c-aaf9-fc4186125844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1193820d0>]}
13:38:00.689172 [info ] [MainThread]: Found 6 models, 9 tests, 0 snapshots, 0 analyses, 545 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
13:38:00.689388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e96bfe4-3c47-438c-aaf9-fc4186125844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1193820a0>]}
13:38:00.690288 [info ] [MainThread]: 
13:38:00.690624 [debug] [MainThread]: Acquiring new snowflake connection "master"
13:38:00.691159 [debug] [ThreadPool]: Acquiring new snowflake connection "list_BLINKIST_DEV"
13:38:00.699525 [debug] [ThreadPool]: Using snowflake connection "list_BLINKIST_DEV"
13:38:00.699660 [debug] [ThreadPool]: On list_BLINKIST_DEV: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "connection_name": "list_BLINKIST_DEV"} */

    show terse schemas in database BLINKIST_DEV
    limit 10000
13:38:00.699756 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:38:02.204958 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.51 seconds
13:38:02.208740 [debug] [ThreadPool]: On list_BLINKIST_DEV: Close
13:38:02.816040 [debug] [ThreadPool]: Acquiring new snowflake connection "list_BLINKIST_DEV_hackday"
13:38:02.829294 [debug] [ThreadPool]: Using snowflake connection "list_BLINKIST_DEV_hackday"
13:38:02.829566 [debug] [ThreadPool]: On list_BLINKIST_DEV_hackday: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "connection_name": "list_BLINKIST_DEV_hackday"} */

    show terse objects in BLINKIST_DEV.hackday
13:38:02.829762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:38:03.968541 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.14 seconds
13:38:03.972681 [debug] [ThreadPool]: On list_BLINKIST_DEV_hackday: Close
13:38:04.304980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e96bfe4-3c47-438c-aaf9-fc4186125844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119321d60>]}
13:38:04.305903 [info ] [MainThread]: Concurrency: 4 threads (target='hackday')
13:38:04.306465 [info ] [MainThread]: 
13:38:04.313388 [debug] [Thread-1  ]: Began running node model.HackdayVault.facebook_accounts_staging_raw
13:38:04.313868 [info ] [Thread-1  ]: 1 of 2 START view model hackday.facebook_accounts_staging_raw .................. [RUN]
13:38:04.314515 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.HackdayVault.facebook_accounts_staging_raw"
13:38:04.314758 [debug] [Thread-1  ]: Began compiling node model.HackdayVault.facebook_accounts_staging_raw
13:38:04.314986 [debug] [Thread-1  ]: Compiling model.HackdayVault.facebook_accounts_staging_raw
13:38:04.319257 [debug] [Thread-1  ]: Writing injected SQL for node "model.HackdayVault.facebook_accounts_staging_raw"
13:38:04.323284 [debug] [Thread-1  ]: finished collecting timing info
13:38:04.323564 [debug] [Thread-1  ]: Began executing node model.HackdayVault.facebook_accounts_staging_raw
13:38:04.349258 [debug] [Thread-1  ]: Writing runtime SQL for node "model.HackdayVault.facebook_accounts_staging_raw"
13:38:04.350799 [debug] [Thread-1  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_staging_raw"
13:38:04.351061 [debug] [Thread-1  ]: On model.HackdayVault.facebook_accounts_staging_raw: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_staging_raw"} */

  create or replace  view BLINKIST_DEV.hackday.facebook_accounts_staging_raw
  
   as (
    SELECT
    *
FROM FIVETRAN_DATABASE.facebook_ads.account_history
  );
13:38:04.351201 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:38:05.611393 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.26 seconds
13:38:05.624603 [debug] [Thread-1  ]: finished collecting timing info
13:38:05.625058 [debug] [Thread-1  ]: On model.HackdayVault.facebook_accounts_staging_raw: Close
13:38:05.931005 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e96bfe4-3c47-438c-aaf9-fc4186125844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11957b040>]}
13:38:05.932064 [info ] [Thread-1  ]: 1 of 2 OK created view model hackday.facebook_accounts_staging_raw ............. [[32mSUCCESS 1[0m in 1.62s]
13:38:05.933066 [debug] [Thread-1  ]: Finished running node model.HackdayVault.facebook_accounts_staging_raw
13:38:05.933948 [debug] [Thread-3  ]: Began running node model.HackdayVault.facebook_accounts_staging_hashed
13:38:05.934490 [info ] [Thread-3  ]: 2 of 2 START view model hackday.facebook_accounts_staging_hashed ............... [RUN]
13:38:05.935209 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
13:38:05.935448 [debug] [Thread-3  ]: Began compiling node model.HackdayVault.facebook_accounts_staging_hashed
13:38:05.935666 [debug] [Thread-3  ]: Compiling model.HackdayVault.facebook_accounts_staging_hashed
13:38:05.976845 [debug] [Thread-3  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
13:38:05.977134 [debug] [Thread-3  ]: On model.HackdayVault.facebook_accounts_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_staging_hashed"} */

    describe table BLINKIST_DEV.hackday.facebook_accounts_staging_raw
13:38:05.977261 [debug] [Thread-3  ]: Opening a new connection, currently in state init
13:38:06.848314 [debug] [Thread-3  ]: SQL status: SUCCESS 83 in 0.87 seconds
13:38:06.959526 [debug] [Thread-3  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
13:38:06.959830 [debug] [Thread-3  ]: On model.HackdayVault.facebook_accounts_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_staging_hashed"} */

    describe table BLINKIST_DEV.hackday.facebook_accounts_staging_raw
13:38:07.168228 [debug] [Thread-3  ]: SQL status: SUCCESS 83 in 0.21 seconds
13:38:07.290162 [debug] [Thread-3  ]: Writing injected SQL for node "model.HackdayVault.facebook_accounts_staging_hashed"
13:38:07.290848 [debug] [Thread-3  ]: finished collecting timing info
13:38:07.290943 [debug] [Thread-3  ]: Began executing node model.HackdayVault.facebook_accounts_staging_hashed
13:38:07.292451 [debug] [Thread-3  ]: Writing runtime SQL for node "model.HackdayVault.facebook_accounts_staging_hashed"
13:38:07.305120 [debug] [Thread-3  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
13:38:07.305216 [debug] [Thread-3  ]: On model.HackdayVault.facebook_accounts_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_staging_hashed"} */

  create or replace  view BLINKIST_DEV.hackday.facebook_accounts_staging_hashed
  
   as (
    







-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    "_FIVETRAN_ID",
    "AGE",
    "AMOUNT_SPENT",
    "BALANCE",
    "BUSINESS_CITY",
    "BUSINESS_COUNTRY_CODE",
    "BUSINESS_NAME",
    "BUSINESS_STATE",
    "BUSINESS_STREET",
    "BUSINESS_STREET_2",
    "BUSINESS_ZIP",
    "CAN_CREATE_BRAND_LIFT_STUDY",
    "CREATED_TIME",
    "CURRENCY",
    "END_ADVERTISER",
    "END_ADVERTISER_NAME",
    "HAS_ADVERTISER_OPTED_IN_ODAX",
    "HAS_MIGRATED_PERMISSIONS",
    "IO_NUMBER",
    "IS_ATTRIBUTION_SPEC_SYSTEM_DEFAULT",
    "IS_DIRECT_DEALS_ENABLED",
    "IS_IN_3_DS_AUTHORIZATION_ENABLED_MARKET",
    "IS_NOTIFICATIONS_ENABLED",
    "IS_PERSONAL",
    "IS_PREPAY_ACCOUNT",
    "IS_TAX_ID_REQUIRED",
    "MEDIA_AGENCY",
    "MIN_CAMPAIGN_GROUP_SPEND_CAP",
    "MIN_DAILY_BUDGET",
    "NAME",
    "NEXT_BILL_DATE",
    "OFFSITE_PIXELS_TOS_ACCEPTED",
    "OWNER",
    "PARTNER",
    "SALESFORCE_INVOICE_GROUP_ID",
    "SPEND_CAP",
    "TAX_ID",
    "TAX_ID_TYPE",
    "TIMEZONE_ID",
    "TIMEZONE_NAME",
    "TIMEZONE_OFFSET_HOURS_UTC",
    "ACCOUNT_STATUS",
    "DISABLE_REASON",
    "TAX_ID_STATUS",
    "AGENCY_CLIENT_DECLARATION_AGENCY_REPRESENTING_CLIENT",
    "AGENCY_CLIENT_DECLARATION_CLIENT_BASED_IN_FRANCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_CITY",
    "AGENCY_CLIENT_DECLARATION_CLIENT_COUNTRY_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_EMAIL_ADDRESS",
    "AGENCY_CLIENT_DECLARATION_CLIENT_NAME",
    "AGENCY_CLIENT_DECLARATION_CLIENT_POSTAL_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_PROVINCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET_2",
    "AGENCY_CLIENT_DECLARATION_HAS_WRITTEN_MANDATE_FROM_ADVERTISER",
    "AGENCY_CLIENT_DECLARATION_IS_CLIENT_PAYING_INVOICES",
    "BUSINESS_MANAGER_BLOCK_OFFLINE_ANALYTICS",
    "BUSINESS_MANAGER_CREATED_BY",
    "BUSINESS_MANAGER_CREATED_TIME",
    "BUSINESS_MANAGER_EXTENDED_UPDATED_TIME",
    "BUSINESS_MANAGER_IS_HIDDEN",
    "BUSINESS_MANAGER_LINK",
    "BUSINESS_MANAGER_NAME",
    "BUSINESS_MANAGER_PAYMENT_ACCOUNT_ID",
    "BUSINESS_MANAGER_PRIMARY_PAGE",
    "BUSINESS_MANAGER_PROFILE_PICTURE_URI",
    "BUSINESS_MANAGER_TIMEZONE_ID",
    "BUSINESS_MANAGER_TWO_FACTOR_TYPE",
    "BUSINESS_MANAGER_UPDATED_BY",
    "BUSINESS_MANAGER_UPDATE_TIME",
    "BUSINESS_MANAGER_VERIFICATION_STATUS",
    "BUSINESS_MANAGER_VERTICAL",
    "BUSINESS_MANAGER_VERTICAL_ID",
    "BUSINESS_MANAGER_MANAGER_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_AUTO_ENROLL",
    "EXTENDED_CREDIT_INVOICE_GROUP_CUSTOMER_PO_NUMBER",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAIL",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAILS",
    "EXTENDED_CREDIT_INVOICE_GROUP_NAME",
    "CAPABILITIES",
    "ID",
    "_FIVETRAN_SYNCED"

    FROM BLINKIST_DEV.hackday.facebook_accounts_staging_raw
),

derived_columns AS (

    SELECT

    "_FIVETRAN_ID",
    "AGE",
    "AMOUNT_SPENT",
    "BALANCE",
    "BUSINESS_CITY",
    "BUSINESS_COUNTRY_CODE",
    "BUSINESS_NAME",
    "BUSINESS_STATE",
    "BUSINESS_STREET",
    "BUSINESS_STREET_2",
    "BUSINESS_ZIP",
    "CAN_CREATE_BRAND_LIFT_STUDY",
    "CREATED_TIME",
    "CURRENCY",
    "END_ADVERTISER",
    "END_ADVERTISER_NAME",
    "HAS_ADVERTISER_OPTED_IN_ODAX",
    "HAS_MIGRATED_PERMISSIONS",
    "IO_NUMBER",
    "IS_ATTRIBUTION_SPEC_SYSTEM_DEFAULT",
    "IS_DIRECT_DEALS_ENABLED",
    "IS_IN_3_DS_AUTHORIZATION_ENABLED_MARKET",
    "IS_NOTIFICATIONS_ENABLED",
    "IS_PERSONAL",
    "IS_PREPAY_ACCOUNT",
    "IS_TAX_ID_REQUIRED",
    "MEDIA_AGENCY",
    "MIN_CAMPAIGN_GROUP_SPEND_CAP",
    "MIN_DAILY_BUDGET",
    "NAME",
    "NEXT_BILL_DATE",
    "OFFSITE_PIXELS_TOS_ACCEPTED",
    "OWNER",
    "PARTNER",
    "SALESFORCE_INVOICE_GROUP_ID",
    "SPEND_CAP",
    "TAX_ID",
    "TAX_ID_TYPE",
    "TIMEZONE_ID",
    "TIMEZONE_NAME",
    "TIMEZONE_OFFSET_HOURS_UTC",
    "ACCOUNT_STATUS",
    "DISABLE_REASON",
    "TAX_ID_STATUS",
    "AGENCY_CLIENT_DECLARATION_AGENCY_REPRESENTING_CLIENT",
    "AGENCY_CLIENT_DECLARATION_CLIENT_BASED_IN_FRANCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_CITY",
    "AGENCY_CLIENT_DECLARATION_CLIENT_COUNTRY_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_EMAIL_ADDRESS",
    "AGENCY_CLIENT_DECLARATION_CLIENT_NAME",
    "AGENCY_CLIENT_DECLARATION_CLIENT_POSTAL_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_PROVINCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET_2",
    "AGENCY_CLIENT_DECLARATION_HAS_WRITTEN_MANDATE_FROM_ADVERTISER",
    "AGENCY_CLIENT_DECLARATION_IS_CLIENT_PAYING_INVOICES",
    "BUSINESS_MANAGER_BLOCK_OFFLINE_ANALYTICS",
    "BUSINESS_MANAGER_CREATED_BY",
    "BUSINESS_MANAGER_CREATED_TIME",
    "BUSINESS_MANAGER_EXTENDED_UPDATED_TIME",
    "BUSINESS_MANAGER_IS_HIDDEN",
    "BUSINESS_MANAGER_LINK",
    "BUSINESS_MANAGER_NAME",
    "BUSINESS_MANAGER_PAYMENT_ACCOUNT_ID",
    "BUSINESS_MANAGER_PRIMARY_PAGE",
    "BUSINESS_MANAGER_PROFILE_PICTURE_URI",
    "BUSINESS_MANAGER_TIMEZONE_ID",
    "BUSINESS_MANAGER_TWO_FACTOR_TYPE",
    "BUSINESS_MANAGER_UPDATED_BY",
    "BUSINESS_MANAGER_UPDATE_TIME",
    "BUSINESS_MANAGER_VERIFICATION_STATUS",
    "BUSINESS_MANAGER_VERTICAL",
    "BUSINESS_MANAGER_VERTICAL_ID",
    "BUSINESS_MANAGER_MANAGER_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_AUTO_ENROLL",
    "EXTENDED_CREDIT_INVOICE_GROUP_CUSTOMER_PO_NUMBER",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAIL",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAILS",
    "EXTENDED_CREDIT_INVOICE_GROUP_NAME",
    "CAPABILITIES",
    "ID",
    "_FIVETRAN_SYNCED",
    'FIVETRAN_FACEBOOK_ACCOUNTS_RAW' AS "RECORD_SOURCE",
    "CURRENCY" AS "CURRENCY_CODE",
    "ID" AS "ACCOUNT_ID"

    FROM source_data
),

hashed_columns AS (

    SELECT

    "_FIVETRAN_ID",
    "AGE",
    "AMOUNT_SPENT",
    "BALANCE",
    "BUSINESS_CITY",
    "BUSINESS_COUNTRY_CODE",
    "BUSINESS_NAME",
    "BUSINESS_STATE",
    "BUSINESS_STREET",
    "BUSINESS_STREET_2",
    "BUSINESS_ZIP",
    "CAN_CREATE_BRAND_LIFT_STUDY",
    "CREATED_TIME",
    "CURRENCY",
    "END_ADVERTISER",
    "END_ADVERTISER_NAME",
    "HAS_ADVERTISER_OPTED_IN_ODAX",
    "HAS_MIGRATED_PERMISSIONS",
    "IO_NUMBER",
    "IS_ATTRIBUTION_SPEC_SYSTEM_DEFAULT",
    "IS_DIRECT_DEALS_ENABLED",
    "IS_IN_3_DS_AUTHORIZATION_ENABLED_MARKET",
    "IS_NOTIFICATIONS_ENABLED",
    "IS_PERSONAL",
    "IS_PREPAY_ACCOUNT",
    "IS_TAX_ID_REQUIRED",
    "MEDIA_AGENCY",
    "MIN_CAMPAIGN_GROUP_SPEND_CAP",
    "MIN_DAILY_BUDGET",
    "NAME",
    "NEXT_BILL_DATE",
    "OFFSITE_PIXELS_TOS_ACCEPTED",
    "OWNER",
    "PARTNER",
    "SALESFORCE_INVOICE_GROUP_ID",
    "SPEND_CAP",
    "TAX_ID",
    "TAX_ID_TYPE",
    "TIMEZONE_ID",
    "TIMEZONE_NAME",
    "TIMEZONE_OFFSET_HOURS_UTC",
    "ACCOUNT_STATUS",
    "DISABLE_REASON",
    "TAX_ID_STATUS",
    "AGENCY_CLIENT_DECLARATION_AGENCY_REPRESENTING_CLIENT",
    "AGENCY_CLIENT_DECLARATION_CLIENT_BASED_IN_FRANCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_CITY",
    "AGENCY_CLIENT_DECLARATION_CLIENT_COUNTRY_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_EMAIL_ADDRESS",
    "AGENCY_CLIENT_DECLARATION_CLIENT_NAME",
    "AGENCY_CLIENT_DECLARATION_CLIENT_POSTAL_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_PROVINCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET_2",
    "AGENCY_CLIENT_DECLARATION_HAS_WRITTEN_MANDATE_FROM_ADVERTISER",
    "AGENCY_CLIENT_DECLARATION_IS_CLIENT_PAYING_INVOICES",
    "BUSINESS_MANAGER_BLOCK_OFFLINE_ANALYTICS",
    "BUSINESS_MANAGER_CREATED_BY",
    "BUSINESS_MANAGER_CREATED_TIME",
    "BUSINESS_MANAGER_EXTENDED_UPDATED_TIME",
    "BUSINESS_MANAGER_IS_HIDDEN",
    "BUSINESS_MANAGER_LINK",
    "BUSINESS_MANAGER_NAME",
    "BUSINESS_MANAGER_PAYMENT_ACCOUNT_ID",
    "BUSINESS_MANAGER_PRIMARY_PAGE",
    "BUSINESS_MANAGER_PROFILE_PICTURE_URI",
    "BUSINESS_MANAGER_TIMEZONE_ID",
    "BUSINESS_MANAGER_TWO_FACTOR_TYPE",
    "BUSINESS_MANAGER_UPDATED_BY",
    "BUSINESS_MANAGER_UPDATE_TIME",
    "BUSINESS_MANAGER_VERIFICATION_STATUS",
    "BUSINESS_MANAGER_VERTICAL",
    "BUSINESS_MANAGER_VERTICAL_ID",
    "BUSINESS_MANAGER_MANAGER_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_AUTO_ENROLL",
    "EXTENDED_CREDIT_INVOICE_GROUP_CUSTOMER_PO_NUMBER",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAIL",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAILS",
    "EXTENDED_CREDIT_INVOICE_GROUP_NAME",
    "CAPABILITIES",
    "ID",
    "_FIVETRAN_SYNCED",
    "RECORD_SOURCE",
    "CURRENCY_CODE",
    "ACCOUNT_ID",

    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("ACCOUNT_ID" AS VARCHAR))), ''), '^^')
    ), '^^')) AS BINARY(16)) AS "FACEBOOK_ACCOUNTS_HK"

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    "_FIVETRAN_ID",
    "AGE",
    "AMOUNT_SPENT",
    "BALANCE",
    "BUSINESS_CITY",
    "BUSINESS_COUNTRY_CODE",
    "BUSINESS_NAME",
    "BUSINESS_STATE",
    "BUSINESS_STREET",
    "BUSINESS_STREET_2",
    "BUSINESS_ZIP",
    "CAN_CREATE_BRAND_LIFT_STUDY",
    "CREATED_TIME",
    "CURRENCY",
    "END_ADVERTISER",
    "END_ADVERTISER_NAME",
    "HAS_ADVERTISER_OPTED_IN_ODAX",
    "HAS_MIGRATED_PERMISSIONS",
    "IO_NUMBER",
    "IS_ATTRIBUTION_SPEC_SYSTEM_DEFAULT",
    "IS_DIRECT_DEALS_ENABLED",
    "IS_IN_3_DS_AUTHORIZATION_ENABLED_MARKET",
    "IS_NOTIFICATIONS_ENABLED",
    "IS_PERSONAL",
    "IS_PREPAY_ACCOUNT",
    "IS_TAX_ID_REQUIRED",
    "MEDIA_AGENCY",
    "MIN_CAMPAIGN_GROUP_SPEND_CAP",
    "MIN_DAILY_BUDGET",
    "NAME",
    "NEXT_BILL_DATE",
    "OFFSITE_PIXELS_TOS_ACCEPTED",
    "OWNER",
    "PARTNER",
    "SALESFORCE_INVOICE_GROUP_ID",
    "SPEND_CAP",
    "TAX_ID",
    "TAX_ID_TYPE",
    "TIMEZONE_ID",
    "TIMEZONE_NAME",
    "TIMEZONE_OFFSET_HOURS_UTC",
    "ACCOUNT_STATUS",
    "DISABLE_REASON",
    "TAX_ID_STATUS",
    "AGENCY_CLIENT_DECLARATION_AGENCY_REPRESENTING_CLIENT",
    "AGENCY_CLIENT_DECLARATION_CLIENT_BASED_IN_FRANCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_CITY",
    "AGENCY_CLIENT_DECLARATION_CLIENT_COUNTRY_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_EMAIL_ADDRESS",
    "AGENCY_CLIENT_DECLARATION_CLIENT_NAME",
    "AGENCY_CLIENT_DECLARATION_CLIENT_POSTAL_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_PROVINCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET_2",
    "AGENCY_CLIENT_DECLARATION_HAS_WRITTEN_MANDATE_FROM_ADVERTISER",
    "AGENCY_CLIENT_DECLARATION_IS_CLIENT_PAYING_INVOICES",
    "BUSINESS_MANAGER_BLOCK_OFFLINE_ANALYTICS",
    "BUSINESS_MANAGER_CREATED_BY",
    "BUSINESS_MANAGER_CREATED_TIME",
    "BUSINESS_MANAGER_EXTENDED_UPDATED_TIME",
    "BUSINESS_MANAGER_IS_HIDDEN",
    "BUSINESS_MANAGER_LINK",
    "BUSINESS_MANAGER_NAME",
    "BUSINESS_MANAGER_PAYMENT_ACCOUNT_ID",
    "BUSINESS_MANAGER_PRIMARY_PAGE",
    "BUSINESS_MANAGER_PROFILE_PICTURE_URI",
    "BUSINESS_MANAGER_TIMEZONE_ID",
    "BUSINESS_MANAGER_TWO_FACTOR_TYPE",
    "BUSINESS_MANAGER_UPDATED_BY",
    "BUSINESS_MANAGER_UPDATE_TIME",
    "BUSINESS_MANAGER_VERIFICATION_STATUS",
    "BUSINESS_MANAGER_VERTICAL",
    "BUSINESS_MANAGER_VERTICAL_ID",
    "BUSINESS_MANAGER_MANAGER_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_AUTO_ENROLL",
    "EXTENDED_CREDIT_INVOICE_GROUP_CUSTOMER_PO_NUMBER",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAIL",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAILS",
    "EXTENDED_CREDIT_INVOICE_GROUP_NAME",
    "CAPABILITIES",
    "ID",
    "_FIVETRAN_SYNCED",
    "RECORD_SOURCE",
    "CURRENCY_CODE",
    "ACCOUNT_ID",
    "FACEBOOK_ACCOUNTS_HK"

    FROM hashed_columns
)

SELECT * FROM columns_to_select
  );
13:38:07.706627 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.4 seconds
13:38:07.711308 [debug] [Thread-3  ]: finished collecting timing info
13:38:07.711730 [debug] [Thread-3  ]: On model.HackdayVault.facebook_accounts_staging_hashed: Close
13:38:08.001355 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e96bfe4-3c47-438c-aaf9-fc4186125844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11daa7c40>]}
13:38:08.002511 [info ] [Thread-3  ]: 2 of 2 OK created view model hackday.facebook_accounts_staging_hashed .......... [[32mSUCCESS 1[0m in 2.07s]
13:38:08.003340 [debug] [Thread-3  ]: Finished running node model.HackdayVault.facebook_accounts_staging_hashed
13:38:08.004838 [debug] [MainThread]: Acquiring new snowflake connection "master"
13:38:08.005318 [info ] [MainThread]: 
13:38:08.005708 [info ] [MainThread]: Finished running 2 view models in 7.31s.
13:38:08.006062 [debug] [MainThread]: Connection 'master' was properly closed.
13:38:08.006253 [debug] [MainThread]: Connection 'model.HackdayVault.facebook_accounts_staging_raw' was properly closed.
13:38:08.006436 [debug] [MainThread]: Connection 'model.HackdayVault.facebook_accounts_staging_hashed' was properly closed.
13:38:08.110882 [info ] [MainThread]: 
13:38:08.111201 [info ] [MainThread]: [32mCompleted successfully[0m
13:38:08.111465 [info ] [MainThread]: 
13:38:08.111681 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
13:38:08.111961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11da09ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d8eb4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11db24070>]}


============================== 2022-06-29 13:56:09.468877 | 0666c9b3-6261-4c26-98db-4c08eef9b276 ==============================
13:56:09.468897 [info ] [MainThread]: Running with dbt=1.1.0
13:56:09.469573 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/adambekele/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['hub/facebook_accounts_hub'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
13:56:09.469754 [debug] [MainThread]: Tracking: tracking
13:56:09.470060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1237e78b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1237e7640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1237e73a0>]}
13:56:09.594205 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
13:56:09.594381 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
13:56:09.598508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0666c9b3-6261-4c26-98db-4c08eef9b276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123a580d0>]}
13:56:09.638861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0666c9b3-6261-4c26-98db-4c08eef9b276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1239a8310>]}
13:56:09.639116 [info ] [MainThread]: Found 6 models, 9 tests, 0 snapshots, 0 analyses, 545 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
13:56:09.639302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0666c9b3-6261-4c26-98db-4c08eef9b276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1239a81c0>]}
13:56:09.639937 [warn ] [MainThread]: The selection criterion 'hub/facebook_accounts_hub' does not match any nodes
13:56:09.640540 [info ] [MainThread]: 
13:56:09.640718 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
13:56:09.677788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1239a81f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1239a8070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1239a8100>]}


============================== 2022-06-29 13:56:24.974342 | a29f70db-e648-48a8-8568-a1313ef8517d ==============================
13:56:24.974363 [info ] [MainThread]: Running with dbt=1.1.0
13:56:24.975177 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/adambekele/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['facebook_accounts_hub'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
13:56:24.975641 [debug] [MainThread]: Tracking: tracking
13:56:24.975918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1261cb130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1261cbd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1261cb700>]}
13:56:25.095818 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
13:56:25.095980 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
13:56:25.099804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a29f70db-e648-48a8-8568-a1313ef8517d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1264390d0>]}
13:56:25.140024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a29f70db-e648-48a8-8568-a1313ef8517d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12637c100>]}
13:56:25.140260 [info ] [MainThread]: Found 6 models, 9 tests, 0 snapshots, 0 analyses, 545 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
13:56:25.140432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a29f70db-e648-48a8-8568-a1313ef8517d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12637c040>]}
13:56:25.140697 [warn ] [MainThread]: The selection criterion 'facebook_accounts_hub' does not match any nodes
13:56:25.141243 [info ] [MainThread]: 
13:56:25.141406 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
13:56:25.184159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126321880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1263218e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126321a00>]}


============================== 2022-06-29 14:06:26.306493 | 357eeaac-f7b1-4e35-ac6b-5f64fac2f4d3 ==============================
14:06:26.306523 [info ] [MainThread]: Running with dbt=1.1.0
14:06:26.307413 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/adambekele/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'select': ['facebook_accounts_staging_raw+'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:06:26.307544 [debug] [MainThread]: Tracking: tracking
14:06:26.307796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117a4f5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117a4f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117a4f9a0>]}
14:06:26.435124 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
14:06:26.435373 [debug] [MainThread]: Partial parsing: added file: HackdayVault://models/hubs/facebook_accounts_hub.sql
14:06:26.442226 [debug] [MainThread]: 1603: static parser failed on hubs/facebook_accounts_hub.sql
14:06:26.494460 [debug] [MainThread]: 1602: parser fallback to jinja rendering on hubs/facebook_accounts_hub.sql
14:06:26.502825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '357eeaac-f7b1-4e35-ac6b-5f64fac2f4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117daf0d0>]}
14:06:26.510412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '357eeaac-f7b1-4e35-ac6b-5f64fac2f4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117b93c70>]}
14:06:26.510621 [info ] [MainThread]: Found 7 models, 9 tests, 0 snapshots, 0 analyses, 545 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
14:06:26.510783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '357eeaac-f7b1-4e35-ac6b-5f64fac2f4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117b93c40>]}
14:06:26.511549 [info ] [MainThread]: 
14:06:26.511848 [debug] [MainThread]: Acquiring new snowflake connection "master"
14:06:26.512378 [debug] [ThreadPool]: Acquiring new snowflake connection "list_BLINKIST_DEV"
14:06:26.519044 [debug] [ThreadPool]: Using snowflake connection "list_BLINKIST_DEV"
14:06:26.519235 [debug] [ThreadPool]: On list_BLINKIST_DEV: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "connection_name": "list_BLINKIST_DEV"} */

    show terse schemas in database BLINKIST_DEV
    limit 10000
14:06:26.519334 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:06:27.871223 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.35 seconds
14:06:27.876384 [debug] [ThreadPool]: On list_BLINKIST_DEV: Close
14:06:28.177432 [debug] [ThreadPool]: Acquiring new snowflake connection "list_BLINKIST_DEV_hackday"
14:06:28.187991 [debug] [ThreadPool]: Using snowflake connection "list_BLINKIST_DEV_hackday"
14:06:28.188284 [debug] [ThreadPool]: On list_BLINKIST_DEV_hackday: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "connection_name": "list_BLINKIST_DEV_hackday"} */

    show terse objects in BLINKIST_DEV.hackday
14:06:28.188490 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:06:29.261929 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.07 seconds
14:06:29.265073 [debug] [ThreadPool]: On list_BLINKIST_DEV_hackday: Close
14:06:29.646475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '357eeaac-f7b1-4e35-ac6b-5f64fac2f4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040a7be0>]}
14:06:29.647475 [info ] [MainThread]: Concurrency: 4 threads (target='hackday')
14:06:29.647905 [info ] [MainThread]: 
14:06:29.655281 [debug] [Thread-1  ]: Began running node model.HackdayVault.facebook_accounts_staging_raw
14:06:29.655934 [info ] [Thread-1  ]: 1 of 3 START view model hackday.facebook_accounts_staging_raw .................. [RUN]
14:06:29.656688 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.HackdayVault.facebook_accounts_staging_raw"
14:06:29.657014 [debug] [Thread-1  ]: Began compiling node model.HackdayVault.facebook_accounts_staging_raw
14:06:29.657373 [debug] [Thread-1  ]: Compiling model.HackdayVault.facebook_accounts_staging_raw
14:06:29.662157 [debug] [Thread-1  ]: Writing injected SQL for node "model.HackdayVault.facebook_accounts_staging_raw"
14:06:29.663771 [debug] [Thread-1  ]: finished collecting timing info
14:06:29.664055 [debug] [Thread-1  ]: Began executing node model.HackdayVault.facebook_accounts_staging_raw
14:06:29.692331 [debug] [Thread-1  ]: Writing runtime SQL for node "model.HackdayVault.facebook_accounts_staging_raw"
14:06:29.694704 [debug] [Thread-1  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_staging_raw"
14:06:29.694971 [debug] [Thread-1  ]: On model.HackdayVault.facebook_accounts_staging_raw: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_staging_raw"} */

  create or replace  view BLINKIST_DEV.hackday.facebook_accounts_staging_raw
  
   as (
    SELECT
    *
FROM FIVETRAN_DATABASE.facebook_ads.account_history
  );
14:06:29.695113 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:06:30.736402 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.04 seconds
14:06:30.748165 [debug] [Thread-1  ]: finished collecting timing info
14:06:30.748634 [debug] [Thread-1  ]: On model.HackdayVault.facebook_accounts_staging_raw: Close
14:06:31.048462 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '357eeaac-f7b1-4e35-ac6b-5f64fac2f4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117a96160>]}
14:06:31.049402 [info ] [Thread-1  ]: 1 of 3 OK created view model hackday.facebook_accounts_staging_raw ............. [[32mSUCCESS 1[0m in 1.39s]
14:06:31.050051 [debug] [Thread-1  ]: Finished running node model.HackdayVault.facebook_accounts_staging_raw
14:06:31.051087 [debug] [Thread-3  ]: Began running node model.HackdayVault.facebook_accounts_staging_hashed
14:06:31.051770 [info ] [Thread-3  ]: 2 of 3 START view model hackday.facebook_accounts_staging_hashed ............... [RUN]
14:06:31.053457 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
14:06:31.054072 [debug] [Thread-3  ]: Began compiling node model.HackdayVault.facebook_accounts_staging_hashed
14:06:31.055806 [debug] [Thread-3  ]: Compiling model.HackdayVault.facebook_accounts_staging_hashed
14:06:31.093315 [debug] [Thread-3  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
14:06:31.093563 [debug] [Thread-3  ]: On model.HackdayVault.facebook_accounts_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_staging_hashed"} */

    describe table BLINKIST_DEV.hackday.facebook_accounts_staging_raw
14:06:31.093663 [debug] [Thread-3  ]: Opening a new connection, currently in state init
14:06:32.159385 [debug] [Thread-3  ]: SQL status: SUCCESS 83 in 1.07 seconds
14:06:32.255988 [debug] [Thread-3  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
14:06:32.256160 [debug] [Thread-3  ]: On model.HackdayVault.facebook_accounts_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_staging_hashed"} */

    describe table BLINKIST_DEV.hackday.facebook_accounts_staging_raw
14:06:32.440894 [debug] [Thread-3  ]: SQL status: SUCCESS 83 in 0.18 seconds
14:06:32.562525 [debug] [Thread-3  ]: Writing injected SQL for node "model.HackdayVault.facebook_accounts_staging_hashed"
14:06:32.563858 [debug] [Thread-3  ]: finished collecting timing info
14:06:32.563955 [debug] [Thread-3  ]: Began executing node model.HackdayVault.facebook_accounts_staging_hashed
14:06:32.565517 [debug] [Thread-3  ]: Writing runtime SQL for node "model.HackdayVault.facebook_accounts_staging_hashed"
14:06:32.568975 [debug] [Thread-3  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_staging_hashed"
14:06:32.569056 [debug] [Thread-3  ]: On model.HackdayVault.facebook_accounts_staging_hashed: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_staging_hashed"} */

  create or replace  view BLINKIST_DEV.hackday.facebook_accounts_staging_hashed
  
   as (
    







-- Generated by dbtvault.



WITH source_data AS (

    SELECT

    "_FIVETRAN_ID",
    "AGE",
    "AMOUNT_SPENT",
    "BALANCE",
    "BUSINESS_CITY",
    "BUSINESS_COUNTRY_CODE",
    "BUSINESS_NAME",
    "BUSINESS_STATE",
    "BUSINESS_STREET",
    "BUSINESS_STREET_2",
    "BUSINESS_ZIP",
    "CAN_CREATE_BRAND_LIFT_STUDY",
    "CREATED_TIME",
    "CURRENCY",
    "END_ADVERTISER",
    "END_ADVERTISER_NAME",
    "HAS_ADVERTISER_OPTED_IN_ODAX",
    "HAS_MIGRATED_PERMISSIONS",
    "IO_NUMBER",
    "IS_ATTRIBUTION_SPEC_SYSTEM_DEFAULT",
    "IS_DIRECT_DEALS_ENABLED",
    "IS_IN_3_DS_AUTHORIZATION_ENABLED_MARKET",
    "IS_NOTIFICATIONS_ENABLED",
    "IS_PERSONAL",
    "IS_PREPAY_ACCOUNT",
    "IS_TAX_ID_REQUIRED",
    "MEDIA_AGENCY",
    "MIN_CAMPAIGN_GROUP_SPEND_CAP",
    "MIN_DAILY_BUDGET",
    "NAME",
    "NEXT_BILL_DATE",
    "OFFSITE_PIXELS_TOS_ACCEPTED",
    "OWNER",
    "PARTNER",
    "SALESFORCE_INVOICE_GROUP_ID",
    "SPEND_CAP",
    "TAX_ID",
    "TAX_ID_TYPE",
    "TIMEZONE_ID",
    "TIMEZONE_NAME",
    "TIMEZONE_OFFSET_HOURS_UTC",
    "ACCOUNT_STATUS",
    "DISABLE_REASON",
    "TAX_ID_STATUS",
    "AGENCY_CLIENT_DECLARATION_AGENCY_REPRESENTING_CLIENT",
    "AGENCY_CLIENT_DECLARATION_CLIENT_BASED_IN_FRANCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_CITY",
    "AGENCY_CLIENT_DECLARATION_CLIENT_COUNTRY_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_EMAIL_ADDRESS",
    "AGENCY_CLIENT_DECLARATION_CLIENT_NAME",
    "AGENCY_CLIENT_DECLARATION_CLIENT_POSTAL_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_PROVINCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET_2",
    "AGENCY_CLIENT_DECLARATION_HAS_WRITTEN_MANDATE_FROM_ADVERTISER",
    "AGENCY_CLIENT_DECLARATION_IS_CLIENT_PAYING_INVOICES",
    "BUSINESS_MANAGER_BLOCK_OFFLINE_ANALYTICS",
    "BUSINESS_MANAGER_CREATED_BY",
    "BUSINESS_MANAGER_CREATED_TIME",
    "BUSINESS_MANAGER_EXTENDED_UPDATED_TIME",
    "BUSINESS_MANAGER_IS_HIDDEN",
    "BUSINESS_MANAGER_LINK",
    "BUSINESS_MANAGER_NAME",
    "BUSINESS_MANAGER_PAYMENT_ACCOUNT_ID",
    "BUSINESS_MANAGER_PRIMARY_PAGE",
    "BUSINESS_MANAGER_PROFILE_PICTURE_URI",
    "BUSINESS_MANAGER_TIMEZONE_ID",
    "BUSINESS_MANAGER_TWO_FACTOR_TYPE",
    "BUSINESS_MANAGER_UPDATED_BY",
    "BUSINESS_MANAGER_UPDATE_TIME",
    "BUSINESS_MANAGER_VERIFICATION_STATUS",
    "BUSINESS_MANAGER_VERTICAL",
    "BUSINESS_MANAGER_VERTICAL_ID",
    "BUSINESS_MANAGER_MANAGER_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_AUTO_ENROLL",
    "EXTENDED_CREDIT_INVOICE_GROUP_CUSTOMER_PO_NUMBER",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAIL",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAILS",
    "EXTENDED_CREDIT_INVOICE_GROUP_NAME",
    "CAPABILITIES",
    "ID",
    "_FIVETRAN_SYNCED"

    FROM BLINKIST_DEV.hackday.facebook_accounts_staging_raw
),

derived_columns AS (

    SELECT

    "_FIVETRAN_ID",
    "AGE",
    "AMOUNT_SPENT",
    "BALANCE",
    "BUSINESS_CITY",
    "BUSINESS_COUNTRY_CODE",
    "BUSINESS_NAME",
    "BUSINESS_STATE",
    "BUSINESS_STREET",
    "BUSINESS_STREET_2",
    "BUSINESS_ZIP",
    "CAN_CREATE_BRAND_LIFT_STUDY",
    "CREATED_TIME",
    "CURRENCY",
    "END_ADVERTISER",
    "END_ADVERTISER_NAME",
    "HAS_ADVERTISER_OPTED_IN_ODAX",
    "HAS_MIGRATED_PERMISSIONS",
    "IO_NUMBER",
    "IS_ATTRIBUTION_SPEC_SYSTEM_DEFAULT",
    "IS_DIRECT_DEALS_ENABLED",
    "IS_IN_3_DS_AUTHORIZATION_ENABLED_MARKET",
    "IS_NOTIFICATIONS_ENABLED",
    "IS_PERSONAL",
    "IS_PREPAY_ACCOUNT",
    "IS_TAX_ID_REQUIRED",
    "MEDIA_AGENCY",
    "MIN_CAMPAIGN_GROUP_SPEND_CAP",
    "MIN_DAILY_BUDGET",
    "NAME",
    "NEXT_BILL_DATE",
    "OFFSITE_PIXELS_TOS_ACCEPTED",
    "OWNER",
    "PARTNER",
    "SALESFORCE_INVOICE_GROUP_ID",
    "SPEND_CAP",
    "TAX_ID",
    "TAX_ID_TYPE",
    "TIMEZONE_ID",
    "TIMEZONE_NAME",
    "TIMEZONE_OFFSET_HOURS_UTC",
    "ACCOUNT_STATUS",
    "DISABLE_REASON",
    "TAX_ID_STATUS",
    "AGENCY_CLIENT_DECLARATION_AGENCY_REPRESENTING_CLIENT",
    "AGENCY_CLIENT_DECLARATION_CLIENT_BASED_IN_FRANCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_CITY",
    "AGENCY_CLIENT_DECLARATION_CLIENT_COUNTRY_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_EMAIL_ADDRESS",
    "AGENCY_CLIENT_DECLARATION_CLIENT_NAME",
    "AGENCY_CLIENT_DECLARATION_CLIENT_POSTAL_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_PROVINCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET_2",
    "AGENCY_CLIENT_DECLARATION_HAS_WRITTEN_MANDATE_FROM_ADVERTISER",
    "AGENCY_CLIENT_DECLARATION_IS_CLIENT_PAYING_INVOICES",
    "BUSINESS_MANAGER_BLOCK_OFFLINE_ANALYTICS",
    "BUSINESS_MANAGER_CREATED_BY",
    "BUSINESS_MANAGER_CREATED_TIME",
    "BUSINESS_MANAGER_EXTENDED_UPDATED_TIME",
    "BUSINESS_MANAGER_IS_HIDDEN",
    "BUSINESS_MANAGER_LINK",
    "BUSINESS_MANAGER_NAME",
    "BUSINESS_MANAGER_PAYMENT_ACCOUNT_ID",
    "BUSINESS_MANAGER_PRIMARY_PAGE",
    "BUSINESS_MANAGER_PROFILE_PICTURE_URI",
    "BUSINESS_MANAGER_TIMEZONE_ID",
    "BUSINESS_MANAGER_TWO_FACTOR_TYPE",
    "BUSINESS_MANAGER_UPDATED_BY",
    "BUSINESS_MANAGER_UPDATE_TIME",
    "BUSINESS_MANAGER_VERIFICATION_STATUS",
    "BUSINESS_MANAGER_VERTICAL",
    "BUSINESS_MANAGER_VERTICAL_ID",
    "BUSINESS_MANAGER_MANAGER_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_AUTO_ENROLL",
    "EXTENDED_CREDIT_INVOICE_GROUP_CUSTOMER_PO_NUMBER",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAIL",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAILS",
    "EXTENDED_CREDIT_INVOICE_GROUP_NAME",
    "CAPABILITIES",
    "ID",
    "_FIVETRAN_SYNCED",
    'FIVETRAN_FACEBOOK_ACCOUNTS_RAW' AS "RECORD_SOURCE",
    "CURRENCY" AS "CURRENCY_CODE",
    "ID" AS "ACCOUNT_ID"

    FROM source_data
),

hashed_columns AS (

    SELECT

    "_FIVETRAN_ID",
    "AGE",
    "AMOUNT_SPENT",
    "BALANCE",
    "BUSINESS_CITY",
    "BUSINESS_COUNTRY_CODE",
    "BUSINESS_NAME",
    "BUSINESS_STATE",
    "BUSINESS_STREET",
    "BUSINESS_STREET_2",
    "BUSINESS_ZIP",
    "CAN_CREATE_BRAND_LIFT_STUDY",
    "CREATED_TIME",
    "CURRENCY",
    "END_ADVERTISER",
    "END_ADVERTISER_NAME",
    "HAS_ADVERTISER_OPTED_IN_ODAX",
    "HAS_MIGRATED_PERMISSIONS",
    "IO_NUMBER",
    "IS_ATTRIBUTION_SPEC_SYSTEM_DEFAULT",
    "IS_DIRECT_DEALS_ENABLED",
    "IS_IN_3_DS_AUTHORIZATION_ENABLED_MARKET",
    "IS_NOTIFICATIONS_ENABLED",
    "IS_PERSONAL",
    "IS_PREPAY_ACCOUNT",
    "IS_TAX_ID_REQUIRED",
    "MEDIA_AGENCY",
    "MIN_CAMPAIGN_GROUP_SPEND_CAP",
    "MIN_DAILY_BUDGET",
    "NAME",
    "NEXT_BILL_DATE",
    "OFFSITE_PIXELS_TOS_ACCEPTED",
    "OWNER",
    "PARTNER",
    "SALESFORCE_INVOICE_GROUP_ID",
    "SPEND_CAP",
    "TAX_ID",
    "TAX_ID_TYPE",
    "TIMEZONE_ID",
    "TIMEZONE_NAME",
    "TIMEZONE_OFFSET_HOURS_UTC",
    "ACCOUNT_STATUS",
    "DISABLE_REASON",
    "TAX_ID_STATUS",
    "AGENCY_CLIENT_DECLARATION_AGENCY_REPRESENTING_CLIENT",
    "AGENCY_CLIENT_DECLARATION_CLIENT_BASED_IN_FRANCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_CITY",
    "AGENCY_CLIENT_DECLARATION_CLIENT_COUNTRY_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_EMAIL_ADDRESS",
    "AGENCY_CLIENT_DECLARATION_CLIENT_NAME",
    "AGENCY_CLIENT_DECLARATION_CLIENT_POSTAL_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_PROVINCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET_2",
    "AGENCY_CLIENT_DECLARATION_HAS_WRITTEN_MANDATE_FROM_ADVERTISER",
    "AGENCY_CLIENT_DECLARATION_IS_CLIENT_PAYING_INVOICES",
    "BUSINESS_MANAGER_BLOCK_OFFLINE_ANALYTICS",
    "BUSINESS_MANAGER_CREATED_BY",
    "BUSINESS_MANAGER_CREATED_TIME",
    "BUSINESS_MANAGER_EXTENDED_UPDATED_TIME",
    "BUSINESS_MANAGER_IS_HIDDEN",
    "BUSINESS_MANAGER_LINK",
    "BUSINESS_MANAGER_NAME",
    "BUSINESS_MANAGER_PAYMENT_ACCOUNT_ID",
    "BUSINESS_MANAGER_PRIMARY_PAGE",
    "BUSINESS_MANAGER_PROFILE_PICTURE_URI",
    "BUSINESS_MANAGER_TIMEZONE_ID",
    "BUSINESS_MANAGER_TWO_FACTOR_TYPE",
    "BUSINESS_MANAGER_UPDATED_BY",
    "BUSINESS_MANAGER_UPDATE_TIME",
    "BUSINESS_MANAGER_VERIFICATION_STATUS",
    "BUSINESS_MANAGER_VERTICAL",
    "BUSINESS_MANAGER_VERTICAL_ID",
    "BUSINESS_MANAGER_MANAGER_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_AUTO_ENROLL",
    "EXTENDED_CREDIT_INVOICE_GROUP_CUSTOMER_PO_NUMBER",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAIL",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAILS",
    "EXTENDED_CREDIT_INVOICE_GROUP_NAME",
    "CAPABILITIES",
    "ID",
    "_FIVETRAN_SYNCED",
    "RECORD_SOURCE",
    "CURRENCY_CODE",
    "ACCOUNT_ID",

    CAST(MD5_BINARY(NULLIF(CONCAT_WS('||',
        IFNULL(NULLIF(UPPER(TRIM(CAST("ACCOUNT_ID" AS VARCHAR))), ''), '^^')
    ), '^^')) AS BINARY(16)) AS "FACEBOOK_ACCOUNTS_HK"

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    "_FIVETRAN_ID",
    "AGE",
    "AMOUNT_SPENT",
    "BALANCE",
    "BUSINESS_CITY",
    "BUSINESS_COUNTRY_CODE",
    "BUSINESS_NAME",
    "BUSINESS_STATE",
    "BUSINESS_STREET",
    "BUSINESS_STREET_2",
    "BUSINESS_ZIP",
    "CAN_CREATE_BRAND_LIFT_STUDY",
    "CREATED_TIME",
    "CURRENCY",
    "END_ADVERTISER",
    "END_ADVERTISER_NAME",
    "HAS_ADVERTISER_OPTED_IN_ODAX",
    "HAS_MIGRATED_PERMISSIONS",
    "IO_NUMBER",
    "IS_ATTRIBUTION_SPEC_SYSTEM_DEFAULT",
    "IS_DIRECT_DEALS_ENABLED",
    "IS_IN_3_DS_AUTHORIZATION_ENABLED_MARKET",
    "IS_NOTIFICATIONS_ENABLED",
    "IS_PERSONAL",
    "IS_PREPAY_ACCOUNT",
    "IS_TAX_ID_REQUIRED",
    "MEDIA_AGENCY",
    "MIN_CAMPAIGN_GROUP_SPEND_CAP",
    "MIN_DAILY_BUDGET",
    "NAME",
    "NEXT_BILL_DATE",
    "OFFSITE_PIXELS_TOS_ACCEPTED",
    "OWNER",
    "PARTNER",
    "SALESFORCE_INVOICE_GROUP_ID",
    "SPEND_CAP",
    "TAX_ID",
    "TAX_ID_TYPE",
    "TIMEZONE_ID",
    "TIMEZONE_NAME",
    "TIMEZONE_OFFSET_HOURS_UTC",
    "ACCOUNT_STATUS",
    "DISABLE_REASON",
    "TAX_ID_STATUS",
    "AGENCY_CLIENT_DECLARATION_AGENCY_REPRESENTING_CLIENT",
    "AGENCY_CLIENT_DECLARATION_CLIENT_BASED_IN_FRANCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_CITY",
    "AGENCY_CLIENT_DECLARATION_CLIENT_COUNTRY_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_EMAIL_ADDRESS",
    "AGENCY_CLIENT_DECLARATION_CLIENT_NAME",
    "AGENCY_CLIENT_DECLARATION_CLIENT_POSTAL_CODE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_PROVINCE",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET",
    "AGENCY_CLIENT_DECLARATION_CLIENT_STREET_2",
    "AGENCY_CLIENT_DECLARATION_HAS_WRITTEN_MANDATE_FROM_ADVERTISER",
    "AGENCY_CLIENT_DECLARATION_IS_CLIENT_PAYING_INVOICES",
    "BUSINESS_MANAGER_BLOCK_OFFLINE_ANALYTICS",
    "BUSINESS_MANAGER_CREATED_BY",
    "BUSINESS_MANAGER_CREATED_TIME",
    "BUSINESS_MANAGER_EXTENDED_UPDATED_TIME",
    "BUSINESS_MANAGER_IS_HIDDEN",
    "BUSINESS_MANAGER_LINK",
    "BUSINESS_MANAGER_NAME",
    "BUSINESS_MANAGER_PAYMENT_ACCOUNT_ID",
    "BUSINESS_MANAGER_PRIMARY_PAGE",
    "BUSINESS_MANAGER_PROFILE_PICTURE_URI",
    "BUSINESS_MANAGER_TIMEZONE_ID",
    "BUSINESS_MANAGER_TWO_FACTOR_TYPE",
    "BUSINESS_MANAGER_UPDATED_BY",
    "BUSINESS_MANAGER_UPDATE_TIME",
    "BUSINESS_MANAGER_VERIFICATION_STATUS",
    "BUSINESS_MANAGER_VERTICAL",
    "BUSINESS_MANAGER_VERTICAL_ID",
    "BUSINESS_MANAGER_MANAGER_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_ID",
    "EXTENDED_CREDIT_INVOICE_GROUP_AUTO_ENROLL",
    "EXTENDED_CREDIT_INVOICE_GROUP_CUSTOMER_PO_NUMBER",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAIL",
    "EXTENDED_CREDIT_INVOICE_GROUP_EMAILS",
    "EXTENDED_CREDIT_INVOICE_GROUP_NAME",
    "CAPABILITIES",
    "ID",
    "_FIVETRAN_SYNCED",
    "RECORD_SOURCE",
    "CURRENCY_CODE",
    "ACCOUNT_ID",
    "FACEBOOK_ACCOUNTS_HK"

    FROM hashed_columns
)

SELECT * FROM columns_to_select
  );
14:06:33.007424 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.44 seconds
14:06:33.011828 [debug] [Thread-3  ]: finished collecting timing info
14:06:33.012525 [debug] [Thread-3  ]: On model.HackdayVault.facebook_accounts_staging_hashed: Close
14:06:33.323696 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '357eeaac-f7b1-4e35-ac6b-5f64fac2f4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1243b8430>]}
14:06:33.325554 [info ] [Thread-3  ]: 2 of 3 OK created view model hackday.facebook_accounts_staging_hashed .......... [[32mSUCCESS 1[0m in 2.27s]
14:06:33.327277 [debug] [Thread-3  ]: Finished running node model.HackdayVault.facebook_accounts_staging_hashed
14:06:33.329036 [debug] [Thread-2  ]: Began running node model.HackdayVault.facebook_accounts_hub
14:06:33.330065 [info ] [Thread-2  ]: 3 of 3 START incremental model hackday.facebook_accounts_hub ................... [RUN]
14:06:33.331662 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.HackdayVault.facebook_accounts_hub"
14:06:33.332319 [debug] [Thread-2  ]: Began compiling node model.HackdayVault.facebook_accounts_hub
14:06:33.333016 [debug] [Thread-2  ]: Compiling model.HackdayVault.facebook_accounts_hub
14:06:33.351906 [debug] [Thread-2  ]: Writing injected SQL for node "model.HackdayVault.facebook_accounts_hub"
14:06:33.353477 [debug] [Thread-2  ]: finished collecting timing info
14:06:33.353710 [debug] [Thread-2  ]: Began executing node model.HackdayVault.facebook_accounts_hub
14:06:33.387053 [debug] [Thread-2  ]: Writing runtime SQL for node "model.HackdayVault.facebook_accounts_hub"
14:06:33.388486 [debug] [Thread-2  ]: Using snowflake connection "model.HackdayVault.facebook_accounts_hub"
14:06:33.388619 [debug] [Thread-2  ]: On model.HackdayVault.facebook_accounts_hub: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "default", "target_name": "hackday", "node_id": "model.HackdayVault.facebook_accounts_hub"} */


      create or replace transient table BLINKIST_DEV.hackday.facebook_accounts_hub  as
      (-- Generated by dbtvault.

WITH row_rank_1 AS (
    SELECT rr."FACEBOOK_ACCOUNTS_HK", rr."ACCOUNT_ID", rr."_FIVETRAN_SYNCED", rr."RECORD_SOURCE",
           ROW_NUMBER() OVER(
               PARTITION BY rr."FACEBOOK_ACCOUNTS_HK"
               ORDER BY rr."_FIVETRAN_SYNCED"
           ) AS row_number
    FROM BLINKIST_DEV.hackday.facebook_accounts_staging_hashed AS rr
    WHERE rr."FACEBOOK_ACCOUNTS_HK" IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a."FACEBOOK_ACCOUNTS_HK", a."ACCOUNT_ID", a."_FIVETRAN_SYNCED", a."RECORD_SOURCE"
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
      );
14:06:33.388728 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:06:36.058449 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.67 seconds
14:06:36.077385 [debug] [Thread-2  ]: finished collecting timing info
14:06:36.078089 [debug] [Thread-2  ]: On model.HackdayVault.facebook_accounts_hub: Close
14:06:36.382284 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '357eeaac-f7b1-4e35-ac6b-5f64fac2f4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1244422e0>]}
14:06:36.383841 [info ] [Thread-2  ]: 3 of 3 OK created incremental model hackday.facebook_accounts_hub .............. [[32mSUCCESS 1[0m in 3.05s]
14:06:36.385236 [debug] [Thread-2  ]: Finished running node model.HackdayVault.facebook_accounts_hub
14:06:36.388019 [debug] [MainThread]: Acquiring new snowflake connection "master"
14:06:36.389289 [info ] [MainThread]: 
14:06:36.390281 [info ] [MainThread]: Finished running 2 view models, 1 incremental model in 9.88s.
14:06:36.391214 [debug] [MainThread]: Connection 'master' was properly closed.
14:06:36.391697 [debug] [MainThread]: Connection 'model.HackdayVault.facebook_accounts_staging_raw' was properly closed.
14:06:36.392047 [debug] [MainThread]: Connection 'model.HackdayVault.facebook_accounts_staging_hashed' was properly closed.
14:06:36.392667 [debug] [MainThread]: Connection 'model.HackdayVault.facebook_accounts_hub' was properly closed.
14:06:36.485940 [info ] [MainThread]: 
14:06:36.486280 [info ] [MainThread]: [32mCompleted successfully[0m
14:06:36.486637 [info ] [MainThread]: 
14:06:36.486840 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
14:06:36.487084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117a96af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12439bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12437cf70>]}
